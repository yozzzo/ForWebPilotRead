<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta http-equiv="Content-Language" content="ja">
<meta http-equiv="Content-Script-Type" content="JavaScript">

<link href="../style/yoyacky_1_3.css" rel="stylesheet" type="text/css">

<link rel="STYLESHEET" href="../style/Screen.css" type="text/css">

<link rel="stylesheet" href="../style/dummy.css" type="text/css">
<title>施設予約</title>
<script src="./Common.js"></script>
<script language="JavaScript">
    var childwin;
    var childwin2;
    var childwin_rk;
    var childwin_rh;
    var childwin_jj;
    var childwin_qa;
    var childwin_h;
    var childwin_ch;
    var Document_Done = false;
function EvhndLeftClick(e) {
    if (Document_Done == false){
        alert("データ取得中です。\n画面表示が完了するまでしばらくお待ちください。");
	       return false;
    }
}
function EvhndKeyDown(e) {
    if (Document_Done == false){
        alert("データ取得中です。\n画面表示が完了するまでしばらくお待ちください。");
        return false;
    }
}
    document.onmousedown = EvhndLeftClick;
    document.onkeydown = EvhndKeyDown;
    if (document.layers) {
        window.captureEvents(Event.MOUSEDOWN);
        window.captureEvents(Event.KEYDOWN);
    }
    window.onmousedown = EvhndLeftClick;
    window.onkeydown = EvhndKeyDown;
function Form_Focus() {
    Document_Done = true;
    fLoad = false;
    DefChgAlert();}
function Window_OnUnload(){
    if (childwin)
        if (childwin.closed == false)
            childwin.close();
    if (childwin2)
        if (childwin2.closed == false)
            childwin2.close();
}
function cmd_btn_Dmy_click(frmMe) {
    document.all["btn_Dmy"].blur();
}
function btn_riyoukiyaku_click(){
    if (childwin_rk){
        if (childwin_rk.closed == false){
            childwin_rk.focus();
        }else{
            childwin_rk = window.open("https://www.pa-reserve.jp/eap-rj/rsv_rj/help_119999/kiyaku/kiyaku.html","childwin_rk","width=800,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
            childwin_rk.focus();
        }
    }else{
        childwin_rk = window.open("https://www.pa-reserve.jp/eap-rj/rsv_rj/help_119999/kiyaku/kiyaku.html","childwin_rk","width=800,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
        childwin_rk.focus();
    }
}
function btn_riyouhouhou_click(){
    if (childwin_rh){
        if (childwin_rh.closed == false){
            childwin_rh.focus();
        }else{
            childwin_rh = window.open("https://www.pa-reserve.jp/eap-rj/rsv_rj/help_119999/reserve_ref/index.htm","childwin_rh","width=800,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
            childwin_rh.focus();
        }
    }else{
        childwin_rh = window.open("https://www.pa-reserve.jp/eap-rj/rsv_rj/help_119999/reserve_ref/index.htm","childwin_rh","width=800,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
        childwin_rh.focus();
    }
}
function btn_jizenjunbi_click(){
    if (childwin_jj){
        if (childwin_jj.closed == false){
            childwin_jj.focus();
        }else{
            childwin_jj = window.open("../help/reserve_notice_y/index.htm","childwin_rh","width=1100,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
            childwin_jj.focus();
        }
    }else{
        childwin_jj = window.open("../help/reserve_notice_y/index.htm","childwin_jj","width=1100,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
        childwin_jj.focus();
    }
}
function btn_qa_click(){
    if (childwin_qa){
        if (childwin_qa.closed == false){
            childwin_qa.focus();
        }else{
            childwin_qa = window.open("https://www.pa-reserve.jp/eap-rj/rsv_rj/help_119999/qa/qa.html","childwin_qa","width=800,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
            childwin_qa.focus();
        }
    }else{
        childwin_qa = window.open("https://www.pa-reserve.jp/eap-rj/rsv_rj/help_119999/qa/qa.html","childwin_qa","width=800,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
        childwin_qa.focus();
    }
}
function btn_help_click(frmMe){
    if (childwin_h){
        if (childwin_h.closed == false){
            childwin_h.focus();
        }else{
            childwin_h = window.open("https://www.pa-reserve.jp/eap-rj/rsv_rj/help_119999/0.html","childwin_h","width=650,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
            childwin_h.focus();
        }
    }else{
        childwin_h = window.open("https://www.pa-reserve.jp/eap-rj/rsv_rj/help_119999/0.html","childwin_h","width=650,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
        childwin_h.focus();
    }
}
function btn_style_click(){
    if (childwin_ch){
        if (childwin_ch.closed == false){
            childwin_ch.focus();
        }else{
            childwin_ch = window.open("../Core_i/i-style.asp?RequestPage=index&PAGE_UNIQ_ID=&CHILD_WINDOW=1","childwin_ch","width=650,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
            childwin_ch.focus();
        }
    }else{
        childwin_ch = window.open("../Core_i/i-style.asp?RequestPage=index&PAGE_UNIQ_ID=&CHILD_WINDOW=1","childwin_ch","width=650,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");
        childwin_ch.focus();
    }
}
function move_menu(){
    var frmMe = window.document.form1;
    Document_Done = false;
    frmMe.cmd.value = "logout";
    frmMe.action = "../Core_i/index.asp";
    frmMe.method = "post";
    frmMe.submit(); 
}
function move_LogOut(){
    var frmMe = window.document.form1;
    Document_Done = false;
    frmMe.cmd.value = "sys_exit";
    frmMe.action = "../Core_i/index.asp";
    frmMe.method = "post";
    frmMe.submit(); 
}
function userguide_clicked(GuideIdx){
    var frmMe = window.document.form1;
    var sAction;
    var sCmd;
    var fCheck;
    var iMode;
    sAction = "";
    sCmd = "";
    fCheck = false;
    iMode = 0;
    if (frmMe.men_changed_flg.value == "1"){
        alert("ただいまこのリンクは使えません");
        return;
    }else{
    	if (childwin){
        	if (childwin.closed == false){
            	childwin.document.form1.flgOtherClose.value = "1";
            }
        }
    }
    switch (GuideIdx) {
    case "0":
        return;
        break;
    case "1":
        sAction = "../Core_i/i-62.asp";
        break;
    case "2":
        sAction = "../Core_i/i-64.asp";
        break;
    case "3":
        sAction = "../Core_i/i-1-21.asp";
        fCheck = true;
        iMode = 1;
        sAction = sAction + "?group=00001&kaikan=000080";
        break;
    default:
        return;
    }
    if(fCheck == true){
        if (input_check(frmMe, iMode) == false){
            return;
        }
    }
    if(sCmd != ""){
        frmMe.cmd.value = sCmd;
    }
    frmMe.action = sAction;
    frmMe.method = "post";
    Document_Done = false;
    frmMe.submit(); 
}
var selectedOpt;
var selectedDate;
function disp_mode_click(frmMe){
	var nowOpt;
	if (frmMe.disp_mode[0].checked == true )
		nowOpt = 0;
	else
		if (frmMe.disp_mode[1].checked == true)
			nowOpt = 1;
	if (nowOpt != selectedOpt){
		if (confirm("表示モードを変更します。よろしいですか？")){
			selectedOpt = nowOpt;
			Document_Done = false;
			frmMe.action = "i-1-2.asp";
			frmMe.txtSelKomaPtnNo.value = "";
			frmMe.cmd.value = "d_change";
			frmMe.txt_yoyaku.value = "";
			frmMe.method = "post";
			frmMe.submit();
		}else{
			frmMe.disp_mode[nowOpt].checked = false;
			frmMe.disp_mode[selectedOpt].checked = true;
		}
	}
}
function set_data(day){
	var frmMe = window.document.form1;
	frmMe.cmd.value = "dateselect";
	frmMe.txt_date.value = day;
	frmMe.action = "i-1-21.asp";
	frmMe.method = "post";
	frmMe.submit();
}
function set_cal_cal(day, sday, eday){
	var frmMe = window.document.form1;
	Document_Done = false;
	frmMe.action = "i-1-21.asp";
	frmMe.cmd.value = "select";
	frmMe.txt_date_cal.value = day;
	frmMe.method = "post";
	frmMe.submit();
}

var imgSelect				= "../image/i_select.gif";			
var imgSelect				= "../image/s_select.gif";			
var imgEmpty				= "../image/s_empty.gif";			
var imgEmpty2				= "../image/s_empty2.gif";			
var imgEmpty3				= "../image/s_empty3.gif";			
var imgK_Reserve			= "../image/s_k_reserve.gif";			
var imgReserve				= "../image/s_reserve.gif";			
var imgReserve_g			= "../image/s_reserve.gif";		
var imgJisseki				= "../image/s_jisseki.gif";			
var imgJisyu				= "../image/s_jisyu_n.gif";			
var imgMnt					= "../image/s_close_n.gif";			
var imgClose				= "../image/s_close_n.gif";			
var imgLot					= "../image/s_lot.gif";				
var imgLot2					= "../image/s_empty3.gif";			
var imgLock					= "../image/s_lock.gif";			
var imgkouza				= "../image/s_kouza.gif";			
var imgPartEmpty			= "../image/s_empty4.gif";	
var imgKojin				= "../image/s_kojin_shiyou.gif";				
var imgSiyouhukaHyouji      = "../image/s_siyouhuka_hyouji.gif";		
var imgSiyouhukaHihyouji    = "../image/s_siyouhuka_hihyouji.gif";		

var imgMark					= "../image/mark.gif";				
var bgImage1				= "../image/bg1.gif";				
var bgImage2				= "../image/bg2.gif";				
var bgImage3				= "../image/bg3.gif";				
var komaLunchBreakBGColor	= "ffe4e1";						
var komaOvertimeBGColor		= "ffe4e1";						
var komaNormalBGColor		= "ffffcc";						
var dateInfo				= "2023/10/11;";				
var shisetuHeaderInfo		= "001;002;003;004;005;006;007;008;009;010;011;012;013;014;015;";	
var shisetuInfo				= "00100101000M00002012050199991231000000000D01080023301022000|00210102001M10002012050199991231000000000D01080023301022000|00310102001M10002012050199991231000000000D01080023301022000|00410102001M10002012050199991231000000000D01080023301022000|00510102001M10002012050199991231000000000D01080023301022000|00610102001M10002012050199991231000000000D01080023301022000|00710102001M10002012050199991231000000000D01080023301022000|00810102001M10002012050199991231000000000D01080023301022000|00910102001M10002012050199991231000000000D01080023301022000|01010102001M10002012050199991231000000000D01080023301022000|01110102001M10002012050199991231000000000D01080023301022000|01200101000M00002012050199991231000000000D01080023301022000|01310102012M10002012050199991231000000000D01080023301022000|01410102012M10002012050199991231000000000D01080023301022000|01500100000M00002000010199991231000000000D01080023301022000|;";			
var shisetuNameInfo			= "第１テニスコート全面|第１テニスコート１|第１テニスコート２|第１テニスコート３|第１テニスコート４|第１テニスコート５|第１テニスコート６|第１テニスコート７|第１テニスコート８|第１テニスコート９|第１テニスコート１０|第２テニスコート全面|第２テニスコート１１|第２テニスコート１２|運動場第１グラウンド|;";		
var shisetuBoxNoInfo		= "|||||||||||||||;";		
var shisetuDateInfo			= "20231011;;";		
var komaInfo				= "202310110010606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110020606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110030606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110040606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110050606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110060606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110070606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110080606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110090606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110100606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110110606300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,00000000__0000,|202310110120706300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,18302030_18:30-20:30_0000,|202310110130706300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,18302030_18:30-20:30_0000,|202310110140706300830_6:30-8:30_0000,08301030_8:30-10:30_0000,10301230_10:30-12:30_0000,12301430_12:30-14:30_0000,14301630_14:30-16:30_0000,16301830_16:30-18:30_0000,18302030_18:30-20:30_0000,|202310110150208301230_8:30-12:30_0000,13001700_13:00-17:00_0000,00000000__0000,00000000__0000,00000000__0000,00000000__0000,00000000__0000,|;";				
var komaCondInfo			= "2023101101002120;2023101101003120;2023101101004120;2023101101005120;2023101101006120;2023101101007120;2023101101008120;2023101101009120;2023101101010120;2023101101011120;2023101101012120;2023101101013120;2023101101014120;2023101101015120;2023101102002032023021342;2023101102003032023021342;2023101102004012023020182;2023101102006022023017398;2023101102007012023019805;2023101102008012023020167;2023101102009012023019426;2023101102010012023019428;2023101102013022023017400;2023101102014022023017409;2023101102015120;2023101103002032023021342;2023101103003032023021342;2023101103004012023020198;2023101103005032023021342;2023101103006012023020193;2023101103007012023019805;2023101103008012023020167;2023101103009012023019426;2023101103010012023018990;2023101103011012023020164;2023101103013012023020185;2023101103014022023017415;2023101104002032023021342;2023101104003032023021342;2023101104004012023020194;2023101104005012023020194;2023101104006012023020062;2023101104007012023019059;2023101104008012023020175;2023101104009032023021342;2023101104010012023019002;2023101104011032023021342;2023101104013012023019705;2023101104014012023019312;2023101105002032023021342;2023101105003032023021342;2023101105004012023019108;2023101105005012023020195;2023101105006012023020062;2023101105007012023019056;2023101105008012023020126;2023101105009032023021342;2023101105010012023020172;2023101105011012023020195;2023101105013012023020183;2023101105014012023019311;2023101106001120;2023101106002120;2023101106003120;2023101106004120;2023101106005120;2023101106006120;2023101106007120;2023101106008120;2023101106009120;2023101106010120;2023101106011120;2023101107013022023017393;";			
var shisetuCount			= 15;			
var blindYoyakuInfo 		= "";		
var blindYoyakuArray;
var komaLunchBreak			= 2 - 1;	
var komaOvertime			= 5 - 1;		
var dateCount				= 1;				
var komaCount				= 7;				
var imageMarkWidth			= 100;							
var komaImageWidth			= 25;							
var komaImageHeight			= 15;							
var shisetuHeaderWidth		= komaImageWidth;				
var dateHeaderWidth			= imageMarkWidth / 2;			
var komaHeaderWidth			= imageMarkWidth / 2;			
var komaHeaderHeight		= 15;							
var visiblePeriod			= 2;			
var selectedKomaChanged		= false;						
var radioLength				= 7;							
var dateArray;												
var dayArray;												
var shisetuHeaderArray;										
var shisetuArray;											
var shisetuNameArray;										
var shisetuBoxNoArray;										
var shisetuDateArray;										
var komaArray;												
var komaCondArray;											
var komaNameArray;											
var komaSelectArray;										
var selecting				= false;						
var selectingDateIndex		= -1;							
var selectingShisetuIndex	= -1;							
var selectingKomaCount		= -1;							
var selectingKomaKubun		= -1;							
var selectingYoyakuNo		= -1;							
var yoyaku					= "";							
var riyouCnt				= "";			
var komaBase				= "";							
var komaBase2				= "";			
var changeYoyNo				= "";							
var radioSelectedIndex;										
var radioSelectedValue;										
var reservedInfoWindow;										
var childwin;												
var silent					= false;						
var sDate = "2023/10/11";
var sDate1 = "2023/10/10";
var sDate2 = "2023/10/12";
var startDay = "00000000";
var endDay = "99999999";

var kPtnToday = "2023/10/11";

var imageLeft = "../image/arrowleft.gif";				
var imageRight= "../image/arrowright.gif";				
var maxKomaShisetuIndex;
var maxKomaDateIndex;
var maxKomaCount;
var komaDateIndex = "";
var shisetuMenHeaderInfo	= "";	
var shisetuMenHeaderArray;
var shisetuMenInfo			= "";		
var shisetuMenDateInfo		= "";	
var shisetuMenDateArray;									
var shisetuMenCount			= "0";		
var KAIKAN_KBN = "000"
var LotkanriInfo = "2023101100120230901202309092023100120231031;2023101100220230901202309092023100120231031;2023101100320230901202309092023100120231031;2023101100420230901202309092023100120231031;2023101100520230901202309092023100120231031;2023101100620230901202309092023100120231031;2023101100720230901202309092023100120231031;2023101100820230901202309092023100120231031;2023101100920230901202309092023100120231031;2023101101020230901202309092023100120231031;2023101101120230901202309092023100120231031;2023101101220230901202309092023100120231031;2023101101320230901202309092023100120231031;2023101101420230901202309092023100120231031;";
var wkYOYAKU_START;
var wkYOYAKU_END;


var fLoad;
fLoad = true;

init();

function init() {
	buildArray();
	changeRadioButtonMode();
}

function buildArray() {
	var shisetuDateIndex = 0;
	var komaDate = "";
	var tempArray1;		
	var tempArray2;		
	var tempArray3;		
	var tempArray4;		
	var tempArray5;		
	var tempArray6;		
	var currentDate;	
	var constDayArray = new Array("日", "月", "火", "水", "木", "金", "土");
	var i, j, k, l;
	var breakout = false;
	
	dateArray = dateInfo.split(";");
	if (dateArray[dateArray.length - 1] == "") {
		dateArray.length = dateArray.length - 1;
	}
	
	shisetuHeaderArray = shisetuHeaderInfo.split(";");
	if (shisetuHeaderArray[shisetuHeaderArray.length - 1] == "") {
		shisetuHeaderArray.length = shisetuHeaderArray.length - 1;
	}
	
	shisetuDateArray = shisetuDateInfo.split(";");
	if (shisetuDateArray[shisetuDateArray.length - 1] == "") {
		shisetuDateArray.length = shisetuDateArray.length - 1;
	}
	
	shisetuMenDateArray = shisetuMenDateInfo.split(";");
	if (shisetuMenDateArray[shisetuMenDateArray.length - 1] == "") {
		shisetuMenDateArray.length = shisetuMenDateArray.length - 1;
	}
	
	var tempArray7;
	var tempArray8;
	var tempArray9;
	shisetuArray = new Array();
	shisetuNameArray = new Array();
	shisetuBoxNoArray = new Array();
	tempArray1 = shisetuInfo.split(";");
	if (tempArray1[tempArray1.length - 1] == "") {
		tempArray1.length = tempArray1.length - 1;
	}
	tempArray2 = shisetuNameInfo.split(";");
	if (tempArray2[tempArray2.length - 1] == "") {
		tempArray2.length = tempArray2.length - 1;
	}
	tempArray7 = shisetuBoxNoInfo.split(";");
	if (tempArray7[tempArray7.length - 1] == "") {
		tempArray7.length = tempArray7.length - 1;
	}
	for (l = 0; l < dateCount; l++) {
		breakout = false;
		for (i = 0; i < tempArray1.length;i++) {
			if (dateArray[l] == shisetuDateArray[i].substr(0, 4) + "/" + shisetuDateArray[i].substr(4, 2) + "/" + shisetuDateArray[i].substr(6, 2)) {
				breakout = true;
				shisetuDateIndex = i;
				break;
			}
		}
		if (breakout == true) {
			breakout = false;
			tempArray3 = tempArray1[shisetuDateIndex].split("|");
			if (tempArray3[tempArray3.length - 1] == "") {
				tempArray3.length = tempArray3.length - 1;
			}
			tempArray4 = new Array();
			tempArray5 = tempArray2[shisetuDateIndex].split("|");
			if (tempArray5[tempArray5.length - 1] == "") {
				tempArray5.length = tempArray5.length - 1;
			}
			tempArray6 = new Array();
			tempArray8 = tempArray7[shisetuDateIndex].split("|");
			if (tempArray8[tempArray8.length - 1] == "") {
				tempArray8.length = tempArray8.length - 1;
			}
			tempArray9 = new Array();
			for (j = 0; j < shisetuHeaderArray.length; j++) {
				tempArray4[j] = 0;
				tempArray6[j] = 0;
				tempArray9[j] = 0;
				for (k = 0; k < tempArray3.length; k++) {
					if (shisetuHeaderArray[j] == tempArray3[k].substr(0, 3)) {
						tempArray4[j] = tempArray3[k];
						tempArray6[j] = tempArray5[k];
						tempArray9[j] = tempArray8[k];
						break;
					}
				}
			}
			shisetuArray[l] = tempArray4;
			shisetuNameArray[l] = tempArray6;
			shisetuBoxNoArray[l] = tempArray9;
			tempArray4 = new Array();
			tempArray6 = new Array();
			tempArray9 = new Array();
		} else {
			tempArray4 = new Array();
			tempArray6 = new Array();
			tempArray9 = new Array();
			for (j = 0; j < shisetuHeaderArray.length; j++) {
				tempArray4[j] = 0;
				tempArray6[j] = 0;
				tempArray9[j] = 0;
			}
			shisetuArray[l] = tempArray4;
			shisetuNameArray[l] = tempArray6;
			shisetuBoxNoArray[l] = tempArray9;
			tempArray4 = new Array();
			tempArray6 = new Array();
			tempArray9 = new Array();
		}
	}
	
	komaArray = komaInfo.split(";");
	if (komaArray[komaArray.length - 1] == "") {
		komaArray.length = komaArray.length - 1;
	}
	for (i = 0; i < komaArray.length; i++) {
		komaArray[i] = komaArray[i].split("|");
		if (komaArray[i][komaArray[i].length - 1] == "") {
			komaArray[i].length = komaArray[i].length - 1;
		}
		for (j = 0; j < komaArray[i].length; j++) {
			komaArray[i][j] = komaArray[i][j].split(",");
			if (komaArray[i][j][komaArray[i][j].length - 1] == "") {
				komaArray[i][j].length = komaArray[i][j].length - 1;
			}
			for (k = 0; k < komaCount; k++) {
				if (k > komaArray[i][j][0].substr(11,2)-1) {
					komaArray[i][j][k] = -1;
				}
			}
		}
	}
	
	var dif;
	dif = 0;
	dif = dateArray.length - komaArray.length;
	if (dif > 0 && komaCount > 0) {
		
		if (dateArray[0] != komaArray[0][0][0].substr(0, 4) + "/" + komaArray[0][0][0].substr(4, 2) + "/" + komaArray[0][0][0].substr(6, 2)) {
			for (i = dateArray.length - 1; i > dif-1; i--) {
				komaArray[i] = new Array();
				komaArray[i] = komaArray[i-dif];
			}
			for (i = 0; i < dif; i++) {
				tempArray1 = new Array();
				for (j = 0; j < komaCount; j++) {
					tempArray2 = new Array();
					for (k = 0; k < shisetuCount; k++) {
						tempArray2[k] = -1;
					}
					tempArray1[j] = tempArray2;
					tempArray2 = new Array();
				}
				komaArray[i] = tempArray1;
				tempArray1 = new Array();
			}
		} else {
			for (i = 0; i < dif; i++) {
				tempArray1 = new Array();
				for (j = 0; j < komaCount; j++) {
					tempArray2 = new Array();
					for (k = 0; k < shisetuCount; k++) {
						tempArray2[k] = -1;
					}
					tempArray1[j] = tempArray2;
					tempArray2 = new Array();
				}
				komaArray[komaArray.length] = tempArray1;
				tempArray1 = new Array();
			}
		}
	}
	
	if ("000060".substr(0,3) == KAIKAN_KBN) {
		komaNameArray = new Array();
		tempArray1 = new Array();
		tempArray2 = new Array();
		for (i = 0; i < dateCount; i++) {
			for (j = 0; j < shisetuCount; j++) {

			  
			  if ("" + komaArray[0] != "undefined"){


				var ShisetsuIDX;
				var komaArray_i = komaArray[i];
				var komaArray_i_j = new Array();

				for (ShisetsuIDX = 0; ShisetsuIDX < komaArray_i.length; ShisetsuIDX++) {

					if (komaArray_i[ShisetsuIDX] != null) {

						if (shisetuArray[i][j].substr(0, 3) == komaArray_i[ShisetsuIDX][0].substr(8, 3)) {
							komaArray_i_j = komaArray_i[ShisetsuIDX];
							break;
						}
					}

				}

				if (komaArray_i_j != "") {
					if (komaArray_i_j[0] != -1) {
						komaDate = komaArray_i_j[0].substr(0, 4) + "/" + komaArray_i_j[0].substr(4, 2) + "/" + komaArray_i_j[0].substr(6, 2);

						if (dateArray[i] == komaDate) {
							breakout = true;
						}
					}
					if (breakout == true) {
						for (k = 0; k < komaCount; k++) {

							if (komaArray_i_j[k] != -1) {
								tempArray2[k] = komaArray_i_j[k].split("_")[1];

							} else {
								tempArray2[k] = "";
							}
						}
					} else {
						for (k = 0; k < komaCount; k++) {
							tempArray2[k] = "";
						}
					}
				} else {
					for (k = 0; k < komaCount; k++) {
						tempArray2[k] = "";
					}
				}

			  }

				tempArray1[j] = tempArray2;
				tempArray2 = new Array();
			}
			komaNameArray[i] = tempArray1;
			tempArray1 = new Array();
		}
	} else {
	
		maxKomaShisetuIndex = 0;
		maxKomaDateIndex = 0;
		maxKomaCount = 0;
		
		for (i = 0; i < komaArray.length; i++) {
			for (j = 0; j < komaArray[i].length; j++) {
				if (komaArray[i][j][0] != -1) {
					if (maxKomaCount < parseInt(komaArray[i][j][0].substr(11, 2), 10)) {
						maxKomaCount = parseInt(komaArray[i][j][0].substr(11, 2), 10);
						maxKomaDateIndex = i;
						maxKomaShisetuIndex = j;
					}
				}
			}
		}
		komaNameArray = new Array();
		tempArray1 = new Array();
		for (i = 0; i < dateCount; i++) {
			breakout = false;
			for (j = 0; j < komaArray.length; j++) {
				if (komaArray[j][maxKomaShisetuIndex][0] != -1) {
					komaDate = komaArray[j][maxKomaShisetuIndex][0].substr(0, 4) + "/" + komaArray[j][maxKomaShisetuIndex][0].substr(4, 2) + "/" + komaArray[j][maxKomaShisetuIndex][0].substr(6, 2);
					if (dateArray[i] == komaDate) {
						breakout = true;
						komaDateIndex = j;
						break;
					}
				}
			}
			if (breakout == true) {
				for (k = 0; k < komaCount; k++) {
					if (komaArray[komaDateIndex][maxKomaShisetuIndex][k] != -1) {
						tempArray1[k] = komaArray[komaDateIndex][maxKomaShisetuIndex][k].split("_")[1];
					} else {
					}
				}
				breakout = false;
			} else {
				for (k = 0; k < komaCount; k++) {
					tempArray1[k] = "";
				}
			}
			komaNameArray[i] = tempArray1;
			tempArray1 = new Array();
		}
	}

	
	dayArray = new Array();
	for (i = 0; i < dateArray.length; i++) {
		currentDate = new Date(dateArray[i]);
		dayArray[i] = constDayArray[currentDate.getDay()];
	}
	
	tempArray1 = komaCondInfo.split(";");
	if (tempArray1[tempArray1.length - 1] == "") {
		tempArray1.length = tempArray1.length - 1;
	}
	
	komaCondArray = new Array();
	tempArray2 = new Array();
	tempArray3 = new Array();
	for (i = 0; i < dateArray.length; i++) {
		for (j = 0; j < komaCount; j++) {
			for (k = 0; k < shisetuCount; k++) {
				tempArray2[k]= 0;
			}
			tempArray3[j] = tempArray2;
			tempArray2 = new Array();
		}
		komaCondArray[i] = tempArray3;
		tempArray3 = new Array();
	}


	var yoyakustr1;
	var koma1;
	var start_pos;
	var end_pos;
	var divied_pos;

	
	for (j = 0; j < dateArray.length; j++) {
		
		for (k = 0; k < komaCount; k++) {
			for (l = 0; l < shisetuCount; l++) {
				if (shisetuArray[j][l] != 0) {
					if (shisetuArray[j][l] != 0) {

						
						currentDate = dateArray[j].substr(0, 4) + dateArray[j].substr(5, 2) + dateArray[j].substr(8, 2);
						koma1 = "00" + (parseInt(k, 10) + 1);
						koma1 = koma1.substr(koma1.length - 2, 2)
						yoyakustr1 = "" + currentDate + koma1 + shisetuArray[j][l].substr(0, 3);

						start_pos = 0;
						end_pos = tempArray1.length - 1;

						while (end_pos > start_pos) {
							divied_pos = Math.floor((start_pos + end_pos) / 2);
							if (yoyakustr1 == tempArray1[divied_pos].substr(0, 13)){
								start_pos = divied_pos;
								end_pos = divied_pos;
								break;
							}else{
								if (yoyakustr1 < tempArray1[divied_pos].substr(0, 13)){
									end_pos = divied_pos - 1;
								}else{
									start_pos = divied_pos + 1;
								}
							}
						}
						for (i = start_pos; i <= end_pos; i++) {
							if (yoyakustr1 == tempArray1[i].substr(0, 13)){

								if (tempArray1[i].substr(10, 3) == shisetuArray[j][l].substr(0, 3)) {
									
									if (shisetuArray[j][l].substr(40, 1) == 1) {
										
										if (tempArray1[i].substr(13, 2) == 11 || tempArray1[i].substr(13, 2) == 12 || tempArray1[i].substr(13, 2) == 13 || tempArray1[i].substr(13, 2) == 21 || tempArray1[i].substr(13, 2) == 14
										    || tempArray1[i].substr(13, 2) == 15 || tempArray1[i].substr(13, 2) == 16) {

											komaCondArray[j][k][l] = tempArray1[i];
										} else {
											komaCondArray[j][k][l] = SetMenOyaCond(j, k, l, shisetuArray[j][l].substr(0, 3));
										}
									} else {
										komaCondArray[j][k][l] = tempArray1[i];
									}
								}

							}
						}
					}
				}
			}
		}
	}

	
	for (i = 0; i < dateArray.length; i++) {
		for (j = 0; j < komaCount; j++) {
			for (k = 0; k < shisetuCount; k++) {
				if (shisetuArray[i][k] != 0){
					if ((shisetuArray[i][k].substr(40, 1) == 1) && (komaCondArray[i][j][k] == 0)) {
						komaCondArray[i][j][k] = SetMenOyaCond(i, j, k, shisetuArray[i][k].substr(0, 3));
					}
				}
			}
		}
	}
	komaSelectArray = new Array();
	tempArray1 = new Array();
	tempArray2 = new Array();
	for (i = 0; i < dateArray.length; i++) {
		for (j = 0; j < komaCount; j++) {
			for (k = 0; k < shisetuCount; k++) {
				tempArray1[k]= 0;
			}
			tempArray2[j] = tempArray1;
			tempArray1 = new Array();
		}
		komaSelectArray[i] = tempArray2;
		tempArray2 = new Array();
	}
	blindYoyakuArray = new Array();
	tempArray1 = new Array();
	tempArray2 = new Array();
	blindYoyakuArray = blindYoyakuInfo.split(";");
	if (blindYoyakuArray[blindYoyakuArray.length - 1] == "") {
		blindYoyakuArray.length = blindYoyakuArray.length - 1;
	}
	for (i = 0; i < blindYoyakuArray.length; i++) {
		blindYoyakuArray[i] = blindYoyakuArray[i].split("|");
		if (blindYoyakuArray[i][blindYoyakuArray[i].length - 1] == "") {
			blindYoyakuArray[i].length = blindYoyakuArray[i].length - 1;
		}
	}


	LotKanriArray2 = LotkanriInfo.split(";");
	LotKanriArray2.length = LotKanriArray2.length-1;

	var l;
	LotKanriArray = new Array();
	tempArray1 = new Array();
	tempArray2 = new Array();
	for (i=0;i<dateArray.length;i++) {
		for (j=0;j<shisetuCount;j++) {
			tempArray1[j]= 0;
		}
		LotKanriArray[i] = tempArray1;
		tempArray1 = new Array();
	}
	for (i=0;i<LotKanriArray2.length;i++) {
		
		for (j=0;j<dateArray.length;j++) {
			currentDate = dateArray[j].substr(0,4) + dateArray[j].substr(5,2) + dateArray[j].substr(8,2);
			if (LotKanriArray2[i].substr(0,8)==currentDate) {
				
				for (l=0;l<shisetuCount;l++) {
					if (shisetuArray[j][l] != 0) {
						if (LotKanriArray2[i].substr(8,3)==shisetuArray[j][l].substr(0,3)) {
							LotKanriArray[j][l] = LotKanriArray2[i];
						}
					}
				}
			}
		}
	}

}

function SetMenOyaCond(ixD, ixK, ixS, Scd) {
	var MenYoyakuArray;		
	var bitMenArray;		
	var tempArray0;		
	var tempArray1;		
	var tempArray2;		
	var ix0;
	var ix1;
	var ix2;
	var rowData;
	var colData;
	var rowCount;
	var colCount;
	var mRowCount;
	var mColCount;
	var mRowPos;
	var mColPos;
	var mRowStart;
	var mRowEnd;
	var mColStart;
	var mColEnd;
	var ixRow;
	var ixCol;
	var flgYoyakuChk;
	
	MenYoyakuArray = new Array();
	tempArray0 = new Array();
	tempArray1 = new Array();
	ix2 = 0
	rowData = "";
	colData = "";
	tempArray0 = shisetuMenInfo.split(";");
	if (tempArray0[tempArray0.length - 1] == "") {
		tempArray0.length = tempArray0.length - 1;
	}
	for (ix0 = 0; ix0 < shisetuMenDateArray.length; ix0++) {
		if (shisetuMenDateArray[ix0].substr(0, 4) + "/" + shisetuMenDateArray[ix0].substr(4, 2) + "/" + shisetuMenDateArray[ix0].substr(6, 2) == dateArray[ixD]) {
			tempArray1 = tempArray0[ix0].split("|");
			if (tempArray1[tempArray1.length - 1] == "") {
				tempArray1.length = tempArray1.length - 1;
			}
		}
	}
	for (ix1 = 0; ix1 < tempArray1.length; ix1++) {
		if (tempArray1[ix1].substr(3, 3) == Scd) {		
			MenYoyakuArray[ix2] = tempArray1[ix1].substr(0, 3)+","+parseInt(tempArray1[ix1].substr(10, 2), 10)+","+parseInt(tempArray1[ix1].substr(12, 2), 10)+","+parseInt(tempArray1[ix1].substr(14, 2), 10)+","+parseInt(tempArray1[ix1].substr(16, 2), 10)+",0,0";
			if (ix2 == 0) {
				rowData = rowData+parseInt(tempArray1[ix1].substr(10, 2), 10);
				colData = colData+parseInt(tempArray1[ix1].substr(12, 2), 10);
			} else {
				rowData = rowData+","+parseInt(tempArray1[ix1].substr(10, 2), 10);
				colData = colData+","+parseInt(tempArray1[ix1].substr(12, 2), 10);
			}
			ix2 += 1;
		}
	}
	if (MenYoyakuArray.length == 0) {
		return "Empty2";
	}
	
	rowCount = GetLcm(rowData.split(","));
	colCount = GetLcm(colData.split(","));
	bitMenArray = new Array();
	for (ix0 = 0; ix0 < rowCount; ix0++) {
		for (ix1 = 0; ix1 < colCount; ix1++) {
			bitMenArray[ix0+"_"+ix1] = 0;
		}
	}
	
	tempArray1 = new Array();
	tempArray1 = komaCondInfo.split(";");
	if (tempArray1[tempArray1.length - 1] == "") {
		tempArray1.length = tempArray1.length - 1;
	}



	var yoyakustr1;
	var yoyakudate1;
	var koma1;
	var start_pos;
	var end_pos;
	var divied_pos;

	
	if (tempArray1.length != 0){
		for (ix1 = 0; ix1 < MenYoyakuArray.length; ix1++) {
			yoyakudate1 = dateArray[ixD].substr(0, 4) + dateArray[ixD].substr(5, 2) + dateArray[ixD].substr(8, 2);
			koma1 = "00" + (parseInt(ixK, 10) + 1);
			koma1 = koma1.substr(koma1.length-2,2)
			yoyakustr1 = "" + yoyakudate1 + koma1 + MenYoyakuArray[ix1].substr(0, 3);

			start_pos = 0;
			end_pos = tempArray1.length - 1;

			while (end_pos > start_pos) {
				divied_pos = Math.floor((start_pos + end_pos) / 2);
				if (yoyakustr1 == tempArray1[divied_pos].substr(0, 13)){
					start_pos = divied_pos;
					end_pos = divied_pos;
					break;
				}else{
					if (yoyakustr1 < tempArray1[divied_pos].substr(0, 13)){
						end_pos = divied_pos - 1;
					}else{
						start_pos = divied_pos + 1;
					}
				}
			}
			for (ix0 = start_pos; ix0 <= end_pos; ix0++) {
				
				if ((tempArray1[ix0].substr(0, 4) + "/" + tempArray1[ix0].substr(4, 2) + "/" + tempArray1[ix0].substr(6, 2) == dateArray[ixD]) && (parseInt(tempArray1[ix0].substr(8, 2), 10) - 1 == ixK)) {
					if (tempArray1[ix0].substr(10, 3) == MenYoyakuArray[ix1].substr(0, 3)) {		
						tempArray0 = new Array();
						tempArray0 = MenYoyakuArray[ix1].split(",");
						
					  if (tempArray1[ix0].substr(13, 2) == "21"){
						MenYoyakuArray[ix1] = tempArray0[0]+","+tempArray0[1]+","+tempArray0[2]+","+tempArray0[3]+","+tempArray0[4]+",2,0";
					  } else {
						MenYoyakuArray[ix1] = tempArray0[0]+","+tempArray0[1]+","+tempArray0[2]+","+tempArray0[3]+","+tempArray0[4]+",1,1";

						mRowCount = tempArray0[1];
						mColCount = tempArray0[2];
						mRowPos = tempArray0[3];
						mColPos = tempArray0[4];
						
						if (mRowPos == 1) {
							mRowStart = 0;
						} else {
							mRowStart = rowCount / mRowCount * (mRowPos - 1);
						}
						
						mRowEnd = rowCount / mRowCount * mRowPos - 1;
						
						if (mColPos == 1) {
							mColStart = 0;
						} else {
							mColStart = colCount / mColCount * (mColPos - 1);
						}
						
						mColEnd = colCount / mColCount * mColPos - 1;

						
						for (ixRow = mRowStart; ixRow <= mRowEnd; ixRow++) {
							for (ixCol = mColStart; ixCol <= mColEnd; ixCol++) {
								bitMenArray[ixRow+"_"+ixCol] = 1;
							}
						}

					  }

					}
				}
			}
		}
	}

	for (ix0 = 0; ix0 < MenYoyakuArray.length; ix0++) {
		tempArray0 = new Array();
		tempArray0 = MenYoyakuArray[ix0].split(",");
		
		if ((tempArray0[5] == 0) || (tempArray0[5] == 2)) {

			mRowCount = tempArray0[1];
			mColCount = tempArray0[2];
			mRowPos = tempArray0[3];
			mColPos = tempArray0[4];
			
			if (mRowPos == 1) {
				mRowStart = 0;
			} else {
				mRowStart = rowCount / mRowCount * (mRowPos - 1);
			}
			
			mRowEnd = rowCount / mRowCount * mRowPos - 1;
			
			if (mColPos == 1) {
				mColStart = 0;
			} else {
				mColStart = colCount / mColCount * (mColPos - 1);
			}
			
			mColEnd = colCount / mColCount * mColPos - 1;
			
			flgYoyakuChk = 0;
			for (ixRow = mRowStart; ixRow <= mRowEnd; ixRow++) {
				for (ixCol = mColStart; ixCol <= mColEnd; ixCol++) {
					if (bitMenArray[ixRow+"_"+ixCol] == "1") {
						flgYoyakuChk = 1;
					}
				}
			}
			
			if (flgYoyakuChk == 1) {
				MenYoyakuArray[ix0] = tempArray0[0]+","+tempArray0[1]+","+tempArray0[2]+","+tempArray0[3]+","+tempArray0[4]+","+tempArray0[5]+",1";
			}
		}
	}
	
	flgYoyakuChk = 1;
	for (ix0 = 0; ix0 < MenYoyakuArray.length; ix0++) {
		tempArray0 = new Array();
		tempArray0 = MenYoyakuArray[ix0].split(",");
		
		if (tempArray0[6] == 0) {
			flgYoyakuChk = 0;
		}
	}
	if (flgYoyakuChk == 1) {
		
		return "Reserve";
	}
	return 0;
}
function GetLcm(ary) {
	var len = ary.length;
	if(len == 0)
		return 1;
	if(len == 1)
		return ary[0];
	var mul = ary[0];
	for(var i = 1; i < len; i++) {
		var a = ary[i];
		if(mul == 0)
			mul = a;
		else if(a) {
			var div = gcd2(mul, a);
			mul *= a / div;
		}
	}
	return mul >= 0 ? mul : -mul;
}
function gcd2(a, b) {
	if(a == 0)
		return b;
	if(b == 0)
		return a;
	var tmp;
	while(tmp = a % b) {
		a = b;
		b = tmp;
	}
	return b;
}

function komaClicked(i, j, k) {
	var l;
	var breakout = false;
	var imageFileName
	var parentShisetuIndex;
	var wTIMEIN_KBN;
	var wSTART;
	var wTIMEOUT_KBN;
	var wEND;
	var wYOYAKU_TIMEIN_TIME;
	var wYOYAKU_TIMEOUT_TIME;
	var wYOYAKU_TIMEIN_MODE;
	var wYOYAKU_TIMEOUT_MODE;

	var wYOYAKU_TIMEIN_DAY;
	var wYOYAKU_TIMEOUT_DAY;
	wYOYAKU_TIMEIN_DAY =  shisetuArray[i][k].substr(54, 2);
	wYOYAKU_TIMEOUT_DAY =  shisetuArray[i][k].substr(56, 2);
	
	var wJyoken;


	var fReload;
	fReload = false;

	if (komaCondArray[i][j][k] != 0) {
		if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
			if (confirm("抽選予約画面へ移動します。よろしいですか？")){

				
				wJyoken = "";

				document.form1.txtSelKomaPtnNo.value = "";

				document.form1.action = "../Lot_i/li-1-21.asp?RequestPage=i-1-21&lst_kaikan=000060&txt_date=" + dateArray[i].substr(0, 4) + dateArray[i].substr(5, 2) + dateArray[i].substr(8, 2) + wJyoken;

				document.form1.method = "post";
				Document_Done = false;
				document.form1.submit();
			}

			return;

		}
	}

	if (komaCondArray[i][j][k] != 0) {
		
		if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 15 ) {

			var SendData;
			SendData = "";
			SendData = SendData + "&lst_kaikan=" + "000060";
			SendData = SendData + "&yoyaku_date=" + dateArray[i].substr(0, 4) + dateArray[i].substr(5, 2) + dateArray[i].substr(8, 2);
			SendData = SendData + "&txtSelKomaPtnNo=" + "1";
			SendData = SendData + "&yoyaku_koma=" + (j + 1);
			SendData = SendData + "&shisetu_cd=" + shisetuArray[i][k].substr(0, 3);
			
			
			setMenData(i, j, k, shisetuArray[i][k].substr(0, 3));
			
			if (childwin){
				if (childwin.closed == false){
					childwin.focus();
				}else{
					
					childwin = window.open("i-25.asp?RequestPage=i-1-21" + SendData + "&PAGE_UNIQ_ID=&CHILD_WINDOW=1","childwin","width=800,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");

					childwin.focus();
				}
			}else{
				
				childwin = window.open("i-25.asp?RequestPage=i-1-21" + SendData + "&PAGE_UNIQ_ID=&CHILD_WINDOW=1","childwin","width=800,height=650,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");

				childwin.focus();
			}
			return;
		}
	}

	if (shisetuArray[i][k].substr(40, 1) == 1) {
		if (komaCondArray[i][j][k] == 0) {

			if (childwin){
				if (childwin.closed == false){
					childwin.focus();
				}else{

					setMenData(i, j, k, shisetuArray[i][k].substr(0, 3));
					
					childwin = window.open("i-22.asp?RequestPage=i-1-21&lst_kaikan=000060&lst_Shisetu=" + shisetuArray[i][k].substr(0,3) + "&txt_date=" + dateArray[i] + "&PAGE_UNIQ_ID=&CHILD_WINDOW=1","childwin","width=600,height=300,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");

					childwin.focus();

				}
			}else{

				setMenData(i, j, k, shisetuArray[i][k].substr(0, 3));
				
				childwin = window.open("i-22.asp?RequestPage=i-1-21&lst_kaikan=000060&lst_Shisetu=" + shisetuArray[i][k].substr(0,3) + "&txt_date=" + dateArray[i] + "&PAGE_UNIQ_ID=&CHILD_WINDOW=1","childwin","width=600,height=300,resizable=1,scrollbars=1,status=0,menubar=0,toolbar=0");

				childwin.focus();

			}
		}
		return;
	}


	if (document.form1.txtSelKomaPtnNo.value == "") {
		if (dateArray[i] == kPtnToday) {

			document.form1.txtSelKomaPtnNo.value = "1";

		} else {
			document.form1.txtSelKomaPtnNo.value = "1";
		}
	}


	switch (radioSelectedIndex) {
		case 0:		
			if (komaCondArray[i][j][k] == 0) {
				if (shisetuArray[i][k] != 0) {
					if (shisetuArray[i][k].substr(7, 1) == 0) {
						if (komaSelectArray[i][j][k] == 0) {
							if (silent == false) {
								wTIMEIN_KBN = shisetuArray[i][k].substr(11,1);
								wSTART = shisetuArray[i][k].substr(4,2);
								wTIMEOUT_KBN = shisetuArray[i][k].substr(41,1);
								wEND = shisetuArray[i][k].substr(42,2);
								wYOYAKU_TIMEIN_TIME = shisetuArray[i][k].substr(44,4);
								wYOYAKU_TIMEOUT_TIME = shisetuArray[i][k].substr(48,4);
								wYOYAKU_TIMEIN_MODE = shisetuArray[i][k].substr(52,1);
								wYOYAKU_TIMEOUT_MODE = shisetuArray[i][k].substr(53,1);

								wYOYAKU_TIMEIN_DAY =  shisetuArray[i][k].substr(54, 2);
								wYOYAKU_TIMEOUT_DAY =  shisetuArray[i][k].substr(56, 2);

								if (!isReserveAcceptable(dateArray[i], wSTART, wTIMEIN_KBN, wYOYAKU_TIMEIN_TIME, wYOYAKU_TIMEIN_MODE, wEND, wTIMEOUT_KBN, wYOYAKU_TIMEOUT_TIME, wYOYAKU_TIMEOUT_MODE,wYOYAKU_TIMEIN_DAY,wYOYAKU_TIMEOUT_DAY)) {

									if (!confirm("予約受付け期間外です。予約しますか？")){
										break;
									}
								}
							}
							setKomaSelectionImage(i, j, k, imgSelect);
							komaSelectArray[i][j][k] = 1;
							addYoyaku(i, j, k);

						} else {
							setKomaSelectionImage(i, j, k, imgEmpty);
							komaSelectArray[i][j][k] = 0;
							removeYoyaku(i, j, k);

						}
					} else if (shisetuArray[i][k].substr(7, 1) == 1) {
						for (l = 0; l < shisetuArray[i].length; l++) {
							if (shisetuArray[i][l] != 0) {
								if ((shisetuArray[i][k].substr(0, 3) == shisetuArray[i][l].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 2)) {
									if (komaSelectArray[i][j][l] == 1) {
										breakout = true;
										break;
									}
								}
							}
						}
						if (breakout == false) {
							for (l = 0; l < shisetuArray[i].length; l++) {
								if (shisetuArray[i][l] != 0) {
									if ((shisetuArray[i][k].substr(0, 3) == shisetuArray[i][l].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 2)) {
										if (komaCondArray[i][j][l] != 0) {
											breakout = true;
											break;
										}
									}
								}
							}
							if (breakout == false) {
								if (komaCondArray[i][j][k] == 0) {
									if (komaSelectArray[i][j][k] == 0) {
										wTIMEIN_KBN = shisetuArray[i][k].substr(11,1);
										wSTART = shisetuArray[i][k].substr(4,2);
										wTIMEOUT_KBN = shisetuArray[i][k].substr(41,1);
										wEND = shisetuArray[i][k].substr(42,2);
										wYOYAKU_TIMEIN_TIME = shisetuArray[i][k].substr(44,4);
										wYOYAKU_TIMEOUT_TIME = shisetuArray[i][k].substr(48,4);
										wYOYAKU_TIMEIN_MODE = shisetuArray[i][k].substr(52,1);
										wYOYAKU_TIMEOUT_MODE = shisetuArray[i][k].substr(53,1);

										wYOYAKU_TIMEIN_DAY =  shisetuArray[i][k].substr(54, 2);
										wYOYAKU_TIMEOUT_DAY =  shisetuArray[i][k].substr(56, 2);

										if (!isReserveAcceptable(dateArray[i], wSTART, wTIMEIN_KBN, wYOYAKU_TIMEIN_TIME, wYOYAKU_TIMEIN_MODE, wEND, wTIMEOUT_KBN, wYOYAKU_TIMEOUT_TIME, wYOYAKU_TIMEOUT_MODE,wYOYAKU_TIMEIN_DAY,wYOYAKU_TIMEOUT_DAY)) {

											if (silent == false) {
												if (!confirm("予約受付け期間外です。予約しますか？")){
													break;
												}
											}
										}
										setKomaSelectionImage(i, j, k, imgSelect);
										komaSelectArray[i][j][k] = 1;
										addYoyaku(i, j, k);

									} else {
										setKomaSelectionImage(i, j, k, imgEmpty);
										komaSelectArray[i][j][k] = 0;
										removeYoyaku(i, j, k);

									}
								}
							}
						}
					} else if (shisetuArray[i][k].substr(7, 1) == 2) {
						for (l = 0; l < shisetuArray[i].length; l++) {
							if (shisetuArray[i][l] != 0) {
								if ((shisetuArray[i][l].substr(0, 3) == shisetuArray[i][k].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 1)) {
									if (komaSelectArray[i][j][l] == 0) {
										if (komaSelectArray[i][j][k] == 0) {
											wTIMEIN_KBN = shisetuArray[i][k].substr(11,1);
											wSTART = shisetuArray[i][k].substr(4,2);
											wTIMEOUT_KBN = shisetuArray[i][k].substr(41,1);
											wEND = shisetuArray[i][k].substr(42,2);
											wYOYAKU_TIMEIN_TIME = shisetuArray[i][k].substr(44,4);
											wYOYAKU_TIMEOUT_TIME = shisetuArray[i][k].substr(48,4);
											wYOYAKU_TIMEIN_MODE = shisetuArray[i][k].substr(52,1);
											wYOYAKU_TIMEOUT_MODE = shisetuArray[i][k].substr(53,1);

											wYOYAKU_TIMEIN_DAY =  shisetuArray[i][k].substr(54, 2);
											wYOYAKU_TIMEOUT_DAY =  shisetuArray[i][k].substr(56, 2);

											if (!isReserveAcceptable(dateArray[i], wSTART, wTIMEIN_KBN, wYOYAKU_TIMEIN_TIME, wYOYAKU_TIMEIN_MODE, wEND, wTIMEOUT_KBN, wYOYAKU_TIMEOUT_TIME, wYOYAKU_TIMEOUT_MODE,wYOYAKU_TIMEIN_DAY,wYOYAKU_TIMEOUT_DAY)) {

												if (silent == false) {
													if (!confirm("予約受付け期間外です。予約しますか？")){
														break;
													}
												}
											}
											setKomaSelectionImage(i, j, k, imgSelect);
											komaSelectArray[i][j][k] = 1;
											addYoyaku(i, j, k);

										} else {
											setKomaSelectionImage(i, j, k, imgEmpty);
											komaSelectArray[i][j][k] = 0;
											removeYoyaku(i, j, k);

										}
									}
								}
							}
						}
					}
				}
			}
			break;
		case 1:		
			if (komaCondArray[i][j][k] == 0) {
				if (shisetuArray[i][k].substr(7, 1) == 0) {
					if (komaSelectArray[i][j][k] == 0) {
						wTIMEIN_KBN = shisetuArray[i][k].substr(11,1);
						wSTART = shisetuArray[i][k].substr(4,2);
						wTIMEOUT_KBN = shisetuArray[i][k].substr(41,1);
						wEND = shisetuArray[i][k].substr(42,2);
						wYOYAKU_TIMEIN_TIME = shisetuArray[i][k].substr(44,4);
						wYOYAKU_TIMEOUT_TIME = shisetuArray[i][k].substr(48,4);
						wYOYAKU_TIMEIN_MODE = shisetuArray[i][k].substr(52,1);
						wYOYAKU_TIMEOUT_MODE = shisetuArray[i][k].substr(53,1);

						wYOYAKU_TIMEIN_DAY =  shisetuArray[i][k].substr(54, 2);
						wYOYAKU_TIMEOUT_DAY =  shisetuArray[i][k].substr(56, 2);

						if (!isReserveAcceptable(dateArray[i], wSTART, wTIMEIN_KBN, wYOYAKU_TIMEIN_TIME, wYOYAKU_TIMEIN_MODE, wEND, wTIMEOUT_KBN, wYOYAKU_TIMEOUT_TIME, wYOYAKU_TIMEOUT_MODE,wYOYAKU_TIMEIN_DAY,wYOYAKU_TIMEOUT_DAY)) {

							if (silent == false) {
								if (!confirm("予約受付け期間外です。予約しますか？")){
									break;
								}
							}
						}
						setKomaSelectionImage(i, j, k, imgSelect);
						komaSelectArray[i][j][k] = 1;
						addYoyaku(i, j, k);

					} else {
						setKomaSelectionImage(i, j, k, imgEmpty);
						komaSelectArray[i][j][k] = 0;
						removeYoyaku(i, j, k);

					}
				} else if (shisetuArray[i][k].substr(7, 1) == 1) {
					for (l = 0; l < shisetuArray[i].length; l++) {
						if (shisetuArray[i][l] != 0) {
							if ((shisetuArray[i][k].substr(0, 3) == shisetuArray[i][l].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 2)) {
								if (komaSelectArray[i][j][l] == 1) {
									breakout = true;
									break;
								}
							}
						}
					}
					if (breakout == false) {
						for (l = 0; l < shisetuArray[i].length; l++) {
							if (shisetuArray[i][l] != 0) {
								if ((shisetuArray[i][k].substr(0, 3) == shisetuArray[i][l].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 2)) {
									if (komaCondArray[i][j][l] != 0) {
										breakout = true;
										break;
									}
								}
							}
						}
						if (breakout == false) {
							if (komaCondArray[i][j][k] == 0) {
								if (komaSelectArray[i][j][k] == 0) {
									wTIMEIN_KBN = shisetuArray[i][k].substr(11,1);
									wSTART = shisetuArray[i][k].substr(4,2);
									wTIMEOUT_KBN = shisetuArray[i][k].substr(41,1);
									wEND = shisetuArray[i][k].substr(42,2);
									wYOYAKU_TIMEIN_TIME = shisetuArray[i][k].substr(44,4);
									wYOYAKU_TIMEOUT_TIME = shisetuArray[i][k].substr(48,4);
									wYOYAKU_TIMEIN_MODE = shisetuArray[i][k].substr(52,1);
									wYOYAKU_TIMEOUT_MODE = shisetuArray[i][k].substr(53,1);

									wYOYAKU_TIMEIN_DAY =  shisetuArray[i][k].substr(54, 2);
									wYOYAKU_TIMEOUT_DAY =  shisetuArray[i][k].substr(56, 2);

									if (!isReserveAcceptable(dateArray[i], wSTART, wTIMEIN_KBN, wYOYAKU_TIMEIN_TIME, wYOYAKU_TIMEIN_MODE, wEND, wTIMEOUT_KBN, wYOYAKU_TIMEOUT_TIME, wYOYAKU_TIMEOUT_MODE,wYOYAKU_TIMEIN_DAY,wYOYAKU_TIMEOUT_DAY)) {

										if (silent == false) {
											if (!confirm("予約受付け期間外です。予約しますか？")){
												break;
											}
										}
									}
									setKomaSelectionImage(i, j, k, imgSelect);
									komaSelectArray[i][j][k] = 1;
									addYoyaku(i, j, k);

								} else {
									setKomaSelectionImage(i, j, k, imgEmpty);
									komaSelectArray[i][j][k] = 0;
									removeYoyaku(i, j, k);

								}
							}
						}
					}
				} else if (shisetuArray[i][k].substr(7, 1) == 2) {
					for (l = 0; l < shisetuArray[i].length; l++) {
						if (shisetuArray[i][l] != 0) {
							if ((shisetuArray[i][l].substr(0, 3) == shisetuArray[i][k].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 1)) {
								if (komaSelectArray[i][j][l] == 0) {
									if (komaSelectArray[i][j][k] == 0) {
										wTIMEIN_KBN = shisetuArray[i][k].substr(11,1);
										wSTART = shisetuArray[i][k].substr(4,2);
										wTIMEOUT_KBN = shisetuArray[i][k].substr(41,1);
										wEND = shisetuArray[i][k].substr(42,2);
										wYOYAKU_TIMEIN_TIME = shisetuArray[i][k].substr(44,4);
										wYOYAKU_TIMEOUT_TIME = shisetuArray[i][k].substr(48,4);
										wYOYAKU_TIMEIN_MODE = shisetuArray[i][k].substr(52,1);
										wYOYAKU_TIMEOUT_MODE = shisetuArray[i][k].substr(53,1);

										wYOYAKU_TIMEIN_DAY =  shisetuArray[i][k].substr(54, 2);
										wYOYAKU_TIMEOUT_DAY =  shisetuArray[i][k].substr(56, 2);

										if (!isReserveAcceptable(dateArray[i], wSTART, wTIMEIN_KBN, wYOYAKU_TIMEIN_TIME, wYOYAKU_TIMEIN_MODE, wEND, wTIMEOUT_KBN, wYOYAKU_TIMEOUT_TIME, wYOYAKU_TIMEOUT_MODE,wYOYAKU_TIMEIN_DAY,wYOYAKU_TIMEOUT_DAY)) {

											if (silent == false) {
												if (!confirm("予約受付け期間外です。予約しますか？")){
													break;
												}
											}
										}
										setKomaSelectionImage(i, j, k, imgSelect);
										komaSelectArray[i][j][k] = 1;
										addYoyaku(i, j, k);

									} else {
										setKomaSelectionImage(i, j, k, imgEmpty);
										komaSelectArray[i][j][k] = 0;
										removeYoyaku(i, j, k);

									}
								}
							}
						}
					}
				}
			}
			break;
		case 2:		
		case 3:		
		case 4:		
		case 5:		
		case 6:		
		default:
	}
	
	document.form1.txt_yoyaku.value = yoyaku;

	if (document.form1.txt_yoyaku.value == "") {
			document.form1.txtSelKomaPtnNo.value = "";
	}

	document.form1.txt_BASE.value = komaBase;
	document.form1.txt_CHANGE_YOY_NO.value = changeYoyNo;

	if (fLoad == false){
		if (fReload == true){

			clearApplyInfo();
			selectedKomaChanged = false;

			Document_Done = false;
			document.form1.cmd.value = "g_change";
			document.form1.submit();
		}
	}

}

function btn_clear_click() {

	var fReload;
	fReload = false;

	if (confirm("選択されているコマをクリアします。よろしいですか？")){

		if (document.form1.txt_yoyaku.value != ""){
			
			fReload = true
		}

		clearKomaSelection();
		clearyoyakuNoTextField();
		clearInputData();

		if (fReload == true){
			
			Document_Done = false;
			document.form1.cmd.value = "g_change";
			document.form1.submit();
		}

	}
}

function getKomaImageFileName2(i, j, k) {
	var l;
	var breakout = false;
	var imageFileName
	var currentDate;	
	var thisDate = "2023/10/11";
	thisDate = new Date(thisDate);
	thisDate.setHours(0);
	thisDate.setMinutes(0);
	thisDate.setSeconds(0);
	thisDate.setMilliseconds(0);
	currentDate = new Date(dateArray[i]);
	currentDate.setHours(0);
	currentDate.setMinutes(0);
	currentDate.setSeconds(0);
	currentDate.setMilliseconds(0);
	
	if (currentDate >= thisDate) {
		
		if (parseInt(komaCondArray[i][j][k], 10) == 0) {
			
			if (shisetuArray[i][k].substr(7, 1) == 0) {
				if (shisetuArray[i][k].substr(3,1) == 1) {	
					imageFileName = imgEmpty;
				}else{
					imageFileName = imgEmpty2;
				}
			
			} else if (shisetuArray[i][k].substr(7, 1) == 1) {
				for (l = 0; l < shisetuArray[i].length; l++) {
					if (shisetuArray[i][l] != 0) {
						if ((shisetuArray[i][k].substr(0, 3) == shisetuArray[i][l].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 2)) {
							if (komaCondArray[i][j][l] != 0) {

							  if (parseInt(komaCondArray[i][j][l].substr(13, 2), 10) != 21) {

								breakout = true;

								imageFileName = getImageFileName(parseInt(komaCondArray[i][j][l].substr(13, 2), 10));
								break;

							  }

							}
						}
					}
				}
				if (breakout == true) {
					breakout = false;
				} else {
					if (komaCondArray[i][j][k] == 0) {
						if (shisetuArray[i][k].substr(3,1) == 1) {	

							imageFileName = imgEmpty;



						}else{

							imageFileName = imgEmpty2;


						}
					} else {
						imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
					}
				}
			
			} else if (shisetuArray[i][k].substr(7, 1) == 2) {
				if (komaCondArray[i][j][k] == 0) {
					if (shisetuArray[i][k].substr(3,1) == 1) {	
						imageFileName = imgEmpty;

					}else{

						imageFileName = imgEmpty2;
					}
				} else {
					imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));

				}
			}
		
		} else {
			
			if (shisetuArray[i][k].substr(7,1) == 0) {
				imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
			
			} else if (shisetuArray[i][k].substr(7,1) == 1) {
				imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
			
			} else if (shisetuArray[i][k].substr(7,1) == 2) {
				
				if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 11) {
					imageFileName = imgClose;
				} else {
					for (l = 0; l < shisetuArray[i].length; l++) {
						if (shisetuArray[i][l] != 0) {
							if ((shisetuArray[i][l].substr(0, 3) == shisetuArray[i][k].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 1)) {
								if (komaCondArray[i][j][l] == 0) {
									imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
								} else {
									if (parseInt(komaCondArray[i][j][l].substr(13, 2), 10) == 21) {
										imageFileName = imgLot;
									} else {

										imageFileName = getImageFileName(parseInt(komaCondArray[i][j][l].substr(13, 2), 10));
									}
								}
							}
						}
					}
				}
			}
		}
	
	}else{
		
		if (parseInt(komaCondArray[i][j][k], 10) == 0) {
			
			if (shisetuArray[i][k].substr(7, 1) == 0) {
				imageFileName = imgEmpty2;
			
			} else if (shisetuArray[i][k].substr(7, 1) == 1) {
				for (l = 0; l < shisetuArray[i].length; l++) {
					if (shisetuArray[i][l] != 0) {
						if ((shisetuArray[i][k].substr(0, 3) == shisetuArray[i][l].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 2)) {
							if (komaCondArray[i][j][l] != 0) {
								breakout = true;

								imageFileName = getImageFileName(parseInt(komaCondArray[i][j][l].substr(13, 2), 10));
								break;
							}
						}
					}
				}
				if (breakout == true) {
					breakout = false;
				} else {
					if (komaCondArray[i][j][k] == 0) {
						imageFileName = imgEmpty2;
					} else {
						imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
					}
				}
			
			} else if (shisetuArray[i][k].substr(7, 1) == 2) {
				if (komaCondArray[i][j][k] == 0) {
					imageFileName = imgEmpty2;
				} else {
					imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
				}
			}
		
		} else {
			
			if (shisetuArray[i][k].substr(7,1) == 0) {
				imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
			
			} else if (shisetuArray[i][k].substr(7,1) == 1) {
				imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
			
			} else if (shisetuArray[i][k].substr(7,1) == 2) {
				
				if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 11) {
					imageFileName = imgClose;
				} else {
					for (l = 0; l < shisetuArray[i].length; l++) {
						if (shisetuArray[i][l] != 0) {
							if ((shisetuArray[i][l].substr(0, 3) == shisetuArray[i][k].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 1)) {
								if (komaCondArray[i][j][l] == 0) {
									imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
								} else {
									if (parseInt(komaCondArray[i][j][l].substr(13, 2), 10) == 21) {
										imageFileName = imgLot;
									} else {

										imageFileName = getImageFileName(parseInt(komaCondArray[i][j][l].substr(13, 2), 10));
									}
								}
							}
						}
					}
				}
			}
		}
	}
	return imageFileName;
}


function getKomaAlt(FileName) {

	var wkAlt;


	switch (FileName) {
		case "../image/s_select.gif":
			wkAlt = "選択中";
			break;
		case "../image/s_empty.gif":
			wkAlt = "予約可能";
			break;
		case "../image/s_empty2.gif":
			wkAlt = "空き有り（要問い合わせ）";
			break;
		case "../image/s_empty3.gif":
			wkAlt = "予約受付期間外";
			break;
		case "../image/s_k_reserve.gif":
			wkAlt = "予約不可";
			break;
		case "../image/s_reserve.gif":
			wkAlt = "予約不可";
			break;
		case "../image/s_jisyu_n.gif":
			wkAlt = "自主事業";
			break;
		case "../image/s_reserve.gif":
			wkAlt = "予約不可";
			break;
		case "../image/s_close_n.gif":
			wkAlt = "休館・点検";
			break;
		case "../image/s_close_n.gif":
			wkAlt = "休館・点検";
			break;
		case "../image/s_lot.gif":
			wkAlt = "抽選予約画面へ移動";
			break;
		case "../image/s_empty3.gif":
			wkAlt = "予約受付期間外";
			break;
		case "../image/s_kouza.gif":
			wkAlt = "講座";
			break;
		
		case "../image/s_empty4.gif":
			wkAlt = "一部予約有り";
			
			break;

		case "../image/s_kojin_shiyou.gif":
			wkAlt = "個人使用";
			break;

		case "../image/s_siyouhuka_hyouji.gif":
			wkAlt = "使用不可（メモあり）";
			break;
		case "../image/s_siyouhuka_hihyouji.gif":
			wkAlt = "使用不可";
			break;

		default:
			wkAlt = "ALTタグ未定義";
	}


	return wkAlt;

}

function sortYoyaku() {
	var yoyakuTmpArray;
	var yoyakuTmp;
	yoyakuTmp = "";
	yoyakuTmpArray = new Array();
	if (yoyaku.length != 0) {

		yoyakuTmpArray = yoyaku.split(",");

		if (yoyakuTmpArray[yoyakuTmpArray.length - 1] == "") {
			yoyakuTmpArray.length = yoyakuTmpArray.length - 1;
		}
		
		for (i = 0; i < yoyakuTmpArray.length; i++) {
			yoyakuTmpArray[i] = yoyakuTmpArray[i].substr(10, 3) + yoyakuTmpArray[i].substr(0, 8) + yoyakuTmpArray[i].substr(8, 2);
		}
		
		yoyakuTmpArray = yoyakuTmpArray.sort();
		yoyaku = "";
		
		for (i = 0; i < yoyakuTmpArray.length; i++) {

			yoyaku = yoyaku + yoyakuTmpArray[i].substr(3, 8) + yoyakuTmpArray[i].substr(11, 2) + yoyakuTmpArray[i].substr(0, 3) + ",";

		}
	}
}

function btn_ok_click(frmMe){

	if(document.form1.men_changed_flg.value == "1"){
		document.form1.men_changed_flg.value = "0";
		clearApplyInfo();
		selectedkomachanged = false;
		Document_Done = false;
		document.form1.cmd.value = "g_change";
		document.form1.submit();
	}
	if (childwin){
    	if (childwin.closed == false){
        	childwin.document.form1.flgOtherClose.value = "1";
        }
    }

	if (input_check(frmMe) == false){
		return;
	}

		if (selectedKomaChanged == true) {
			clearApplyInfo();
			selectedKomaChanged = false;
		}
		sortYoyaku();
		frmMe.txt_yoyaku.value = yoyaku;

		frmMe.riyou_cnt.value = yoyaku.split(",").length - 1;

		frmMe.cmd.value = "init";

		frmMe.action = "i-3.asp";

		frmMe.method = "post";
		Document_Done = false;
		frmMe.submit();

}

function input_check(frmMe){

	if(yoyaku == "" ){
		window.alert("予約希望日が選択されていません。");
		return false;
	}
}

function windowClosing() {
	closeOtherWindows();

	if(document.form1.men_changed_flg.value == "1"){
		document.form1.men_changed_flg.value = "0";
		clearApplyInfo();
		selectedkomachanged = false;
		Document_Done = false;
		document.form1.cmd.value = "g_change";
		document.form1.submit();
	}

}

function closeOtherWindows() {
	if (childwin) {
		if (childwin.closed == false) {

			childwin.document.form1.flgOtherClose.value = "1";

			childwin.close();
		}
	}
	if (reservedInfoWindow) {
		if (reservedInfoWindow.closed == false) {
			reservedInfoWindow.close();
		}
	}
}

function getRadioSelectedIndex(radioButton) {
	var i;
	for (i = 0; i < radioButton.length; i++) {
		if (radioButton[i].checked == true) {
			return i;
		}
	}
	return -1;
}

function setBackground(mode) {
	var bgImage = bgImage2;
	
	bgImage = getBackground(mode);
	document.body.background = bgImage;
}

function getBackground(mode) {
	var bgImage = bgImage2;
	if (mode == 0 || mode == 1 || mode == 2 || mode == 6) {	
		bgImage = bgImage1;
	} else {
		bgImage = bgImage2;
	}
	return bgImage;
}

function changeRadioButtonMode() {
	radioSelectedValue = 1;
	switch (radioSelectedValue) {
		case 1:			
			radioSelectedIndex = 0;
			break;
		case 2:			
			radioSelectedIndex = 1;
			break;
		default:						
			radioSelectedIndex = 0;
			radioSelectedValue = 1;
	}
}

function clearKomaSelection() {
	var i, j, k;
	for (i = 0; i < dateArray.length; i++) {
		for (j = 0; j < komaCount; j++) {
			for (k = 0; k < shisetuCount; k++) {
				
				if (komaSelectArray[i][j][k] == 1) {
					clearKomaSelectionImage(i, j, k);

					
					if (shisetuArray[i][k] != 0) {
						if ((shisetuArray[i][k].substr(7, 1) == 1) || (shisetuArray[i][k].substr(7,1) == 2)) {
							clearKomaSelectionImage(i, j, k);
						}
					}

				}
				komaSelectArray[i][j][k] = 0;
			}
		}
	}
	yoyaku = "";
	komaBase = "";
	komaBase2 = "";
	changeYoyNo = "";
	document.form1.txt_BASE.value="";
	document.form1.txt_CHANGE_YOY_NO.value="";
	riyouCnt = "";
	selecting = false;
	document.form1.txt_yoyaku.value = yoyaku;
}


function clearKomaSelectionImage(i, j, k) {
	var indexKeyStr = "";
	var iStr = "";
	var jStr = "";
	var kStr = "";
	var ImageFile = "";
	var wkAlt = "";

	iStr = "000" + i;
	iStr = iStr.substr(iStr.length - 3, 3);
	jStr = "000" + j;
	jStr = jStr.substr(jStr.length - 3, 3);
	kStr = "000" + k;
	kStr = kStr.substr(kStr.length - 3, 3);
	indexKeyStr = iStr + jStr + kStr;
	if (document.images["image" + indexKeyStr] != null) {
		var Result;
		Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
		if (Result == "PartEmpty"){
			document.images["image" + indexKeyStr].src = imgPartEmpty;

			document.images["image" + indexKeyStr].alt = "予約可能";

		}else{

			ImageFile = getKomaImageFileName2(i, j, k);
			wkAlt = getKomaAlt(ImageFile);
			document.images["image" + indexKeyStr].src = ImageFile;
			document.images["image" + indexKeyStr].alt = wkAlt;
			
		}
	}
}


function setKomaSelectionImage(i, j, k, fileName) {
	var indexKeyStr = "";
	var iStr = "";
	var jStr = "";
	var kStr = "";
	var wkAlt = "";

	iStr = "000" + i;
	iStr = iStr.substr(iStr.length - 3, 3);
	jStr = "000" + j;
	jStr = jStr.substr(jStr.length - 3, 3);
	kStr = "000" + k;
	kStr = kStr.substr(kStr.length - 3, 3);
	indexKeyStr = iStr + jStr + kStr;


	wkAlt = getKomaAlt(fileName);


	if (document.images["image" + indexKeyStr] != null) {
		document.images["image" + indexKeyStr].src = fileName;

		document.images["image" + indexKeyStr].alt = wkAlt;

	}
}

function getKomaImageFileName(i, j, k) {
	var l;
	var breakout = false;
	var imageFileName
	if (radioSelectedIndex == 0 || radioSelectedIndex == 1) {	
		if (parseInt(komaCondArray[i][j][k], 10) == 0) {
			if (shisetuArray[i][k].substr(7, 1) == 0) {
				imageFileName = imgEmpty;
			} else if (shisetuArray[i][k].substr(7, 1) == 1) {
				for (l = 0; l < shisetuArray[i].length; l++) {
					if (shisetuArray[i][l] != 0) {
						if ((shisetuArray[i][k].substr(0, 3) == shisetuArray[i][l].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 2)) {
							if (komaCondArray[i][j][l] != 0) {
								breakout = true;

								imageFileName = getImageFileName(parseInt(komaCondArray[i][j][l].substr(13, 2), 10));
								break;
							}
						}
					}
				}
				if (breakout == true) {
					breakout = false;
				} else {
					if (komaCondArray[i][j][k] == 0) {
						imageFileName = imgEmpty;
					} else {
						imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
					}
				}
			} else if (shisetuArray[i][k].substr(7, 1) == 2) {
				if (komaCondArray[i][j][k] == 0) {
					imageFileName = imgEmpty;
				} else {
					imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
				}
			}
		} else {
			if (shisetuArray[i][k].substr(7,1) == 0) {
				imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
			} else if (shisetuArray[i][k].substr(7,1) == 1) {
				imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
			} else if (shisetuArray[i][k].substr(7,1) == 2) {
				
				if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 11) {
					imageFileName = imgClose;
				} else {
					for (l = 0; l < shisetuArray[i].length; l++) {
						if (shisetuArray[i][l] != 0) {
							if ((shisetuArray[i][l].substr(0, 3) == shisetuArray[i][k].substr(8, 3)) && (shisetuArray[i][l].substr(7, 1) == 1)) {
								if (komaCondArray[i][j][l] == 0) {
									imageFileName = getImageFileName(parseInt(komaCondArray[i][j][k].substr(13, 2), 10));
								} else {
									if (parseInt(komaCondArray[i][j][l].substr(13, 2), 10) == 21) {
										imageFileName = imgLot;
									} else {

										imageFileName = getImageFileName(parseInt(komaCondArray[i][j][l].substr(13, 2), 10));
									}
								}
							}
						}
					}
				}
			}
		}
	} else if (radioSelectedIndex == 3) {	
	} else if (radioSelectedIndex == 5) {	
	} else {								
	}
	return imageFileName;
}

function getImageFileName(kubun) {
	var imageFileName
	switch (kubun) {
		case 1:				
			imageFileName = imgReserve;
			break;
		case 2:			
			imageFileName = imgReserve;
			break;
		case 3:				
			imageFileName = imgReserve;
			break;
		case 4:			
			imageFileName = imgReserve;
			break;
		case 5:		
			imageFileName = imgReserve;
			break;
		case 6:			
			imageFileName = imgReserve;
			break;
		case 7:		
			imageFileName = imgReserve;
			break;
		case 8:	
			imageFileName = imgReserve;
			break;
		case 11:			
			imageFileName = imgClose;
			break;
		case 12:				
			imageFileName = imgMnt;
			break;
		case 13:				
			imageFileName = imgReserve_g;
			break;
		case 21:				
			imageFileName = imgLot;
			break;
		case 99:				
			imageFileName = imgReserve;
			break;

		case 14:				
			imageFileName = imgKojin;
			break;

		case 15:		
			imageFileName = imgSiyouhukaHyouji;
			break;
		case 16:		
			imageFileName = imgSiyouhukaHihyouji;
			break;
		case 17:	
			imageFileName = imgSiyouhukaHyouji;
			break;
		case 18:	
			imageFileName = imgSiyouhukaHihyouji;
			break;

		default:
	}
	return imageFileName;
}

function addYoyaku(i, j, k) {
	var yoyakuDate = "";
	var yoyakuKoma = "";
	var yoyakuArray;
	selectedKomaChanged	= true;
	yoyakuDate = dateArray[i].substr(0, 4) +  dateArray[i].substr(5, 2) + dateArray[i].substr(8, 2)
	yoyakuKoma = "00" + (j + 1);
	yoyakuKoma = yoyakuKoma.substring(yoyakuKoma.length-2, yoyakuKoma.length);

	yoyaku = yoyaku + yoyakuDate + yoyakuKoma + shisetuArray[i][k].substr(0, 3) + ","
	yoyakuArray = yoyaku.split(",");

	if (yoyakuArray[yoyakuArray.length - 1] == "") {
		riyouCnt = yoyakuArray.length - 1;
	} else {
		riyouCnt = yoyakuArray.length;
	}
	document.form1.txt_yoyaku.value = yoyaku;
}

function addYoyakuMen(target) {
	var yoyakuArray;

	yoyaku = yoyaku + target + ","
	yoyakuArray = yoyaku.split(",");

	if (yoyakuArray[yoyakuArray.length - 1] == "") {
		riyouCnt = yoyakuArray.length - 1;
	} else {
		riyouCnt = yoyakuArray.length;
	}
	document.form1.txt_yoyaku.value = yoyaku;

}

function removeYoyaku(i, j, k) {
	var target = "";
	var yoyakuDate = "";
	var yoyakuKoma = "";
	var removeFrom;
	var yoyakuArray;
	var l;
	selectedKomaChanged	= true;
	yoyakuDate = dateArray[i].substr(0, 4) +  dateArray[i].substr(5, 2) + dateArray[i].substr(8, 2)
	yoyakuKoma = "00" + (j + 1);
	yoyakuKoma = yoyakuKoma.substring(yoyakuKoma.length - 2, yoyakuKoma.length);
	target = yoyakuDate + yoyakuKoma + shisetuArray[i][k].substr(0, 3);

	removeFrom = yoyaku.split(",");

	if (removeFrom[removeFrom.length -1] == "") {
		removeFrom.length = removeFrom.length - 1;
	}
	yoyaku = "";
	for (l = 0; l < removeFrom.length; l++) {
		if (removeFrom[l] != target) {

			yoyaku = yoyaku + removeFrom[l] + ","

		}
	}

	yoyakuArray = yoyaku.split(",");

	if (yoyakuArray[yoyakuArray.length - 1] == "") {
		riyouCnt = yoyakuArray.length - 1;
	} else {
		riyouCnt = yoyakuArray.length;
	}
	document.form1.txt_yoyaku.value = yoyaku;
}

function removeYoyakuMen(target) {
	var removeFrom;
	var yoyakuArray;
	var l;

	removeFrom = yoyaku.split(",");

	if (removeFrom[removeFrom.length -1] == "") {
		removeFrom.length = removeFrom.length - 1;
	}
	yoyaku = "";
	for (l = 0; l < removeFrom.length; l++) {
		if (removeFrom[l] != target) {

			yoyaku = yoyaku + removeFrom[l] + ","

		}
	}

	yoyakuArray = yoyaku.split(",");

	if (yoyakuArray[yoyakuArray.length - 1] == "") {
		riyouCnt = yoyakuArray.length - 1;
	} else {
		riyouCnt = yoyakuArray.length;
	}
	document.form1.txt_yoyaku.value = yoyaku;

}

function setyoyakuNoTextField(yoyakuNo) {
	document.form1.yoyakuNoTextField.value = yoyakuNo;
}

function clearyoyakuNoTextField() {
	document.form1.yoyakuNoTextField.value = "";
}

function existsAnotherDate() {
	var yoyakuArray;
	var yoyakuDate_Before = "";
	var i = 0;
	var exists = false;
	if (yoyaku != "") {

		yoyakuArray = yoyaku.split(",");

		if (yoyakuArray[yoyakuArray.length - 1] == "") {
			yoyakuArray.length = yoyakuArray.length - 1;
		}
		yoyakuDate_Before = yoyakuArray[0].substr(0, 8);
		for (i = 1; i < yoyakuArray.length; i++) {
			if (yoyakuArray[i].substr(0, 8) != yoyakuDate_Before) {
				exists = true;
				break;
			} else {
				yoyakuDate_Before = yoyakuArray[i].substr(0, 8);
			}
		}
	}
	if (exists == true) {
		return true;
	} else {
		return false;
	}
}

function reloadYoyaku(mode) {
	var yoyakuArray		= "";
	var komaBaseArray	= "";
	var dateIndex		= "";
	var shisetuIndex	= "";
	var komaIndex		= "";
	var dateIndexArray;
	var shisetuIndexArray;
	var komaIndexArray;
	var breakout = false;
	var tempArray0;
	var tempArray1;
	var ix0;
	var wMenOya;
	var flgShisetuMen;
	var yoyakuBefore = "";
	var yoyakuBeforeArray = "";

	yoyakuBeforeArray = yoyakuBefore.split(",");

	if (yoyakuBeforeArray[yoyakuBeforeArray.length - 1] == "") {
		yoyakuBeforeArray.length = yoyakuBeforeArray.length - 1;
	}

	yoyaku = yoyaku + "";
	if (yoyaku != "") {
		silent = true;
		
		yoyakuArray = yoyaku.split(",");

		if (yoyakuArray[yoyakuArray.length - 1] == "") {
			yoyakuArray.length = yoyakuArray.length - 1;
		}
		yoyaku = "";
		for (i = 0; i < yoyakuArray.length; i++) {
			
			dateIndex = -1;
			for (j = 0; j < dateArray.length; j++) {
				if (dateArray[j].substr(0, 4) + dateArray[j].substr(5, 2) + dateArray[j].substr(8, 2) == yoyakuArray[i].substr(0, 8)) {
					dateIndex = j;
					break;
				}
			}
			
			komaIndex = parseInt(yoyakuArray[i].substr(8, 2), 10) - 1;
			
			if (dateIndex == -1) {
				var tmp = "";
				var find = false;
				var p = 0;
				tmp = yoyaku;
				if (tmp[tmp.length - 1] == "") {
					tmp.length = tmp.length - 1;
				}

				tmp = tmp.split(",");

				for (p = 0; p < tmp.length; p++) {
					if (tmp[p] == yoyakuArray[i]) {
						find = true;
						break;
					}
				}
				if (find == false) {
					
					for (p = 0; p < yoyakuBeforeArray.length; p++) {
						if (yoyakuBeforeArray[p] == yoyakuArray[i]) {
							find = true;
							break;
						}
					}
					if (find == true) {

						yoyaku = yoyaku + yoyakuArray[i] + ",";

					} else {
					}
				} else {
					find = false;
				}
				continue;
			}
			shisetuIndex = -1;
			for (j = 0; j < shisetuArray[dateIndex].length; j++) {
				if (shisetuArray[dateIndex][j] != 0) {
					if (shisetuArray[dateIndex][j].substr(0, 3) == yoyakuArray[i].substr(10, 3)) {
						shisetuIndex = j;
						if (shisetuArray[dateIndex][j].substr(40, 1) == 1) {
							flgShisetuMen = 1;
						}
						break;
					}
				}
			}
			
			if (shisetuIndex == -1) {
				flgShisetuMen = 0;
				wMenOya = "";
				tempArray0 = new Array();
				tempArray1 = new Array();
				tempArray0 = shisetuMenInfo.split(";");
				if (tempArray0[tempArray0.length - 1] == "") {
					tempArray0.length = tempArray0.length - 1;
				}
				for (ix0 = 0; ix0 < shisetuMenDateArray.length; ix0++) {
					if (shisetuMenDateArray[ix0] == dateArray[dateIndex].substr(0, 4) + dateArray[dateIndex].substr(5, 2) + dateArray[dateIndex].substr(8, 2)) {
						tempArray1 = tempArray0[ix0].split("|");
						if (tempArray1[tempArray1.length - 1] == "") {
							tempArray1.length = tempArray1.length - 1;
							break;
						}
					}
				}
				for (ix0 = 0; ix0 < tempArray1.length; ix0++) {
					if (tempArray1[ix0].substr(0, 3) == yoyakuArray[i].substr(10, 3)) {
						wMenOya = tempArray1[ix0].substr(3, 3);
						break;
					}
				}
				for (k = 0; k < shisetuArray[dateIndex].length; k++) {
					if (shisetuArray[dateIndex][k] != 0) {
						if (shisetuArray[dateIndex][k].substr(0, 3) == wMenOya) {
							shisetuIndex = k;
							flgShisetuMen = 1;
							break;
						}
					}
				}
			}
			
			if (flgShisetuMen == 1) {
				setKomaSelectionImage(dateIndex, komaIndex, shisetuIndex, imgSelect);
				komaSelectArray[dateIndex][komaIndex][shisetuIndex] = 1;
				addYoyakuMen(yoyakuArray[i]);
			} else {
				selecting = true;
				komaClicked(dateIndex, komaIndex, shisetuIndex);
				selecting = false;
			}
		}
		silent = false;
		document.form1.txt_yoyaku.value = yoyaku;
	}
	selectedKomaChanged = false;
}

function inputYoyakuNo(shisetu, yoyakuNo) {
	var i, j, k;
	var shisetuIndex;
	var FindKey;
	
	for (i = 0; i < shisetuArray.length; i++) {
		for (j = 0; j < shisetuArray[i].length; j++) {
			if (shisetuArray[i][j] != 0) {
				if (shisetuArray[i][j].substr(0, 3) == shisetu) {
					shisetuIndex = j;
				}
			}
		}
	}
	
	for (i = 0; i < dateCount; i++) {
		for (j = 0; j < komaCount; j++) {
			if (komaCondArray[i][j][shisetuIndex] != 0) {
				if (komaCondArray[i][j][shisetuIndex].substr(15, 10) == yoyakuNo) {
					if (FindKey != komaCondArray[i][j][shisetuIndex].substr(15, 10)){
						silent = true;						
						komaClicked(i, j, shisetuIndex);	
						silent = false;						
						FindKey = komaCondArray[i][j][shisetuIndex].substr(15, 10);
					}
				}
			}
		}
	}
}

function changekomaSelect(i, j, k, cond) {
	if (cond == "Select") {
		setKomaSelectionImage(i, j, k, imgSelect);
		komaSelectArray[i][j][k] = 1;
	} else {
		var Result;
		Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
		if (Result == "PartEmpty"){
			setKomaSelectionImage(i, j, k, imgPartEmpty);
		}else{
			setKomaSelectionImage(i, j, k, imgEmpty);
		}
		komaSelectArray[i][j][k] = 0;
	}
}


function isReserveAcceptable(CheckDate, YOYAKU_START, YOYAKU_TIMEIN_KBN, YOYAKU_TIMEIN_TIME, YOYAKU_TIMEIN_MODE, YOYAKU_END, YOYAKU_TIMEOUT_KBN, YOYAKU_TIMEOUT_TIME, YOYAKU_TIMEOUT_MODE,YOYAKU_TIMEIN_DAY,YOYAKU_TIMEOUT_DAY){

	var wToday;
	var wStartDate;
	var wEndDate;
	var wCheckDate;
	var wyyyy;
	var wmm;
	var wdd;
	var YokunenCheck;
	var wTIME;

	var yoyakuDate;
	var today;


	var savYOYAKU_START = YOYAKU_START;
	var savYOYAKU_END = YOYAKU_END;

	today = new Date("2023/10/11");
	today.setHours(0);
	today.setMinutes(0);
	today.setSeconds(0);
	today.setMilliseconds(0);
	yoyakuDate = new Date(CheckDate);
	if (yoyakuDate < today) {
		return false;
	}

	
	wToday = new Date("2023/10/11");
	wyyyy = wToday.getFullYear();
	wmm = wToday.getMonth() + 1;
	wdd = wToday.getDate();
	wTIME = "1452";
	if (wmm < 10){wmm = "0" + wmm};
	if (wdd < 10){wdd = "0" + wdd};
	wToday = "" + wyyyy + wmm  + wdd + wTIME;

	
	wCheckDate = new Date(CheckDate);
	wyyyy = wCheckDate.getFullYear();
	wmm = wCheckDate.getMonth() + 1;
	wdd = wCheckDate.getDate();
	if (wmm < 10){wmm = "0" + wmm};
	if (wdd < 10){wdd = "0" + wdd};
	wCheckDate = "" + wyyyy + wmm + wdd;

	
	if ((YOYAKU_START == "**") && (YOYAKU_END == "**")){
		return true;
	}else{
		YOYAKU_START = parseInt("-" + YOYAKU_START, 10);
		YOYAKU_END = parseInt("-" + YOYAKU_END, 10);

		if (parseInt(YOYAKU_TIMEIN_MODE, 10) == 0){
			
			wStartDate = DateAdd(YOYAKU_TIMEIN_KBN, YOYAKU_START, CheckDate);

			wStartDate = new Date(wStartDate)
			wyyyy = wStartDate.getFullYear();
			wmm = wStartDate.getMonth() + 1;
			wdd = wStartDate.getDate();
			if (wmm < 10){wmm = "0" + wmm};
			if (wdd < 10){wdd = "0" + wdd};

		}else{

			
			var wDate;
			var wCheckDate2;
			var i;
			switch (YOYAKU_TIMEIN_KBN) {
				case "Y":
					
					wDate = new Date(CheckDate);
					wyyyy = wDate.getFullYear();
					wCheckDate2 = "" + wyyyy + "/01/01";
					break;

				case "M":
					
					wDate = new Date(CheckDate);
					wyyyy = wDate.getFullYear();
					wmm = wDate.getMonth() + 1;
					wCheckDate2 = "" + wyyyy + "/" + wmm + "/01";
					break;

				case "W":
					
					for (i = 0; i < 7; i++){
						wDate = DateAdd("D", -1 * i, CheckDate);
						wDate = new Date(wDate);
						if (wDate.getDay() == 1){
							break;
						}
					}
					wYYYY = wDate.getFullYear();
					wMM = wDate.getMonth() + 1;
					wDD = wDate.getDate();
					wCheckDate2 = "" + wYYYY + "/" + wMM + "/" + wDD;
					break;
				case "D":
					wCheckDate2 = CheckDate;
					break;
			}


			if (YOYAKU_TIMEIN_DAY != "00") {
				switch (YOYAKU_TIMEIN_KBN) {
					case "Y":
					case "M":
						
						wDate = new Date(wCheckDate2);
						wyyyy = wDate.getFullYear();
						wmm = wDate.getMonth() + 1;
						if (wmm < 10){wmm = "0" + wmm};	

						wCheckDate2 = "" + wyyyy + "/" + wmm + "/" + YOYAKU_TIMEIN_DAY;
						if (ckDate(wCheckDate2) == false){
							
							wCheckDate2 = "" + wyyyy + "/" + wmm + "/01";	
							wCheckDate2 = new Date(wCheckDate2);	
							
							
							wDate = DateAdd("M", 1, wCheckDate2);
							wDate = new Date(wDate);
							wyyyy = wDate.getFullYear();
							wmm = wDate.getMonth() + 1;
							wdd = wDate.getDate();
							if (wmm < 10){wmm = "0" + wmm};
							if (wdd < 10){wdd = "0" + wdd};
							
							wCheckDate2 = "" + wyyyy +  "/" + wmm +  "/" + wdd ;
							wCheckDate2 = new Date(wCheckDate2);

							
							wDate = DateAdd("D", -1, wCheckDate2);
							wDate = new Date(wDate);
							wyyyy = wDate.getFullYear();
							wmm = wDate.getMonth() + 1;
							wdd = wDate.getDate();
							
							wCheckDate2 = "" + wyyyy + "/" + wmm + "/" + wdd;
						}
						break;
				}
			}


			wStartDate = DateAdd(YOYAKU_TIMEIN_KBN, YOYAKU_START, wCheckDate2);

			wStartDate = new Date(wStartDate)
			wyyyy = wStartDate.getFullYear();
			wmm = wStartDate.getMonth() + 1;
			wdd = wStartDate.getDate();
			if (wmm < 10){wmm = "0" + wmm};
			if (wdd < 10){wdd = "0" + wdd};
		}
		wStartDate = "" + wyyyy + wmm + wdd + YOYAKU_TIMEIN_TIME;

		if (parseInt(YOYAKU_TIMEOUT_MODE, 10) == 0){

			
			wEndDate = DateAdd(YOYAKU_TIMEOUT_KBN, YOYAKU_END, CheckDate);

			wEndDate = new Date(wEndDate);
			wyyyy = wEndDate.getFullYear();
			wmm = wEndDate.getMonth() + 1;
			wdd = wEndDate.getDate();
			if (wmm < 10){wmm = "0" + wmm};
			if (wdd < 10){wdd = "0" + wdd};

		}else{

			
			var wDate;
			var wCheckDate2;
			var i;
			switch (YOYAKU_TIMEOUT_KBN) {
				case "Y":
					
					wDate = new Date(CheckDate);
					wyyyy = wDate.getFullYear();
					wCheckDate2 = "" + wyyyy + "/01/01";
					break;

				case "M":
					
					wDate = new Date(CheckDate);
					wyyyy = wDate.getFullYear();
					wmm = wDate.getMonth() + 1;
					wCheckDate2 = "" + wyyyy + "/" + wmm + "/01";
					break;

				case "W":
					
					for (i = 0; i < 7; i++){
						wDate = DateAdd("D", -1 * i, CheckDate);
						wDate = new Date(wDate);
						if (wDate.getDay() == 1){
							break;
						}
					}
					wYYYY = wDate.getFullYear();
					wMM = wDate.getMonth() + 1;
					wDD = wDate.getDate();
					wCheckDate2 = "" + wYYYY + "/" + wMM + "/" + wDD;
					break;
				case "D":
					wCheckDate2 = CheckDate;
					break;
			}

			wEndDate = DateAdd(YOYAKU_TIMEOUT_KBN, YOYAKU_END, wCheckDate2);

			
			if ((YOYAKU_TIMEOUT_KBN == "Y") || (YOYAKU_TIMEOUT_KBN == "M") || (YOYAKU_TIMEOUT_KBN == "W")){
				wEndDate = DateAdd(YOYAKU_TIMEOUT_KBN, 1, wEndDate)
				wEndDate = DateAdd("D", -1, wEndDate)
			}

			if (YOYAKU_TIMEOUT_DAY != "00") {
				
				switch (YOYAKU_TIMEOUT_KBN) {
					case "Y":
					case "M":
						
						wDate = new Date(wEndDate);
						wyyyy = wDate.getFullYear();
						wmm = wDate.getMonth() + 1;
						if (wmm < 10){wmm = "0" + wmm};	

						wCheckDate2 = "" + wyyyy + "/" + wmm + "/" + YOYAKU_TIMEOUT_DAY;
						if (ckDate(wCheckDate2) == false){
							
							wCheckDate2 = "" + wyyyy + "/" + wmm + "/01";	
							wCheckDate2 = new Date(wCheckDate2);	
							
							
							wDate = DateAdd("M", 1, wCheckDate2);
							wDate = new Date(wDate);
							wyyyy = wDate.getFullYear();
							wmm = wDate.getMonth() + 1;
							wdd = wDate.getDate();
							if (wmm < 10){wmm = "0" + wmm};
							if (wdd < 10){wdd = "0" + wdd};
							
							wCheckDate2 = "" + wyyyy +  "/" + wmm +  "/" + wdd ;
							wCheckDate2 = new Date(wCheckDate2);

							
							wDate = DateAdd("D", -1, wCheckDate2);
							wDate = new Date(wDate);
							wyyyy = wDate.getFullYear();
							wmm = wDate.getMonth() + 1;
							wdd = wDate.getDate();
							
							wEndDate = "" + wyyyy + "/" + wmm + "/" + wdd;

						}else{
							wEndDate = wCheckDate2;
						}
						break;
				}
			}


			wEndDate = new Date(wEndDate);
			wyyyy = wEndDate.getFullYear();
			wmm = wEndDate.getMonth() + 1;
			wdd = wEndDate.getDate();
			if (wmm < 10){wmm = "0" + wmm};
			if (wdd < 10){wdd = "0" + wdd};
		}



			wEndDate = "" + wyyyy + wmm + wdd + YOYAKU_TIMEOUT_TIME;


		if (savYOYAKU_START != "**"){

			if (wToday >= wStartDate){
			}else{
				return false;
			}
		}

		if (savYOYAKU_END != "**"){

			if (wToday <= wEndDate){
			}else{
				return false;
			}
		}
	}
	return true;
}

function setMenData(i, j, k, Scd) {
	var ix0;
	var ix1;
	var tempArray0;
	var tempArray1;
	var wShisetuMenInfo;
	
	document.form1.txt_menParam.value = ""
	if ("000060".substr(0,3) == KAIKAN_KBN) {

		document.form1.txt_menParam.value = shisetuArray[i][k].substr(0, 3)+","+shisetuNameArray[i][k]+","+dateArray[i]+","+komaNameArray[i][k][j]+","+i+","+j+","+k;

	} else {

		document.form1.txt_menParam.value = shisetuArray[i][k].substr(0, 3)+","+shisetuNameArray[i][k]+","+dateArray[i]+","+komaNameArray[i][j]+","+i+","+j+","+k;

	}
	
	wShisetuMenInfo = ""
	tempArray0 = new Array();
	tempArray1 = new Array();
	tempArray0 = shisetuMenInfo.split(";");
	if (tempArray0[tempArray0.length - 1] == "") {
		tempArray0.length = tempArray0.length - 1;
	}
	for (ix0 = 0; ix0 < shisetuMenDateArray.length; ix0++) {
		if (shisetuMenDateArray[ix0].substr(0, 4) + "/" + shisetuMenDateArray[ix0].substr(4, 2) + "/" + shisetuMenDateArray[ix0].substr(6, 2) == dateArray[i]) {
			tempArray1 = tempArray0[ix0].split("|");
			if (tempArray1[tempArray1.length - 1] == "") {
				tempArray1.length = tempArray1.length - 1;
			}
		}
	}
	for (ix1 = 0; ix1 < tempArray1.length; ix1++) {
		if (tempArray1[ix1].substr(3, 3) == Scd) {		
			wShisetuMenInfo = wShisetuMenInfo + tempArray1[ix1] + ","

		}
	}
	document.form1.txt_shisetuMenInfo.value = wShisetuMenInfo;
	
	document.form1.txt_komaCondInfo.value = "2023101101002120,2023101101003120,2023101101004120,2023101101005120,2023101101006120,2023101101007120,2023101101008120,2023101101009120,2023101101010120,2023101101011120,2023101101012120,2023101101013120,2023101101014120,2023101101015120,2023101102002032023021342,2023101102003032023021342,2023101102004012023020182,2023101102006022023017398,2023101102007012023019805,2023101102008012023020167,2023101102009012023019426,2023101102010012023019428,2023101102013022023017400,2023101102014022023017409,2023101102015120,2023101103002032023021342,2023101103003032023021342,2023101103004012023020198,2023101103005032023021342,2023101103006012023020193,2023101103007012023019805,2023101103008012023020167,2023101103009012023019426,2023101103010012023018990,2023101103011012023020164,2023101103013012023020185,2023101103014022023017415,2023101104002032023021342,2023101104003032023021342,2023101104004012023020194,2023101104005012023020194,2023101104006012023020062,2023101104007012023019059,2023101104008012023020175,2023101104009032023021342,2023101104010012023019002,2023101104011032023021342,2023101104013012023019705,2023101104014012023019312,2023101105002032023021342,2023101105003032023021342,2023101105004012023019108,2023101105005012023020195,2023101105006012023020062,2023101105007012023019056,2023101105008012023020126,2023101105009032023021342,2023101105010012023020172,2023101105011012023020195,2023101105013012023020183,2023101105014012023019311,2023101106001120,2023101106002120,2023101106003120,2023101106004120,2023101106005120,2023101106006120,2023101106007120,2023101106008120,2023101106009120,2023101106010120,2023101106011120,2023101107013022023017393,";

	document.form1.txt_yoyaku_wrk.value = yoyaku;
}

function clearApplyInfo() {
	var i, j;
	var count;
	var itemIndex;
	var ret;
	var target;
	if ("" != "") {
		count = parseInt("", 10);
		if (count > 0) {
			for (i = 0; i < count; i++) {
				itemIndex = i + 1;
				target = document.form1.elements["KAISHI_M_" + itemIndex];
				if (target != null) {	target.value = "";	}
				target = document.form1.elements["KAISHI_H_" + itemIndex];
				if (target != null) {	target.value = "";	}
				target = document.form1.elements["SYURYO_M_" + itemIndex];
				if (target != null) {	target.value = "";	}
				target = document.form1.elements["SYURYO_H_" + itemIndex];
				if (target != null) {	target.value = "";	}
				target = document.form1.elements["BUNRUI1_" + itemIndex];
				if (target != null) {	target.value = "";	}
				target = document.form1.elements["BUNRUI2_" + itemIndex];
				if (target != null) {	target.value = "";	}
				target = document.form1.elements["NUM_" + itemIndex];
				if (target != null) {	target.value = "";	}
				target = document.form1.elements["setubis_cd_" + itemIndex];
				if (target != null) {	target.value = "";	}
				target = document.form1.elements["setubi_cd_" + itemIndex];
				if (target != null) {	target.value = "";	}
				target = document.form1.elements["setubi_suryo_" + itemIndex];
				if (target != null) {	target.value = "";	}

				target = document.form1.elements["setubi_jikan_" + itemIndex];
				if (target != null) {	target.value = "";	}

				target = document.form1.elements["setubi_s_date_" + itemIndex];
				if (target != null) {	target.value = "";	}

				target = document.form1.elements["setubi_syubetu_" + itemIndex];
				if (target != null) {	target.value = "";	}

				target = document.form1.elements["setubi_zaiko_" + itemIndex];
				if (target != null) {	target.value = "";	}

				
				target = document.form1.elements["KOJIN_NUM_" + itemIndex];
				if (target != null) {
					target.value = "";
				}


				target = document.form1.elements["lst_ren_account_" + itemIndex];
				if (target != null) {
					target.value = "";
				}
				target = document.form1.elements["lst_nyu_account_" + itemIndex];
				if (target != null) {
					target.value = "";
				}
				target = document.form1.elements["lst_eir_account_" + itemIndex];
				if (target != null) {
					target.value = "";
				}
				target = document.form1.elements["lst_nyu_kasan_" + itemIndex];
				if (target != null) {
					target.value = "";
				}


			}
			target = document.form1.elements["setubi_find"];
			if (target != null) {	target.value = "";	}

			
			target = document.form1.elements["kojin_flg"];
			if (target != null) {
				target.value = "";
			}

			target = document.form1.elements["lst_dantaigenmen"];
			if (target != null) {
				target.value = "";
			}
			target = document.form1.elements["lst_tiikikasan"];
			if (target != null) {
				target.value = "";
			}

		}
	}
}

function clearUserInfo() {

	document.form1.lst_dantaigenmen.value = "";
	document.form1.lst_tiikikasan.value = "";


	document.form1.ninsyo_flg.value = "";
	var i;



}

function clearInputData() {

	document.form1.txtSelKomaPtnNo.value = "";

	clearApplyInfo();
}

function buildReserveTable() {
	var currentDate;	
	var thisDate = "2023/10/11";
	var komaBGColor;
	var i, j, k, m;
	var breakout;
	
	var objsDate;
	var objsDate1;
	var objsDate2;
	
	var indexKeyStr = "";
	var iStr = "";
	var jStr = "";
	var kStr = "";

	
	var CheckDate;
	var wTIMEIN_KBN;
	var wSTART;
	var wTIMEOUT_KBN;
	var wEND;
	var wYOKUNEN;
	var wYOYAKU_TIMEIN_TIME;
	var wYOYAKU_TIMEOUT_TIME;
	var wYOYAKU_TIMEIN_MODE;
	var wYOYAKU_TIMEOUT_MODE;

	var wYOYAKU_TIMEIN_DAY;
	var wYOYAKU_TIMEOUT_DAY;

	var strKomaImage;
	var strKomaAlt;


	thisDate = new Date(thisDate);
	thisDate.setHours(0);
	thisDate.setMinutes(0);
	thisDate.setSeconds(0);
	thisDate.setMilliseconds(0);
	objsDate = new Date(sDate);
	objsDate1 = new Date(sDate1);
	objsDate2 = new Date(sDate2);
	var beforeDate;
	var nextDate;
	var mm;
	var dd;
	mm = "00" + (objsDate1.getMonth()+1);
	mm = mm.substr(mm.length-2,2)
	dd = "00" + objsDate1.getDate();
	dd = dd.substr(dd.length-2,2)
	beforeDate = objsDate1.getFullYear() + mm + dd;
	mm = "00" + (objsDate2.getMonth()+1);
	mm = mm.substr(mm.length-2,2)
	dd = "00" + objsDate2.getDate();
	dd = dd.substr(dd.length-2,2)
	nextDate = objsDate2.getFullYear() + mm + dd;
	
	var visibleShisetuCount;
	visibleShisetuCount = 0;
	for (i = 0; i < shisetuHeaderArray.length; i++) {
		for (j = 0; j < dateArray.length; j++) {
			if (shisetuNameArray[j][i] != 0) {
				breakout = false;
				for (k = 0; k < shisetuArray.length; k++) {
					if (shisetuArray[k][i] != 0) {
						if (shisetuArray[k][i].substr(12, 1) == 1) {	
							visibleShisetuCount++;
							breakout = true;
							break;
						}
					}
				}
			}
		}
	}


	var dateidx;
	var datecnt;
	var shisetuidx;
	var komastr;
	var komainfoArray = new Array();
	var koma_idx;
	var komacnt;
	var komasu;
	var time_idx;
	var time_idx2;
	var min_s_time;
	var max_e_time;
	var s_time;
	var e_time;
	var next_s_time;
	var next_e_time;
	var start_time;
	var end_time;
	var time_cnt;
	var timeArray = new Array();
	var wktime;
	var wktime_hh;
	var wktime_mm;
	var time1;
	var time2;
	var colspan;
	var time_pos1;
	var time_pos2;
	var header_line;
	var display_cnt;
	
	var kyukanbi_uketuke_flg;
	
	datecnt = dateArray.length;

	
	min_s_time = "2400";
	max_e_time = "0000";
	for (i = 0; i < dateArray.length; i++){
		if (komaCount > 0){
			for (k = 0; k < komaArray[i].length; k++){
				if (komaArray[i][k] != null) {
					if (komaArray[i][k][0] != null) {
						
						breakout = false;
						for (m = 0; m < shisetuArray[i].length; m++){

							if (shisetuArray[i][m] != "0" ){

								if (komaArray[i][k][0].substr(8, 3) == shisetuArray[i][m].substr(0, 3)){
									if (shisetuArray[i][m].substr(12, 1) == "1"){
										breakout = true;
										break;
									}
								}

							}

						}
						
						if (breakout == true){
							komasu = komaArray[i][k][0].substr(11, 2);
							for (j = 0; j < komasu; j++){
								komastr = komaArray[i][k][j];
								if (j == 0){
									komastr = komaArray[i][k][j].substr(13, komaArray[i][k][j].length - 13);
								}else{
									komastr = komaArray[i][k][j];
								}
								komainfoArray = komastr.split("_");
								s_time = komainfoArray[0].substr(0, 4);
								e_time = komainfoArray[0].substr(4, 4);

								if (min_s_time > s_time) {
									min_s_time = s_time;
								}
								if (max_e_time < e_time) {
									max_e_time = e_time;
								}
							}
						}
					}
				}
			}
		}
	}

	
	start_time = parseInt(min_s_time.substr(0, 2), 10);

	
	if (parseInt(max_e_time.substr(2, 2), 10) == 0){
		end_time = parseInt(max_e_time.substr(0, 2), 10);
	}else{
		end_time = parseInt(max_e_time.substr(0, 2), 10) + 1;
	}

	
	time_cnt = 0
	for (time_idx = start_time; time_idx <= end_time; time_idx++) {
		if (time_idx < end_time) {

			for (time_idx2 = 0; time_idx2 <= 59; time_idx2 ++) {
				if (time_idx2 % 15 == 0){
					wktime_hh = "00" + time_idx;
					wktime_hh = wktime_hh.substr(wktime_hh.length - 2, 2);
					wktime_mm = "00" + time_idx2;
					wktime_mm = wktime_mm.substr(wktime_mm.length - 2, 2);
					timeArray[time_cnt] = "" + wktime_hh + wktime_mm;
					time_cnt = time_cnt + 1;
				}
			}
		}else{
			wktime_hh = "00" + time_idx;
			wktime_hh = wktime_hh.substr(wktime_hh.length - 2, 2);
			wktime_mm = "00";
			timeArray[time_cnt] = "" + wktime_hh + wktime_mm;
			time_cnt = time_cnt + 1;
		}
	}

	
	for (i = 0; i < dateArray.length; i++){

		var wkDate = new Date(dateArray[i]);

		currentDate = new Date(dateArray[i]);
		currentDate.setHours(0);
		currentDate.setMinutes(0);
		currentDate.setSeconds(0);
		currentDate.setMilliseconds(0);

		
		document.write ("<table class='clsKoma' width='100%'>");

		
		document.write("<tr class='clsNone'>");
		document.write("<td class='clsMark' rowspan='3'>");

		document.write("</td>");
		document.write("<td class='clsKomaBlank' colspan='" + time_cnt + "'>");

		
		document.write("<table class='clsKomaHeader' width='100%'>");
		document.write("<tr class='clsNone'>");
		document.write("<th class='clsKomaTitle1' nowrap>");
		document.write("<a href=javascript:set_cal(" + beforeDate + "," + startDay + "," + endDay + ")>");
		document.write("<img class='clsNone' alt='前日表示' src='" + imageLeft + "' border='0'></a>");
		document.write("<a href=javascript:set_cal(" + nextDate + "," + startDay + "," + endDay + ")>");
		document.write("<img class='clsNone' alt='翌日表示' src='" + imageRight + "' border='0'></a>");
		document.write("</th>");
		document.write("<th class='clsKomaTitle2' nowrap>");
		document.write(currentDate.getFullYear() + "年" + (currentDate.getMonth()+1) + "月" + currentDate.getDate() + "日（" + dayArray[i] + "）");
		document.write("</th>");
		document.write("<th class='clsKomaTitle1' nowrap>");
		document.write("<a href=javascript:set_cal(" + beforeDate + "," + startDay + "," + endDay + ")>");
		document.write("<img class='clsNone' alt='前日表示' src='" + imageLeft + "' border='0'></a>");
		document.write("<a href=javascript:set_cal(" + nextDate + "," + startDay + "," + endDay + ")>");
		document.write("<img class='clsNone' alt='翌日表示' src='" + imageRight + "' border='0'></a>");
		document.write("</th>");
		document.write("</tr>");
		document.write("</table>");
		document.write("</td>");
		document.write("</tr>");

		
		document.write ("<tr class='clsNone'>");
		if (komaCount > 0){
			for (time_idx = start_time; time_idx < end_time; time_idx++){
				document.write ("<td class='clsKomaTimeHour' colspan='4'>");
				document.write (time_idx + ":00");
				document.write ("</td>");
			}
		}else{
			document.write ("<td class='clsKomaTimeHour'>&nbsp;</td>");
		}
		document.write ("</tr>");

		
		document.write ("<tr class='clsNone' height='15'>");
		if (komaCount > 0){
			for (time_idx = 0; time_idx < time_cnt - 1; time_idx++){
				document.write ("<td class='clsKomaTimeMinute'>&nbsp;</td>");
			}
		}else{
			document.write ("<td class='clsKomaTimeMinute'>&nbsp;</td>");
		}
		document.write ("</tr>");

		
		header_line = "";
		
		header_line = header_line + "<tr class='clsNone' height='15'>";
		header_line = header_line + "<td class='clsMark' rowspan='3'>";

		header_line = header_line + "</td>";

		
		if (komaCount > 0){
			for (time_idx = 0; time_idx < time_cnt - 1; time_idx++){
				header_line = header_line + "<td class='clsKomaTimeMinute'>&nbsp;</td>";
			}
		}else{
			header_line = header_line + "<td class='clsKomaTimeMinute'>&nbsp;</td>";
		}
		header_line = header_line + "</tr>";

		
		header_line = header_line + "<tr class='clsNone' height='15'>";
		if (komaCount > 0){
			for (time_idx = start_time; time_idx < end_time; time_idx++){
				header_line = header_line + "<td class='clsKomaTimeHour' colspan='4'>";
				header_line = header_line + time_idx + ":00";
				header_line = header_line + "</td>";
			}
		}else{
			header_line = header_line + "<td class='clsKomaTimeHour' >&nbsp;</td>";
		}
		header_line = header_line + "</tr>";

		
		header_line = header_line + "	<tr class='clsNone' height='15'>";
		if (komaCount > 0){
			for (time_idx = 0; time_idx < time_cnt - 1; time_idx++){
				header_line = header_line + "<td class='clsKomaTimeMinute'>&nbsp;</td>";
			}
		}else{
			header_line = header_line + "<td class='clsKomaTimeMinute'>&nbsp;</td>";
		}
		header_line = header_line + "</tr>";

		display_cnt = 0;

		
		for (k = 0; k < shisetuArray[i].length; k++) {
			if (shisetuArray[i][k] != 0) {

				
				breakout = false;
				for (m = 0; m < dateArray.length; m++) {
					if (shisetuArray[m][k] != 0) {
						if (shisetuArray[m][k].substr(12, 1) == 1) {
							breakout = true;
							break;
						}
					}
				}
				if (breakout == true) {

					
					if ((display_cnt > 0) && (display_cnt % 10 == 0)){
						document.write(header_line);
					}

					document.write("<tr class='clsNone'>");

					
					document.write("<th class='clsShisetuTitleOneDay' scope='col' id='Shisetu_" + k + "' width='120' height='25' nowrap>");
					
					if (shisetuArray[i][k].substr(7, 1) == 2){
						document.write("&nbsp;&nbsp;");
					}

					if (shisetuBoxNoArray[i][k] != null) {
						if (shisetuBoxNoArray[i][k].length != 0) {
							document.write("<a href='" + shisetuBoxNoArray[i][k] + "' target='_blank'>");
						}
					}
					document.write(shisetuNameArray[i][k]);
					if (shisetuBoxNoArray[i][k] != null) {
						if (shisetuBoxNoArray[i][k].length != 0) {
							document.write("</a>");
						}
					}

					document.write("</th>");

					komaBGColor = komaNormalBGColor;

					
					if (komaCount > 0){

						
						var kk;
						breakout = false;
						for (kk = 0; kk < komaArray[i].length; kk++){
							if (shisetuArray[i][k].substr(0, 3) == komaArray[i][kk][0].substr(8, 3)){
								breakout = true;
								break;
							}
						}
						if (breakout == true){
							komasu = komaArray[i][kk][0].substr(11, 2);
							for (j = 0; j < komasu; j++){
								komastr = komaArray[i][kk][j];
								if (j == 0){
									komastr = komaArray[i][kk][j].substr(13, komaArray[i][kk][j].length - 13);
								}else{
									komastr = komaArray[i][kk][j];
								}
								komainfoArray = komastr.split("_");
								s_time = komainfoArray[0].substr(0, 4);
								e_time = komainfoArray[0].substr(4, 4);


								
								if (j == 0){
									if (s_time != timeArray[0]){
										time1 = s_time;
										time2 = timeArray[0];

										time_pos1 = -1;
										time_pos2 = -1;
										for (time_idx = 0 ; time_idx < time_cnt; time_idx++){
											if (time1 == timeArray[time_idx]){
												time_pos1 = time_idx;
											}
											if (time2 == timeArray[time_idx]){
												time_pos2 = time_idx;
											}
										}
										colspan = time_pos1 - time_pos2;
										document.write ("<td class='clsKomaBlank' headers='Shisetu_" + k + "' colspan='" + colspan + "' nowrap>");
										document.write ("</td>");
									}
								}

								
								time1 = s_time;
								time2 = e_time;
								time_pos1 = -1;
								time_pos2 = -1;
								for (time_idx = 0; time_idx < time_cnt; time_idx++){
									if (time1 == timeArray[time_idx]){
										time_pos1 = time_idx;
									}
									if (time2 == timeArray[time_idx]){
										time_pos2 = time_idx;
									}
								}
								colspan = time_pos2 - time_pos1;
								document.write ("<td class='clsKoma' headers='Shisetu_" + k + "' colspan='" + colspan + "'>");

								
								indexKeyStr = "";
								iStr = "";
								jStr = "";
								kStr = "";
								iStr = "000" + i;
								iStr = iStr.substr(iStr.length - 3, 3);
								jStr = "000" + j;
								jStr = jStr.substr(jStr.length - 3, 3);
								kStr = "000" + k;
								kStr = kStr.substr(kStr.length - 3, 3);
								indexKeyStr = iStr + jStr + kStr;

								
								if (shisetuArray[i][k] != 0) {
									breakout = false;
									for (m = 0; m < shisetuArray.length; m++) {
										if (shisetuArray[m][k] != 0) {
											if (shisetuArray[m][k].substr(12, 1) == 1) {
												breakout = true;
												break;
											}
										}
									}
									if (breakout == true) {
										if (shisetuArray[i][k].substr(12,1) == 1) {		
											if (shisetuArray[i][k].substr(3,1) == 1) {	
												CheckDate = dateArray[i];
												wTIMEIN_KBN = shisetuArray[i][k].substr(11,1);
												wSTART = shisetuArray[i][k].substr(4,2);
												wTIMEOUT_KBN = shisetuArray[i][k].substr(41,1);
												wEND = shisetuArray[i][k].substr(42,2);
												wYOKUNEN = shisetuArray[i][k].substr(6,1);
												wYOYAKU_TIMEIN_TIME = shisetuArray[i][k].substr(44,4);
												wYOYAKU_TIMEOUT_TIME = shisetuArray[i][k].substr(48,4);
												wYOYAKU_TIMEIN_MODE = shisetuArray[i][k].substr(52,1);
												wYOYAKU_TIMEOUT_MODE = shisetuArray[i][k].substr(53,1);

												wYOYAKU_TIMEIN_DAY =  shisetuArray[i][k].substr(54, 2);
												wYOYAKU_TIMEOUT_DAY =  shisetuArray[i][k].substr(56, 2);
	
												var wkKomacond = komaCondArray[i][j][k];

                                                kyukanbi_uketuke_flg = false;
                                                if (shisetuArray[i][k].substr(58, 1) == "1") {
                                                    kyukanbi_uketuke_flg = true;
                                                    if (komaCondArray[i][j][k] != 0) {
                                                        if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
                                                            kyukanbi_uketuke_flg = false;
                                                        }
                                                    }
                                                }
                                                if (CheckUketukeKikan(CheckDate, wTIMEIN_KBN, wSTART, wTIMEOUT_KBN, wEND, wYOKUNEN, wkKomacond, wYOYAKU_TIMEIN_TIME, wYOYAKU_TIMEOUT_TIME, wYOYAKU_TIMEIN_MODE, wYOYAKU_TIMEOUT_MODE,wYOYAKU_TIMEIN_DAY,wYOYAKU_TIMEOUT_DAY) == true && kyukanbi_uketuke_flg == false){

													if (komaArray[i][kk] != null) {
														if (komaArray[i][kk][j] == -1) {
															document.write("<br>");
														} else {
															if (currentDate >= thisDate) {
																
																var currentKomaCount;
																currentKomaCount = 0;
																for (m =0; m < komaArray[i].length; m++) {
																	if (komaArray[i][m][0].substr(8,3) == shisetuArray[i][k].substr(0,3)) {
																		currentKomaCount = parseInt(komaArray[i][m][0].substr(11,2), 10);
																		break;
																	}
																}
																if (currentKomaCount > j) {
																	if (komaCondArray[i][j][k] == 0) {

																		if ((shisetuArray[i][k].substr(32, 4) == "0000") && (shisetuArray[i][k].substr(36, 4) == "0000")) {

																			if (shisetuArray[i][k].substr(40, 1) == 1) {
																				var Result;
																				Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
																				if (Result == "PartEmpty"){
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='予約可能' src='" + imgPartEmpty + "' name=image" + indexKeyStr + "><br>");
																				}else{
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																				}
																			}else{
																				strKomaImage = getKomaImageFileName2(i, j, k);
																				strKomaAlt = getKomaAlt(strKomaImage);
																				document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																			}
																		} else {
																			if (shisetuArray[i][k].substr(32, 4) <= "1452" && shisetuArray[i][k].substr(36, 4) >= "1452") {
																				//'↓MOD 20211125 CNC AWS-MOD-000018
																				//strKomaImage = getKomaImageFileName2(i, j, k);
																				//strKomaAlt = getKomaAlt(strKomaImage);
																				//document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																				if (shisetuArray[i][k].substr(40, 1) == 1) {
																					var Result;
																					Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
																					if (Result == "PartEmpty"){
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='予約可能' src='" + imgPartEmpty + "' name=image" + indexKeyStr + "><br>");
																					}else{
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																					}
																				}else{
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																				}
																				//'↑MOD 20211125 CNC AWS-MOD-000018
																			} else {
																				document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "></a><br>");
																			}
																		}
																	} else {
																		
																		if (shisetuArray[i][k].substr(40, 1) == 1) {
																			switch (komaCondArray[i][j][k]) {
																				case "Reserve":				
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");
																					break;
																				case "Empty2":				
																					document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																					break;
																				default:					
																					if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																						if (LotKanriArray[i][k] == 0) {
																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);
																							document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																						} else {
																							var lotStartDate;
																							var lotEndDate;
																							lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																							lotStartDate.setHours(0);
																							lotStartDate.setMinutes(0);
																							lotStartDate.setSeconds(0);
																							lotStartDate.setMilliseconds(0);
																							lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																							lotEndDate.setHours(0);
																							lotEndDate.setMinutes(0);
																							lotEndDate.setSeconds(0);
																							lotEndDate.setMilliseconds(0);

																							var Result;
																							Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
																							if (Result == "PartEmpty"){

																								if (thisDate >= lotStartDate && thisDate <= lotEndDate) {

																								strKomaImage = getKomaImageFileName2(i, j, k);
																								strKomaAlt = getKomaAlt(strKomaImage);
																								document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																								} else {
																									document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																								}

																							} else if (Result == "AllReserve") {

																								document.write("<Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");

																							}else{
																								if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																									strKomaImage = getKomaImageFileName2(i, j, k);
																									strKomaAlt = getKomaAlt(strKomaImage);
																									document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																								} else {
																									document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																								}
																							}

																						}
																					} else {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																					}
																			}
																		} else {
																			if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) <= 8) {
																				strKomaImage = getKomaImageFileName2(i, j, k);
																				strKomaAlt = getKomaAlt(strKomaImage);
																				document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																			} else {
																				if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																					if (LotKanriArray[i][k] == 0) {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																					} else {
																						var lotStartDate;
																						var lotEndDate;
																						lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																						lotStartDate.setHours(0);
																						lotStartDate.setMinutes(0);
																						lotStartDate.setSeconds(0);
																						lotStartDate.setMilliseconds(0);
																						lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																						lotEndDate.setHours(0);
																						lotEndDate.setMinutes(0);
																						lotEndDate.setSeconds(0);
																						lotEndDate.setMilliseconds(0);
																						if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);
																							document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																						} else {
																							document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																						}
																					}
																				} else {
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																				}
																			}
																		}
																	}
																}else {
																	document.write("<br>");
																}
															} else {
																if (getKomaImageFileName(i, j, k) == imgEmpty) {  
																	strKomaImage = getKomaImageFileName2(i, j, k);
																	strKomaAlt = getKomaAlt(strKomaImage);
																	document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																} else {
																	
																	if (komaCondArray[i][j][k] == 0) {
																		strKomaImage = getKomaImageFileName2(i, j, k);
																		strKomaAlt = getKomaAlt(strKomaImage);
																		document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																	} else {
																		if (shisetuArray[i][k].substr(40, 1) == 1) {
																			switch (komaCondArray[i][j][k]) {
																				case "Reserve":				
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");
																					break;
																				case "Empty2":				
																					document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																					break;
																				default:					
																					if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																						document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																					} else {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																					}
																			}
																		} else {
																			if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) <= 8) {
																				strKomaImage = getKomaImageFileName2(i, j, k);
																				strKomaAlt = getKomaAlt(strKomaImage);
																				document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																			} else {
																				if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																					if (LotKanriArray[i][k] == 0) {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																					} else {
																						var lotStartDate;
																						var lotEndDate;
																						lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																						lotStartDate.setHours(0);
																						lotStartDate.setMinutes(0);
																						lotStartDate.setSeconds(0);
																						lotStartDate.setMilliseconds(0);
																						lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																						lotEndDate.setHours(0);
																						lotEndDate.setMinutes(0);
																						lotEndDate.setSeconds(0);
																						lotEndDate.setMilliseconds(0);
																						if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);
																							document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																						} else {
																							document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																						}
																					}
																				} else {
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																				}
																			}
																		}
																	}
																}
															}
														}
													} else {
														var currentKomaCount;
														currentKomaCount = 0;
														
														for (m =0; m < komaArray[i].length; m++) {
															if (komaArray[i][m] != null) {
																if (komaArray[i][m][0].substr(8,3) == shisetuArray[i][k].substr(0,3)) {
																	currentKomaCount = parseInt(komaArray[i][m][0].substr(11,2), 10);
																	break;
																}
															}
														}
														
														if (currentKomaCount > j) {
															
															if (komaCondArray[i][j][k] == 0) {
																strKomaImage = getKomaImageFileName2(i, j, k);
																strKomaAlt = getKomaAlt(strKomaImage);
																document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + i + j + k + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
															} else {
																if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) <= 8) {
																	strKomaImage = getKomaImageFileName2(i, j, k);
																	strKomaAlt = getKomaAlt(strKomaImage);
																	document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																} else {
																	if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																		if (LotKanriArray[i][k] == 0) {
																			strKomaImage = getKomaImageFileName2(i, j, k);
																			strKomaAlt = getKomaAlt(strKomaImage);
																			document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																		} else {
																			var lotStartDate;
																			var lotEndDate;
																			lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																			lotStartDate.setHours(0);
																			lotStartDate.setMinutes(0);
																			lotStartDate.setSeconds(0);
																			lotStartDate.setMilliseconds(0);
																			lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																			lotEndDate.setHours(0);
																			lotEndDate.setMinutes(0);
																			lotEndDate.setSeconds(0);
																			lotEndDate.setMilliseconds(0);
																			if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																				strKomaImage = getKomaImageFileName2(i, j, k);
																				strKomaAlt = getKomaAlt(strKomaImage);
																				document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																			} else {
																				document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																			}
																		}

																	} else {
																		strKomaImage = getKomaImageFileName2(i, j, k);
																		strKomaAlt = getKomaAlt(strKomaImage);
																		document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + i + j + k + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																	}
																}
															}
														} else {
															document.write("<br>");
														}
													}
												}else{
													var wkDate2;
													var wkDate3;
													var wkDate4;
													wkDate2 = "" + CheckDate.substr(0 ,4) + CheckDate.substr(5 ,2) + CheckDate.substr(8 ,2);
													wkDate3 = "20231011";
													wkDate4 = "202310111452";
													if (komaArray[i][kk][j] != -1) {

															if ((wkYOYAKU_START > wkDate4) || kyukanbi_uketuke_flg == true){

																document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgEmpty3 + "' name=image" + indexKeyStr + "><br>");
															}else{
																
																if (komaCondArray[i][j][k] == 0) {

																	if ((shisetuArray[i][k].substr(32, 4) == "0000") && (shisetuArray[i][k].substr(36, 4) == "0000")) {

																		if (shisetuArray[i][k].substr(40, 1) == 1) {
																			var Result;
																			Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
																			if (Result == "PartEmpty"){
																				
																				document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																				document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																				document.write("</a>");
																			}else{
																				
																				document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																				document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																				document.write("</a>");
																			}
																		}else{
																			strKomaImage = getKomaImageFileName2(i, j, k);
																			if (strKomaImage == imgEmpty) {
																				strKomaImage = imgEmpty2;
																			}
																			strKomaAlt = getKomaAlt(strKomaImage);
																			document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																		}
																	} else {
																		strKomaImage = getKomaImageFileName2(i, j, k);
																		if (strKomaImage == imgEmpty) {
																			strKomaImage = imgEmpty2;
																		}
																		strKomaAlt = getKomaAlt(strKomaImage);
																		document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																	}
																} else {
																	
																	if (shisetuArray[i][k].substr(40, 1) == 1) {
																		switch (komaCondArray[i][j][k]) {
																			case "Reserve":				
																				document.write("<Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");
																				break;
																			case "Empty2":				
																				document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																				break;
																			default:					
																				if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																					if (LotKanriArray[i][k] == 0) {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																					} else {
																						var lotStartDate;
																						var lotEndDate;
																						lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																						lotStartDate.setHours(0);
																						lotStartDate.setMinutes(0);
																						lotStartDate.setSeconds(0);
																						lotStartDate.setMilliseconds(0);
																						lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																						lotEndDate.setHours(0);
																						lotEndDate.setMinutes(0);
																						lotEndDate.setSeconds(0);
																						lotEndDate.setMilliseconds(0);

																						var Result;
																						Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
																						if (Result == "PartEmpty"){

																							if (thisDate >= lotStartDate && thisDate <= lotEndDate) {

																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);
																							document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																							} else {
																								document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																							}

																						} else if (Result == "AllReserve") {

																							document.write("<Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");

																						}else{
																							if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																								strKomaImage = getKomaImageFileName2(i, j, k);
																								strKomaAlt = getKomaAlt(strKomaImage);
																								document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																							} else {
																								document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																							}
																						}

																					}
																				} else {
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																				}
																		}
																	} else {
																		if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) <= 8) {
																			strKomaImage = getKomaImageFileName2(i, j, k);
																			strKomaAlt = getKomaAlt(strKomaImage);
																			document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																		} else {
																			if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																				if (LotKanriArray[i][k] == 0) {
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																				} else {
																					var lotStartDate;
																					var lotEndDate;
																					lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																					lotStartDate.setHours(0);
																					lotStartDate.setMinutes(0);
																					lotStartDate.setSeconds(0);
																					lotStartDate.setMilliseconds(0);
																					lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																					lotEndDate.setHours(0);
																					lotEndDate.setMinutes(0);
																					lotEndDate.setSeconds(0);
																					lotEndDate.setMilliseconds(0);
																					if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																					} else {
																						document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																					}
																				}
																			} else {
																				strKomaImage = getKomaImageFileName2(i, j, k);
																				strKomaAlt = getKomaAlt(strKomaImage);
																				document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																			}
																		}
																	}
																}
															}

													}
												}
											} else {
												if (komaArray[i][kk][j] == -1) {
													document.write("<br>");
												} else {
													
													CheckDate = dateArray[i];
													wTIMEIN_KBN = shisetuArray[i][k].substr(11,1);
													wSTART = shisetuArray[i][k].substr(4,2);
													wTIMEOUT_KBN = shisetuArray[i][k].substr(41,1);
													wEND = shisetuArray[i][k].substr(42,2);
													wYOKUNEN = shisetuArray[i][k].substr(6,1);
													wYOYAKU_TIMEIN_TIME = shisetuArray[i][k].substr(44,4);
													wYOYAKU_TIMEOUT_TIME = shisetuArray[i][k].substr(48,4);
													wYOYAKU_TIMEIN_MODE = shisetuArray[i][k].substr(52,1);
													wYOYAKU_TIMEOUT_MODE = shisetuArray[i][k].substr(53,1);

													wYOYAKU_TIMEIN_DAY =  shisetuArray[i][k].substr(54, 2);
													wYOYAKU_TIMEOUT_DAY =  shisetuArray[i][k].substr(56, 2);
	
													var wkKomacond = komaCondArray[i][j][k];

                                                    kyukanbi_uketuke_flg = false;
                                                    if (shisetuArray[i][k].substr(58, 1) == "1") {
                                                        kyukanbi_uketuke_flg = true;
                                                        if (komaCondArray[i][j][k] != 0) {
                                                            if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
                                                                kyukanbi_uketuke_flg = false;
                                                        }
                                                    }
                                                    }
                                                    if (CheckUketukeKikan(CheckDate, wTIMEIN_KBN, wSTART, wTIMEOUT_KBN, wEND, wYOKUNEN, wkKomacond, wYOYAKU_TIMEIN_TIME, wYOYAKU_TIMEOUT_TIME, wYOYAKU_TIMEIN_MODE, wYOYAKU_TIMEOUT_MODE,wYOYAKU_TIMEIN_DAY,wYOYAKU_TIMEOUT_DAY) == true && kyukanbi_uketuke_flg == false){

														if (komaArray[i][kk] != null) {
															if (komaArray[i][kk][j] == -1) {
																document.write("<br>");
															} else {
																if (currentDate >= thisDate) {
																	
																	var currentKomaCount;
																	currentKomaCount = 0;
																	for (m =0; m < komaArray[i].length; m++) {
																		if (komaArray[i][m][0].substr(8,3) == shisetuArray[i][k].substr(0,3)) {
																			currentKomaCount = parseInt(komaArray[i][m][0].substr(11,2), 10);
																			break;
																		}
																	}
																	if (currentKomaCount > j) {
																		if (komaCondArray[i][j][k] == 0) {

																			if ((shisetuArray[i][k].substr(32, 4) == "0000") && (shisetuArray[i][k].substr(36, 4) == "0000")) {

																				if (shisetuArray[i][k].substr(40, 1) == 1) {
																					var Result;
																					Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
																					if (Result == "PartEmpty"){
																						
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																						document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																						document.write("</a>");
																					}else{
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																						document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																						document.write("</a>");
																					}
																				}else{
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																				}
																			} else {

																				if (shisetuArray[i][k].substr(40, 1) == 1) {
																					if (shisetuArray[i][k].substr(32, 4) <= "1452" && shisetuArray[i][k].substr(36, 4) >= "1452") {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);


																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");


																						document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");


																						document.write("</a>");


																					} else {
																						document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "></a><br>");
																					}
																				}else{
																					if (shisetuArray[i][k].substr(32, 4) <= "1452" && shisetuArray[i][k].substr(36, 4) >= "1452") {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																					} else {
																						document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "></a><br>");
																					}
																				}


																			}
																		} else {
																			
																			if (shisetuArray[i][k].substr(40, 1) == 1) {
																				switch (komaCondArray[i][j][k]) {
																					case "Reserve":				
																						document.write("<Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");
																						break;
																					case "Empty2":				
																						document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																						break;
																					default:					
																						if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																							if (LotKanriArray[i][k] == 0) {
																								strKomaImage = getKomaImageFileName2(i, j, k);
																								strKomaAlt = getKomaAlt(strKomaImage);
																								document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																							} else {
																								var lotStartDate;
																								var lotEndDate;
																								lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																								lotStartDate.setHours(0);
																								lotStartDate.setMinutes(0);
																								lotStartDate.setSeconds(0);
																								lotStartDate.setMilliseconds(0);
																								lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																								lotEndDate.setHours(0);
																								lotEndDate.setMinutes(0);
																								lotEndDate.setSeconds(0);
																								lotEndDate.setMilliseconds(0);

																								var Result;
																								Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
																								if (Result == "PartEmpty"){

																									if (thisDate >= lotStartDate && thisDate <= lotEndDate) {

																									strKomaImage = getKomaImageFileName2(i, j, k);
																									strKomaAlt = getKomaAlt(strKomaImage);
																									document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																									} else {
																										document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																									}

																								} else if (Result == "AllReserve") {

																									document.write("<Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");

																								}else{
																									if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																										strKomaImage = getKomaImageFileName2(i, j, k);
																										strKomaAlt = getKomaAlt(strKomaImage);
																										document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																									} else {
																										document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																									}
																								}

																							}
																						} else {
																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);

																							if (strKomaImage == imgSiyouhukaHyouji) {
																								document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																							}

																							document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																							if (strKomaImage == imgSiyouhukaHyouji) {
																								document.write("</a>");
																							}

																						}
																				}
																			} else {
																				if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) <= 8) {
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																				} else {
																					if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																						if (LotKanriArray[i][k] == 0) {
																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);
																							document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																						} else {
																							var lotStartDate;
																							var lotEndDate;
																							lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																							lotStartDate.setHours(0);
																							lotStartDate.setMinutes(0);
																							lotStartDate.setSeconds(0);
																							lotStartDate.setMilliseconds(0);
																							lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																							lotEndDate.setHours(0);
																							lotEndDate.setMinutes(0);
																							lotEndDate.setSeconds(0);
																							lotEndDate.setMilliseconds(0);
																							if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																								strKomaImage = getKomaImageFileName2(i, j, k);
																								strKomaAlt = getKomaAlt(strKomaImage);
																								document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																							} else {
																								document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																							}
																						}
																					} else {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);

																						if (strKomaImage == imgSiyouhukaHyouji) {
																							document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																						}

																						document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																						if (strKomaImage == imgSiyouhukaHyouji) {
																							document.write("</a>");
																						}

																					}
																				}
																			}
																		}
																	}else {
																		document.write("<br>");
																	}
																} else {
																	if (getKomaImageFileName(i, j, k) == imgEmpty) {  
																		strKomaImage = getKomaImageFileName2(i, j, k);
																		strKomaAlt = getKomaAlt(strKomaImage);
																		document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																	} else {
																		
																		if (komaCondArray[i][j][k] == 0) {
																			strKomaImage = getKomaImageFileName2(i, j, k);
																			strKomaAlt = getKomaAlt(strKomaImage);
																			document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																		} else {
																			if (shisetuArray[i][k].substr(40, 1) == 1) {
																				switch (komaCondArray[i][j][k]) {
																					case "Reserve":				
																						document.write("<Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");
																						break;
																					case "Empty2":				
																						document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																						break;
																					default:					
																						if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																							document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																						} else {
																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);

																							if (strKomaImage == imgSiyouhukaHyouji) {
																								document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																							}

																							document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																							if (strKomaImage == imgSiyouhukaHyouji) {
																								document.write("</a>");
																							}

																						}
																				}
																			} else {
																				if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) <= 8) {
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																				} else {
																					if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																						if (LotKanriArray[i][k] == 0) {
																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);
																							document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																						} else {
																							var lotStartDate;
																							var lotEndDate;
																							lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																							lotStartDate.setHours(0);
																							lotStartDate.setMinutes(0);
																							lotStartDate.setSeconds(0);
																							lotStartDate.setMilliseconds(0);
																							lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																							lotEndDate.setHours(0);
																							lotEndDate.setMinutes(0);
																							lotEndDate.setSeconds(0);
																							lotEndDate.setMilliseconds(0);
																							if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																								strKomaImage = getKomaImageFileName2(i, j, k);
																								strKomaAlt = getKomaAlt(strKomaImage);
																								document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																							} else {
																								document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																							}
																						}
																					} else {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);

																						if (strKomaImage == imgSiyouhukaHyouji) {
																							document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																						}

																						document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																						if (strKomaImage == imgSiyouhukaHyouji) {
																							document.write("</a>");
																						}

																					}
																				}
																			}
																		}
																	}
																}
															}
														} else {
															var currentKomaCount;
															currentKomaCount = 0;
															
															for (m =0; m < komaArray[i].length; m++) {
																if (komaArray[i][m] != null) {
																	if (komaArray[i][m][0].substr(8,3) == shisetuArray[i][k].substr(0,3)) {
																		currentKomaCount = parseInt(komaArray[i][m][0].substr(11,2), 10);
																		break;
																	}
																}
															}
															
															if (currentKomaCount > j) {
																
																if (komaCondArray[i][j][k] == 0) {
																	strKomaImage = getKomaImageFileName2(i, j, k);
																	strKomaAlt = getKomaAlt(strKomaImage);
																	document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																} else {
																	if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) <= 8) {
																		strKomaImage = getKomaImageFileName2(i, j, k);
																		strKomaAlt = getKomaAlt(strKomaImage);
																		document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																	} else {
																		if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																			if (LotKanriArray[i][k] == 0) {
																				strKomaImage = getKomaImageFileName2(i, j, k);
																				strKomaAlt = getKomaAlt(strKomaImage);
																				document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																			} else {
																				var lotStartDate;
																				var lotEndDate;
																				lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																				lotStartDate.setHours(0);
																				lotStartDate.setMinutes(0);
																				lotStartDate.setSeconds(0);
																				lotStartDate.setMilliseconds(0);
																				lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																				lotEndDate.setHours(0);
																				lotEndDate.setMinutes(0);
																				lotEndDate.setSeconds(0);
																				lotEndDate.setMilliseconds(0);
																				if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);
																					document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																				} else {
																					document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																				}
																			}

																		} else {
																			strKomaImage = getKomaImageFileName2(i, j, k);
																			strKomaAlt = getKomaAlt(strKomaImage);
																			document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																		}
																	}
																}
															} else {
																document.write("<br>");
															}
														}
													}else{
														var wkDate2;
														var wkDate3;
														var wkDate4;
														wkDate2 = "" + CheckDate.substr(0 ,4) + CheckDate.substr(5 ,2) + CheckDate.substr(8 ,2);
														wkDate3 = "20231011";
														wkDate4 = "202310111452";
														if (komaArray[i][kk][j] != -1) {

																if ((wkYOYAKU_START > wkDate4) || kyukanbi_uketuke_flg == true){

																	document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgEmpty3 + "' name=image" + indexKeyStr + "><br>");
																}else{
																	
																	if (komaCondArray[i][j][k] == 0) {

																		if ((shisetuArray[i][k].substr(32, 4) == "0000") && (shisetuArray[i][k].substr(36, 4) == "0000")) {

																			if (shisetuArray[i][k].substr(40, 1) == 1) {
																				var Result;
																				Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
																				if (Result == "PartEmpty"){
																					
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																					document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																					document.write("</a>");
																				}else{
																					
																					document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																					document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																					document.write("</a>");
																				}
																			}else{
																				strKomaImage = getKomaImageFileName2(i, j, k);
																				strKomaAlt = getKomaAlt(strKomaImage);
																				document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																			}
																		} else {
																			if (shisetuArray[i][k].substr(32, 4) <= "1452" && shisetuArray[i][k].substr(36, 4) >= "1452") {

																				strKomaImage = getKomaImageFileName2(i, j, k);
																				strKomaAlt = getKomaAlt(strKomaImage);
																				document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																			} else {
																				document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																			}
																		}
																	} else {
																		
																		if (shisetuArray[i][k].substr(40, 1) == 1) {
																			switch (komaCondArray[i][j][k]) {
																				case "Reserve":				
																					document.write("<Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");
																					break;
																				case "Empty2":				
																					document.write("<Image class='clsKomaLarge' alt='空き有り（要問い合わせ）' src='" + imgEmpty2 + "' name=image" + indexKeyStr + "><br>");
																					break;
																				default:					
																					if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																						if (LotKanriArray[i][k] == 0) {
																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);
																							document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																						} else {
																							var lotStartDate;
																							var lotEndDate;
																							lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																							lotStartDate.setHours(0);
																							lotStartDate.setMinutes(0);
																							lotStartDate.setSeconds(0);
																							lotStartDate.setMilliseconds(0);
																							lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																							lotEndDate.setHours(0);
																							lotEndDate.setMinutes(0);
																							lotEndDate.setSeconds(0);
																							lotEndDate.setMilliseconds(0);

																							var Result;
																							Result = GetMenYoyakuAki(i, j, k, shisetuArray[i][k].substr(0, 3));
																							if (Result == "PartEmpty"){

																								if (thisDate >= lotStartDate && thisDate <= lotEndDate) {

																								strKomaImage = getKomaImageFileName2(i, j, k);
																								strKomaAlt = getKomaAlt(strKomaImage);
																								document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																								} else {
																									document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																								}

																							} else if (Result == "AllReserve") {

																								document.write("<Image class='clsKomaLarge' alt='予約不可' src='" + imgReserve + "' name=image" + indexKeyStr + "><br>");

																							}else{
																								if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																									strKomaImage = getKomaImageFileName2(i, j, k);
																									strKomaAlt = getKomaAlt(strKomaImage);
																									document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + "><Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																								} else {
																									document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																								}
																							}

																						}
																					} else {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);

																						if (strKomaImage == imgSiyouhukaHyouji) {
																							document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																						}

																						document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																						if (strKomaImage == imgSiyouhukaHyouji) {
																							document.write("</a>");
																						}

																					}
																			}
																		} else {
																			if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) <= 8) {
																				strKomaImage = getKomaImageFileName2(i, j, k);
																				strKomaAlt = getKomaAlt(strKomaImage);
																				document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "></a><br>");
																			} else {
																				if (parseInt(komaCondArray[i][j][k].substr(13, 2), 10) == 21) {
																					if (LotKanriArray[i][k] == 0) {
																						strKomaImage = getKomaImageFileName2(i, j, k);
																						strKomaAlt = getKomaAlt(strKomaImage);
																						document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																					} else {
																						var lotStartDate;
																						var lotEndDate;
																						lotStartDate = new Date(LotKanriArray[i][k].substr(11,4) + "/" + LotKanriArray[i][k].substr(15,2) + "/" + LotKanriArray[i][k].substr(17,2));
																						lotStartDate.setHours(0);
																						lotStartDate.setMinutes(0);
																						lotStartDate.setSeconds(0);
																						lotStartDate.setMilliseconds(0);
																						lotEndDate = new Date(LotKanriArray[i][k].substr(19,4) + "/" + LotKanriArray[i][k].substr(23,2) + "/" + LotKanriArray[i][k].substr(25,2));
																						lotEndDate.setHours(0);
																						lotEndDate.setMinutes(0);
																						lotEndDate.setSeconds(0);
																						lotEndDate.setMilliseconds(0);
																						if (thisDate >= lotStartDate && thisDate <= lotEndDate) {
																							strKomaImage = getKomaImageFileName2(i, j, k);
																							strKomaAlt = getKomaAlt(strKomaImage);
																							document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");
																						} else {
																							document.write("<Image class='clsKomaLarge' alt='予約受付期間外' src='" + imgLot2 + "' name=image" + indexKeyStr + "><br>");
																						}
																					}
																				} else {
																					strKomaImage = getKomaImageFileName2(i, j, k);
																					strKomaAlt = getKomaAlt(strKomaImage);

																					if (strKomaImage == imgSiyouhukaHyouji) {
																						document.write("<a href=javascript:komaClicked(" + i + "," + j + "," + k + ") name=ahref" + indexKeyStr + ">");
																					}

																					document.write("<Image class='clsKomaLarge' alt='" + strKomaAlt + "' src='" + strKomaImage + "' name=image" + indexKeyStr + "><br>");

																					if (strKomaImage == imgSiyouhukaHyouji) {
																						document.write("</a>");
																					}

																				}
																			}
																		}
																	}
																}

														}
													}
												}
											}
										} else {
											document.write("<br>");
										}
									} else {
									}
								} else {
									breakout = false;
									for (m = 0; m < shisetuArray.length; m++) {
										if (shisetuArray[m][k] != 0) {
											if (shisetuArray[m][k].substr(10, 1) == 1) {
												breakout = true;
												break;
											}
										}
									}
									if (breakout == true) {
										breakout = false;
										document.write("<br>");
									}
								}
								

								document.write ("</td>");

								
								if (j < komasu - 1){

									
									komastr = komaArray[i][kk][j + 1];
									if (j == 0){
										komastr = komaArray[i][kk][j + 1];
									}else{
										komastr = komaArray[i][kk][j + 1];
									}
									komainfoArray = komastr.split("_");
									next_s_time = komainfoArray[0].substr(0, 4);
									next_e_time = komainfoArray[0].substr(4, 4);

									if (e_time < next_s_time) {

										
										time1 = e_time;
										time2 = next_s_time;

										time_pos1 = -1;
										time_pos2 = -1;
										for (time_idx = 0; time_idx < time_cnt; time_idx++){
											if (time1 == timeArray[time_idx]){
												time_pos1 = time_idx;
											}
											if (time2 == timeArray[time_idx]){
												time_pos2 = time_idx;
											}
										}
										colspan = time_pos2 - time_pos1;
										document.write ("<td class='clsKomaBlank' headers='Shisetu_" + k + "' colspan='" + colspan + "' nowrap>");
										document.write ("<br>");
										document.write ("</td>");
									}
								}
							}

							
							wktime_hh = "00" + (end_time);
							wktime_hh = wktime_hh.substr(wktime_hh.length - 2, 2);
							wktime = "" + wktime_hh + "00";

							if (e_time < wktime){
								
								time1 = e_time;
								for (time_idx = 0; time_idx < time_cnt; time_idx++) {
									if (time1 == timeArray[time_idx]){
										time_pos1 = time_idx;
										break;
									}
								}
								time_pos2 = time_cnt - 1;
								colspan = time_pos2 - time_pos1;
								if (colspan > 0 ){
									document.write ("<td class='clsKomaBlank' headers='Shisetu_" + k + "' colspan='" + colspan + "' nowrap>");
									document.write ("<br>");
									document.write ("</td>");
								}
							}
						}else{
							document.write ("<td class='clsKomaBlank' headers='Shisetu_" + k + "' colspan='" + time_cnt + "' nowrap>");
							document.write ("<br>");
							document.write ("</td>");
						}
					}else{
						document.write ("<td class='clsKomaBlank' headers='Shisetu_" + k + "' colspan='" + time_cnt + "' nowrap>");
						document.write ("<br>");
						document.write ("</td>");
					}
					document.write("</tr>");

					display_cnt = display_cnt + 1
				}		
			}
		}
	}
	document.write("</table>");


}

function set_cal(day, sday, eday){
	var frmMe = window.document.form1;

	frmMe.action = "i-1-21.asp";
	frmMe.txt_date.value = day;
	var mode = 0;
	mode = radioSelectedIndex;
	if (mode == 6) {
		mode = 8;
	} else {
		mode++;
	}
	frmMe.cmd.value = "";
	frmMe.riyou_cnt.value = riyouCnt;

	frmMe.txt_yoyaku.value = yoyaku;
	frmMe.method = "post";
	Document_Done = false;
	frmMe.submit();
}

function CheckUketukeKikan(CheckDate, YOYAKU_TIMEIN_KBN, YOYAKU_START, YOYAKU_TIMEOUT_KBN, YOYAKU_END, YOYAKU_YOKUNEN, YOYAKU_KBN, YOYAKU_TIMEIN_TIME, YOYAKU_TIMEOUT_TIME, YOYAKU_TIMEIN_MODE, YOYAKU_TIMEOUT_MODE,YOYAKU_TIMEIN_DAY,YOYAKU_TIMEOUT_DAY){


	var wToday;
	var wStartDate;
	var wEndDate;
	var wCheckDate;
	var wyyyy;
	var wmm;
	var wdd;
	var KikanCheck;
	var YokunenCheck;
	var wTIME;


	var savYOYAKU_START = YOYAKU_START;
	var savYOYAKU_END = YOYAKU_END;

	if ((YOYAKU_KBN != null) && (YOYAKU_KBN != 0)){

		if ((parseInt(YOYAKU_KBN.substr(13, 2), 10) == 11) || (parseInt(YOYAKU_KBN.substr(13, 2), 10) == 12)){
			return true;
		}
	}
	
	if ((YOYAKU_KBN != null) && (YOYAKU_KBN != 0)){
		if ((parseInt(YOYAKU_KBN.substr(13, 2), 10) == 21)) {
			return true;
		}
	}
	wToday = new Date("2023/10/11");
	wyyyy = wToday.getFullYear();
	wmm = wToday.getMonth() + 1;
	wdd = wToday.getDate();
	wTIME = "1452";
	if (wmm < 10){wmm = "0" + wmm};
	if (wdd < 10){wdd = "0" + wdd};
	wToday = "" + wyyyy + wmm  + wdd + wTIME;
	wCheckDate = new Date(CheckDate);
	wyyyy = wCheckDate.getFullYear();
	wmm = wCheckDate.getMonth() + 1;
	wdd = wCheckDate.getDate();
	if (wmm < 10){wmm = "0" + wmm};
	if (wdd < 10){wdd = "0" + wdd};
	wCheckDate = "" + wyyyy + wmm + wdd;

	KikanCheck = false;
	YokunenCheck = false;

	
	if ((YOYAKU_START == "**") && (YOYAKU_END == "**")){
		KikanCheck = true;
	}else{
		YOYAKU_START = parseInt("-" + YOYAKU_START, 10);
		YOYAKU_END = parseInt("-" + YOYAKU_END, 10);

		if (parseInt(YOYAKU_TIMEIN_MODE, 10) == 0){
			
			wStartDate = DateAdd(YOYAKU_TIMEIN_KBN, YOYAKU_START, CheckDate);

			wStartDate = new Date(wStartDate)
			wyyyy = wStartDate.getFullYear();
			wmm = wStartDate.getMonth() + 1;
			wdd = wStartDate.getDate();
			if (wmm < 10){wmm = "0" + wmm};
			if (wdd < 10){wdd = "0" + wdd};

		}else{

			
			var wDate;
			var wCheckDate2;
			var i;
			switch (YOYAKU_TIMEIN_KBN) {
				case "Y":
					
					wDate = new Date(CheckDate);
					wyyyy = wDate.getFullYear();
					wCheckDate2 = "" + wyyyy + "/01/01";
					break;

				case "M":
					
					wDate = new Date(CheckDate);
					wyyyy = wDate.getFullYear();
					wmm = wDate.getMonth() + 1;
					wCheckDate2 = "" + wyyyy + "/" + wmm + "/01";
					break;

				case "W":
					
					for (i = 0; i < 7; i++){
						wDate = DateAdd("D", -1 * i, CheckDate);
						wDate = new Date(wDate);
						if (wDate.getDay() == 1){
							break;
						}
					}
					wYYYY = wDate.getFullYear();
					wMM = wDate.getMonth() + 1;
					wDD = wDate.getDate();
					wCheckDate2 = "" + wYYYY + "/" + wMM + "/" + wDD;
					break;
				case "D":
					wCheckDate2 = CheckDate;
					break;
			}


			if (YOYAKU_TIMEIN_DAY != "00") {
				switch (YOYAKU_TIMEIN_KBN) {
					case "Y":
					case "M":
						
						wDate = new Date(wCheckDate2);
						wyyyy = wDate.getFullYear();
						wmm = wDate.getMonth() + 1;
						if (wmm < 10){wmm = "0" + wmm};	

						wCheckDate2 = "" + wyyyy + "/" + wmm + "/" + YOYAKU_TIMEIN_DAY;
						if (ckDate(wCheckDate2) == false){
							
							wCheckDate2 = "" + wyyyy + "/" + wmm + "/01";	
							wCheckDate2 = new Date(wCheckDate2);	
							
							
							wDate = DateAdd("M", 1, wCheckDate2);
							wDate = new Date(wDate);
							wyyyy = wDate.getFullYear();
							wmm = wDate.getMonth() + 1;
							wdd = wDate.getDate();
							if (wmm < 10){wmm = "0" + wmm};
							if (wdd < 10){wdd = "0" + wdd};
							
							wCheckDate2 = "" + wyyyy +  "/" + wmm +  "/" + wdd ;
							wCheckDate2 = new Date(wCheckDate2);

							
							wDate = DateAdd("D", -1, wCheckDate2);
							wDate = new Date(wDate);
							wyyyy = wDate.getFullYear();
							wmm = wDate.getMonth() + 1;
							wdd = wDate.getDate();
							
							wCheckDate2 = "" + wyyyy + "/" + wmm + "/" + wdd;
						}
						break;
				}
			}


			wStartDate = DateAdd(YOYAKU_TIMEIN_KBN, YOYAKU_START, wCheckDate2);

			wStartDate = new Date(wStartDate)
			wyyyy = wStartDate.getFullYear();
			wmm = wStartDate.getMonth() + 1;
			wdd = wStartDate.getDate();
			if (wmm < 10){wmm = "0" + wmm};
			if (wdd < 10){wdd = "0" + wdd};
		}
		wStartDate = "" + wyyyy + wmm + wdd + YOYAKU_TIMEIN_TIME;
		wkYOYAKU_START = "" + wStartDate;
		if (parseInt(YOYAKU_TIMEOUT_MODE, 10) == 0){

			
			wEndDate = DateAdd(YOYAKU_TIMEOUT_KBN, YOYAKU_END, CheckDate);

			wEndDate = new Date(wEndDate);
			wyyyy = wEndDate.getFullYear();
			wmm = wEndDate.getMonth() + 1;
			wdd = wEndDate.getDate();
			if (wmm < 10){wmm = "0" + wmm};
			if (wdd < 10){wdd = "0" + wdd};

		}else{

			

			var wDate;
			var wCheckDate2;
			var i;
			switch (YOYAKU_TIMEOUT_KBN) {
				case "Y":
					
					wDate = new Date(CheckDate);
					wyyyy = wDate.getFullYear();
					wCheckDate2 = "" + wyyyy + "/01/01";
					break;

				case "M":
					
					wDate = new Date(CheckDate);
					wyyyy = wDate.getFullYear();
					wmm = wDate.getMonth() + 1;
					wCheckDate2 = "" + wyyyy + "/" + wmm + "/01";
					break;

				case "W":
					
					for (i = 0; i < 7; i++){
						wDate = DateAdd("D", -1 * i, CheckDate);
						wDate = new Date(wDate);
						if (wDate.getDay() == 1){
							break;
						}
					}
					wYYYY = wDate.getFullYear();
					wMM = wDate.getMonth() + 1;
					wDD = wDate.getDate();
					wCheckDate2 = "" + wYYYY + "/" + wMM + "/" + wDD;
					break;
				case "D":
					wCheckDate2 = CheckDate;
					break;
			}

			wEndDate = DateAdd(YOYAKU_TIMEOUT_KBN, YOYAKU_END, wCheckDate2);

			
			if ((YOYAKU_TIMEOUT_KBN == "Y") || (YOYAKU_TIMEOUT_KBN == "M") || (YOYAKU_TIMEOUT_KBN == "W")){
				wEndDate = DateAdd(YOYAKU_TIMEOUT_KBN, 1, wEndDate)
				wEndDate = DateAdd("D", -1, wEndDate)
			}


			if (YOYAKU_TIMEOUT_DAY != "00") {
				
				switch (YOYAKU_TIMEOUT_KBN) {
					case "Y":
					case "M":
						
						wDate = new Date(wEndDate);
						wyyyy = wDate.getFullYear();
						wmm = wDate.getMonth() + 1;
						if (wmm < 10){wmm = "0" + wmm};	

						wCheckDate2 = "" + wyyyy + "/" + wmm + "/" + YOYAKU_TIMEOUT_DAY;
						if (ckDate(wCheckDate2) == false){
							
							wCheckDate2 = "" + wyyyy + "/" + wmm + "/01";	
							wCheckDate2 = new Date(wCheckDate2);	
							
							
							wDate = DateAdd("M", 1, wCheckDate2);
							wDate = new Date(wDate);
							wyyyy = wDate.getFullYear();
							wmm = wDate.getMonth() + 1;
							wdd = wDate.getDate();
							if (wmm < 10){wmm = "0" + wmm};
							if (wdd < 10){wdd = "0" + wdd};
							
							wCheckDate2 = "" + wyyyy +  "/" + wmm +  "/" + wdd ;
							wCheckDate2 = new Date(wCheckDate2);

							
							wDate = DateAdd("D", -1, wCheckDate2);
							wDate = new Date(wDate);
							wyyyy = wDate.getFullYear();
							wmm = wDate.getMonth() + 1;
							wdd = wDate.getDate();
							
							wEndDate = "" + wyyyy + "/" + wmm + "/" + wdd;

						}else{
							wEndDate = wCheckDate2;
						}
						break;
				}
			}


			wEndDate = new Date(wEndDate);
			wyyyy = wEndDate.getFullYear();
			wmm = wEndDate.getMonth() + 1;
			wdd = wEndDate.getDate();
			if (wmm < 10){wmm = "0" + wmm};
			if (wdd < 10){wdd = "0" + wdd};
		}

		wkYOYAKU_END = "" + wyyyy + wmm + wdd;



			wEndDate = "" + wyyyy + wmm + wdd + YOYAKU_TIMEOUT_TIME;


		if (savYOYAKU_START != "**"){

			if (wToday >= wStartDate){
				KikanCheck = true;
			}else{
				KikanCheck = false;
				return false;
			}
		}


		if (savYOYAKU_END != "**"){

			if (wToday <= wEndDate){
				KikanCheck = true;
			}else{
				KikanCheck = false;
				return false;
			}
		}
	}

	
	if (parseInt(YOYAKU_YOKUNEN, 10) == 0){
		YokunenCheck = true;
	}else{
		wToday = new Date("2023/10/11");
		if ((parseInt(wToday.getMonth() + 1, 10) >= 1) && (parseInt(wToday.getMonth() + 1, 10) <= 3)){
			wStartDate = parseInt(wToday.getFullYear() - 1, 10) + "0401";
			wEndDate = "" + wToday.getFullYear() + "0331";
		}else{
			wStartDate = wToday.getFullYear() + "0401";
			wEndDate = "" + parseInt(wToday.getFullYear() + 1, 10) + "0331";
		}
		if ((wCheckDate >= wStartDate) && (wCheckDate <= wEndDate)){
			YokunenCheck = true;
		}else{
			YokunenCheck = false;
			return false;
		}
	}
	if ((KikanCheck == true) && (YokunenCheck == true)){
		return true;
	}else{
		return false;
	}

}
function DateAdd(inUnit, inValue, inDate){

	var wDate;
	var wYYYY;
	var wMM;
	var wDD;
	var OneDay;
	var OneWeek;
	var wResult;

	var wYYYYMM;
	var i;
	var wM;
	var wY;


	wDate = new Date(inDate);

	OneDay = 24 * 60 * 60 * 1000;
	OneWeek = OneDay * 7;

	switch (inUnit) {
		case "Y":

			wYYYYMM = ""+(wDate.getFullYear()+inValue)+(wDate.getMonth()+1);

			wDate.setFullYear(wDate.getFullYear() + inValue);
			wYYYY = wDate.getFullYear();
			wMM = wDate.getMonth() + 1;
			wDD = wDate.getDate();

			i=0
			while (wYYYYMM != ""+wYYYY+wMM) {
				wDate.setTime(wDate.getTime() + (OneDay * (-1)));
				wYYYY = wDate.getFullYear();
				wMM = wDate.getMonth() + 1;
				wDD = wDate.getDate();
				if ((wYYYYMM == ""+wYYYY+wMM) || (i == 4))
				break
				i++
			}

			wResult = "" + wYYYY + "/" + wMM + "/" + wDD;
			return wResult;
			break;

		case "M":

			wM = inValue%12;
			wY = (inValue - wM) / 12;
			wM=(wDate.getMonth())+wM+1;
			if (wM>=1 && wM<=12){
				wY=wDate.getFullYear()+wY
			}
			if (wM<1){
				wY=wDate.getFullYear()+wY-1
				wM=wM+12;
			}
			if (wM>12){
				wY=wDate.getFullYear()+wY+1
				wM=wM-12;
			}
			wYYYYMM = ""+wY+wM;

			wDate.setMonth(wDate.getMonth() + inValue);
			wYYYY = wDate.getFullYear();
			wMM = wDate.getMonth() + 1;
			wDD = wDate.getDate();

			i=0
			while (wYYYYMM != ""+wYYYY+wMM) {
				wDate.setTime(wDate.getTime() + (OneDay * (-1)));
				wYYYY = wDate.getFullYear();
				wMM = wDate.getMonth() + 1;
				wDD = wDate.getDate();
				if ((wYYYYMM == ""+wYYYY+wMM) || (i == 4))
				break
				i++
			}

			wResult = "" + wYYYY + "/" + wMM + "/" + wDD;
			return wResult;
			break;

		case "W":
			wDate.setTime(wDate.getTime() + (OneWeek * inValue));
			wYYYY = wDate.getFullYear();
			wMM = wDate.getMonth() + 1;
			wDD = wDate.getDate();
			wResult = "" + wYYYY + "/" + wMM + "/" + wDD;
			return wResult;
			break;

		case "D":
			wDate.setTime(wDate.getTime() + (OneDay * inValue));
			wYYYY = wDate.getFullYear();
			wMM = wDate.getMonth() + 1;
			wDD = wDate.getDate();
			wResult = "" + wYYYY + "/" + wMM + "/" + wDD;
			return wResult;
			break;
	}

}


function ckDate(datestr) { 

    // 正規表現による書式チェック 
    if(!datestr.match(/^\d{4}\/\d{2}\/\d{2}$/)){ 
        return false; 
    } 

    var vYear = datestr.substr(0, 4) - 0; 
    var vMonth = datestr.substr(5, 2) - 1; // Javascriptは、0-11で表現 
    var vDay = datestr.substr(8, 2) - 0; 

    // 月,日の妥当性チェック 
    if(vMonth >= 0 && vMonth <= 11 && vDay >= 1 && vDay <= 31){ 
        var vDt = new Date(vYear, vMonth, vDay); 
        if(isNaN(vDt)){ 
            return false; 
        }else if(vDt.getFullYear() == vYear && vDt.getMonth() == vMonth && vDt.getDate() == vDay){ 
            return true; 
        }else{ 
            return false; 
        } 
    }else{ 
        return false; 
    } 
} 


function GetMenYoyakuAki(ixD, ixK, ixS, Scd) {

	var MenYoyakuArray;					
	var bitMenArray;					

	var tempArray0;		
	var tempArray1;		
	var tempArray2;		
	var ix0;
	var ix1;
	var ix2;
	var rowData;
	var colData;
	var rowCount;
	var colCount;

	var mRowCount;
	var mColCount;
	var mRowPos;
	var mColPos;
	var mRowStart;
	var mRowEnd;
	var mColStart;
	var mColEnd;
	var ixRow;
	var ixCol;
	var flgYoyakuChk;

	
	MenYoyakuArray = new Array();
	tempArray0 = new Array();
	tempArray1 = new Array();
	ix2 = 0
	rowData = "";
	colData = "";
	tempArray0 = shisetuMenInfo.split(";");
	if (tempArray0[tempArray0.length - 1] == "") {
		tempArray0.length = tempArray0.length - 1;
	}
	for (ix0 = 0; ix0 < shisetuMenDateArray.length; ix0++) {
		if (shisetuMenDateArray[ix0].substr(0, 4) + "/" + shisetuMenDateArray[ix0].substr(4, 2) + "/" + shisetuMenDateArray[ix0].substr(6, 2) == dateArray[ixD]) {
			tempArray1 = tempArray0[ix0].split("|");
			if (tempArray1[tempArray1.length - 1] == "") {
				tempArray1.length = tempArray1.length - 1;
			}
		}
	}
	for (ix1 = 0; ix1 < tempArray1.length; ix1++) {
		if (tempArray1[ix1].substr(3, 3) == Scd) {		
			MenYoyakuArray[ix2] = tempArray1[ix1].substr(0, 3)+","+parseInt(tempArray1[ix1].substr(10, 2), 10)+","+parseInt(tempArray1[ix1].substr(12, 2), 10)+","+parseInt(tempArray1[ix1].substr(14, 2), 10)+","+parseInt(tempArray1[ix1].substr(16, 2), 10)+",0,0";
			if (ix2 == 0) {
				rowData = rowData+parseInt(tempArray1[ix1].substr(10, 2), 10);
				colData = colData+parseInt(tempArray1[ix1].substr(12, 2), 10);
			} else {
				rowData = rowData+","+parseInt(tempArray1[ix1].substr(10, 2), 10);
				colData = colData+","+parseInt(tempArray1[ix1].substr(12, 2), 10);
			}
			ix2 += 1;
		}
	}

	if (MenYoyakuArray.length == 0) {
		return "AllEmpty";
	}

	
	rowCount = GetLcm(rowData.split(","));
	colCount = GetLcm(colData.split(","));
	bitMenArray = new Array();
	for (ix0 = 0; ix0 < rowCount; ix0++) {
		for (ix1 = 0; ix1 < colCount; ix1++) {
			bitMenArray[ix0+"_"+ix1] = 0;
		}
	}

	
	tempArray1 = new Array();
	tempArray1 = komaCondInfo.split(";");
	if (tempArray1[tempArray1.length - 1] == "") {
		tempArray1.length = tempArray1.length - 1;
	}



	var yoyakustr1;
	var yoyakudate1;
	var koma1;
	var start_pos;
	var end_pos;
	var divied_pos;

	
	if (tempArray1.length != 0){
		for (ix1 = 0; ix1 < MenYoyakuArray.length; ix1++) {
			yoyakudate1 = dateArray[ixD].substr(0, 4) + dateArray[ixD].substr(5, 2) + dateArray[ixD].substr(8, 2);
			koma1 = "00" + (parseInt(ixK, 10) + 1);
			koma1 = koma1.substr(koma1.length-2,2)
			yoyakustr1 = "" + yoyakudate1 + koma1 + MenYoyakuArray[ix1].substr(0, 3);

			start_pos = 0;
			end_pos = tempArray1.length - 1;

			while (end_pos > start_pos) {
				divied_pos = Math.floor((start_pos + end_pos) / 2);
				if (yoyakustr1 == tempArray1[divied_pos].substr(0, 13)){
					start_pos = divied_pos;
					end_pos = divied_pos;
					break;
				}else{
					if (yoyakustr1 < tempArray1[divied_pos].substr(0, 13)){
						end_pos = divied_pos - 1;
					}else{
						start_pos = divied_pos + 1;
					}
				}
			}
			for (ix0 = start_pos; ix0 <= end_pos; ix0++) {
				
				if ((tempArray1[ix0].substr(0, 4) + "/" + tempArray1[ix0].substr(4, 2) + "/" + tempArray1[ix0].substr(6, 2) == dateArray[ixD]) && (parseInt(tempArray1[ix0].substr(8, 2), 10) - 1 == ixK)) {
					if (tempArray1[ix0].substr(10, 3) == MenYoyakuArray[ix1].substr(0, 3)) {		
						tempArray0 = new Array();
						tempArray0 = MenYoyakuArray[ix1].split(",");
						
					  if (tempArray1[ix0].substr(13, 2) == "21"){
						MenYoyakuArray[ix1] = tempArray0[0]+","+tempArray0[1]+","+tempArray0[2]+","+tempArray0[3]+","+tempArray0[4]+",2,0";
					  } else {
						MenYoyakuArray[ix1] = tempArray0[0]+","+tempArray0[1]+","+tempArray0[2]+","+tempArray0[3]+","+tempArray0[4]+",1,1";

						mRowCount = tempArray0[1];
						mColCount = tempArray0[2];
						mRowPos = tempArray0[3];
						mColPos = tempArray0[4];
						
						if (mRowPos == 1) {
							mRowStart = 0;
						} else {
							mRowStart = rowCount / mRowCount * (mRowPos - 1);
						}
						
						mRowEnd = rowCount / mRowCount * mRowPos - 1;
						
						if (mColPos == 1) {
							mColStart = 0;
						} else {
							mColStart = colCount / mColCount * (mColPos - 1);
						}
						
						mColEnd = colCount / mColCount * mColPos - 1;

						
						for (ixRow = mRowStart; ixRow <= mRowEnd; ixRow++) {
							for (ixCol = mColStart; ixCol <= mColEnd; ixCol++) {
								bitMenArray[ixRow+"_"+ixCol] = 1;
							}
						}

					  }

					}
				}
			}
		}
	}

	for (ix0 = 0; ix0 < MenYoyakuArray.length; ix0++) {
		tempArray0 = new Array();
		tempArray0 = MenYoyakuArray[ix0].split(",");
		
		if ((tempArray0[5] == 0) || (tempArray0[5] == 2)) {

			mRowCount = tempArray0[1];
			mColCount = tempArray0[2];
			mRowPos = tempArray0[3];
			mColPos = tempArray0[4];
			
			if (mRowPos == 1) {
				mRowStart = 0;
			} else {
				mRowStart = rowCount / mRowCount * (mRowPos - 1);
			}
			
			mRowEnd = rowCount / mRowCount * mRowPos - 1;
			
			if (mColPos == 1) {
				mColStart = 0;
			} else {
				mColStart = colCount / mColCount * (mColPos - 1);
			}
			
			mColEnd = colCount / mColCount * mColPos - 1;

			
			flgYoyakuChk = 0;
			for (ixRow = mRowStart; ixRow <= mRowEnd; ixRow++) {
				for (ixCol = mColStart; ixCol <= mColEnd; ixCol++) {
					if (bitMenArray[ixRow+"_"+ixCol] == "1") {
						flgYoyakuChk = 1;
					}
				}
			}

			
			if (flgYoyakuChk == 1) {
				MenYoyakuArray[ix0] = tempArray0[0]+","+tempArray0[1]+","+tempArray0[2]+","+tempArray0[3]+","+tempArray0[4]+","+tempArray0[5]+",1";
			}
		}
	}

	var EmptyCount = 0;

	
	flgYoyakuChk = 1;
	for (ix0 = 0; ix0 < MenYoyakuArray.length; ix0++) {
		tempArray0 = new Array();
		tempArray0 = MenYoyakuArray[ix0].split(",");
		
		if (tempArray0[6] == 0) {
			flgYoyakuChk = 0;

			EmptyCount = EmptyCount + 1;
		}
	}
	if (flgYoyakuChk == 1) {
		
		return "AllReserve";
	}

	if (MenYoyakuArray.length == EmptyCount){
		return "AllEmpty";
	}else{
		return "PartEmpty";
	}
}


function lst_kaikan_change(frmMe){

	if(Document_Done == false){
		return;
	}

	Document_Done = false;
	frmMe.action = "i-1-21.asp";
	frmMe.cmd.value = "k_change";
	frmMe.txt_date_cal.value = "";

	frmMe.txt_yoyaku.value = "";

	frmMe.txtSelKomaPtnNo.value = "";

	frmMe.method = "post";
	frmMe.submit();
}

function DefChgAlert() {

	var wkExecSubmit = false;



	if (wkExecSubmit == true) {
		userguide_clicked('1');
	}

}


</script></head>

<body bgcolor="#FFCC99" text="000000" link="000000" vlink="000000" onload="Form_Focus()" onunload="windowClosing()" onmousedown="cancelmouseclick();" marginwidth="0" marginheight="0">
<form name="form1" action="i-1-21.asp" method="post">

<div id="header">
<div id="innerTop">
<p id="municipalityName">埼玉県県営公園      <input type="image" src="../image/dmy.gif" alt="誤操作防止用" name="btn_Dmy" onclick="cmd_btn_Dmy_click(this.form);return false;" width="1" height="1"></p>
<ul id="residentMenu">
	<li><input type="image" src="../image/btn_header_legal_ot.jpg" alt="利用規約" onclick="btn_riyoukiyaku_click();return false;" width="63" height="23"></li>
	<li><input type="image" src="../image/btn_header_howto_ot.jpg" alt="利用方法" onclick="btn_riyouhouhou_click();return false;" width="63" height="23"></li>
	<li><input type="image" src="../image/btn_header_prepare_ot.jpg" alt="事前準備" onclick="btn_jizenjunbi_click();return false;" width="63" height="23"></li>
	<li><input type="image" src="../image/btn_header_faq_ot.jpg" alt="よくある質問" onclick="btn_qa_click();return false;" width="79" height="23"></li>
	<li><input type="image" src="../image/btn_header_help_ot.jpg" alt="ヘルプ" onclick="btn_help_click(this.form);return false;" width="52" height="23"></li>
	<li><input type="image" src="../image/btn_resident_change-style_ot.jpg" alt="文字色変更" onclick="btn_style_click();return false;" width="63" height="23"></li>
</ul>
</div>
<div id="innerMiddle">
<h1 class="h_img"><img src="../image/logo_header-resident.gif" alt="施設予約サービス" width="264" height="46"></h1>
</div>
<div id="innerBottom">
<p id="btnHeaderSp" style="float:left;margin: 2px 0 0 15px;padding: 0 0 0 15px;"><input type="image" src="../image/btn_header_sp_ot.jpg" alt="スマートフォン用画面はこちら" onclick="parent.location ='https://www.pa-reserve.jp/eap-rm/rsv_rm/i/im-0.asp?klcd=119999'" width="211" height="21"></p>
<p id="btnGoTop"><input type="image" src="../image/btn_resident_go-menu_ot.jpg" alt="メニューへ戻る" onclick="move_menu();return false;" width="127" height="18"></p>
</div>
</div>
<div class="sms">
<table class="clsYoyakuHeader_Guide" width="100%" align="center" cellspacing="2">
	<tbody><tr class="clsYoyakuHeader">
		<td class="clsNone">
			<table class="clsUserGuide" width="100%" align="center">
				<tbody><tr class="clsNone">
					<td class="clsUGInActive" width="" border="1" align="center">
						<a href="javascript:userguide_clicked('0')"></a>
					</td>
					<td class="clsUGInActive" width="" border="1" align="center">
						<a href="javascript:userguide_clicked('1')">検索する施設の<br>所在地を選択します</a>
					</td>
					<td class="clsUGInActive" width="" border="0" align="left">
						⇒
					</td>
					<td class="clsUGInActive" width="" border="1" align="center">
						<a href="javascript:userguide_clicked('2')">施設を選択します</a>
					</td>
					<td class="clsUGInActive" width="" border="0" align="left">
						⇒
					</td>
					<td class="clsUGActive" width="" border="1" align="center">
						施設、時間帯を<br>選択します
					</td>
					<td class="clsUGActive" width="" border="0" align="left">
						⇒
					</td>
					<td class="clsUGInActive" width="" border="1" align="center">
						ログイン後、本人情報を<br>確認します
					</td>
					<td class="clsUGInActive" width="" border="0" align="left">
						⇒
					</td>
					<td class="clsUGInActive" width="" border="1" align="center">
						利用目的、<br>付帯設備を設定します
					</td>
					<td class="clsUGInActive" width="" border="0" align="left">
						⇒
					</td>
					<td class="clsUGInActive" width="" border="1" align="center">
						料金の減免申請をします
					</td>
					<td class="clsUGInActive" width="" border="0" align="left">
						⇒
					</td>
					<td class="clsUGInActive" width="" border="1" align="center">
						支払方法を設定します
					</td>
					<td class="clsUGInActive" width="" border="0" align="left">
						⇒
					</td>
					<td class="clsUGInActive" width="" border="1" align="center">
						予約確認後、<br>予約登録します
					</td>
				</tr>
			</tbody></table>
		</td>
	</tr>
</tbody></table>
<br>
<div class="left_disp">
<center>
<p class="clsHCenter"></p><div class="HeaderSmallBold1">表示を変えることができます。</div>
<table class="clsNone" width="100%">
	<tbody><tr class="clsNone">
		<th class="clsCalCaption" scope="row" id="hdDisp" width="25%"><a href="javascript:onclick=wordhelp_open('No07')">表示モード</a></th>
		<td class="clsYoyakuDetailSmall2" style="white-space:normal;" headers="hdDisp" width="40%">
			<input class="clsRadio" type="radio" name="disp_mode" id="radio1" value="0" onclick="disp_mode_click(this.form)">
			<label for="radio1" class="clsNone">
			2週間表示
			</label>
		</td>
		<td class="clsYoyakuDetailSmall2" style="white-space:normal;" headers="hdDisp" width="35%">
			<input class="clsRadio" type="radio" name="disp_mode" id="radio2" value="1" checked="" onclick="disp_mode_click(this.form)">
			<label for="radio2" class="clsNone">
			1日表示
			</label>
		</td>
	</tr>
</tbody></table>
<div class="clsHCenter">
	<p class="clsNone"></p><div class="HeaderSmallBold1">利用日を変えることができます。<br>カレンダーの日付をクリックしてください。</div><p></p>
</div>
<table>
	<tbody><tr>
		<td class="clsCalYear">
			<a href="javascript:set_cal_cal('20221011','00000000','99999999')">
				2022年
			</a>
		</td>
		<td class="clsCalYear">
			2023年
		</td>
		<td class="clsCalYear">
			<a href="javascript:set_cal_cal('20241011','00000000','99999999')">
				2024年
			</a>
		</td>
	</tr>
</tbody></table>
<table width="70%">
	<tbody><tr>
<td class="clsCalMonth"><a href="javascript:set_cal_cal('20230101','00000000','99999999')">&nbsp;1月</a></td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20230201','00000000','99999999')">&nbsp;2月</a></td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20230301','00000000','99999999')">&nbsp;3月</a></td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20230401','00000000','99999999')">&nbsp;4月</a></td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20230501','00000000','99999999')">&nbsp;5月</a></td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20230601','00000000','99999999')">&nbsp;6月</a></td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20230701','00000000','99999999')">&nbsp;7月</a></td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20230801','00000000','99999999')">&nbsp;8月</a></td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20230901','00000000','99999999')">&nbsp;9月</a></td><td class="clsCalMonth">10月</td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20231101','00000000','99999999')">11月</a></td><td class="clsCalMonth"><a href="javascript:set_cal_cal('20231201','00000000','99999999')">12月</a></td>	</tr>
</tbody></table>
<table class="clsCal">
	<tbody><tr class="clsNone">
		<th class="clsCalTitle1">
			<a href="javascript:set_cal_cal(&quot;20230901&quot;,&quot;00000000&quot;,&quot;99999999&quot;)"><img class="clsNone" alt="前月表示" src="../image/arrowleft.gif" border="0" width="30" height="30"></a>
		</th>
		<th class="clsCalTitleYM" scope="col" id="hdYM" colspan="5">
			2023年10月
		</th>
		<th class="clsCalTitle1">
			<a href="javascript:set_cal_cal(&quot;20231101&quot;,&quot;00000000&quot;,&quot;99999999&quot;)"><img class="clsNone" alt="翌月表示" src="../image/arrowright.gif" border="0" width="30" height="30"></a>
		</th>
	</tr>
	<tr class="clsNone">
		<th class="clsCalTitleWeek" scope="col" id="hdWeek_1" width="30" bgcolor="#FFcccc">日</th>
		<th class="clsCalTitleWeek" scope="col" id="hdWeek_2" width="30" bgcolor="#ffffcc">月</th>
		<th class="clsCalTitleWeek" scope="col" id="hdWeek_3" width="30" bgcolor="#ffffcc">火</th>
		<th class="clsCalTitleWeek" scope="col" id="hdWeek_4" width="30" bgcolor="#ffffcc">水</th>
		<th class="clsCalTitleWeek" scope="col" id="hdWeek_5" width="30" bgcolor="#ffffcc">木</th>
		<th class="clsCalTitleWeek" scope="col" id="hdWeek_6" width="30" bgcolor="#ffffcc">金</th>
		<th class="clsCalTitleWeek" scope="col" id="hdWeek_7" width="30" bgcolor="#ccccFF">土</th>
	</tr>
<tr class="clsNone"><td class="clsCal" headers="hdYM hdWeek_1" bgcolor="#FFcccc"><a href="javascript:set_data(20231001)">1</a></td>

<td class="clsCal" headers="hdYM hdWeek_2" bgcolor="#FFFFee"><a href="javascript:set_data(20231002)">2</a></td>

<td class="clsCal" headers="hdYM hdWeek_3" bgcolor="#FFFFee"><a href="javascript:set_data(20231003)">3</a></td>

<td class="clsCal" headers="hdYM hdWeek_4" bgcolor="#FFFFee"><a href="javascript:set_data(20231004)">4</a></td>

<td class="clsCal" headers="hdYM hdWeek_5" bgcolor="#FFFFee"><a href="javascript:set_data(20231005)">5</a></td>

<td class="clsCal" headers="hdYM hdWeek_6" bgcolor="#FFFFee"><a href="javascript:set_data(20231006)">6</a></td>

<td class="clsCal" headers="hdYM hdWeek_7" bgcolor="#ccccFF"><a href="javascript:set_data(20231007)">7</a></td>

</tr><tr class="clsNone"><td class="clsCal" headers="hdYM hdWeek_1" bgcolor="#FFcccc"><a href="javascript:set_data(20231008)">8</a></td>

<td class="clsCal" headers="hdYM hdWeek_2" bgcolor="#FFcccc"><a href="javascript:set_data(20231009)">9</a></td>

<td class="clsCal" headers="hdYM hdWeek_3" bgcolor="#FFFFee"><a href="javascript:set_data(20231010)">10</a></td>

<td class="clsCal" headers="hdYM hdWeek_4" bgcolor="#FFFFee"><a href="javascript:set_data(20231011)">11</a></td>

<td class="clsCal" headers="hdYM hdWeek_5" bgcolor="#FFFFee"><a href="javascript:set_data(20231012)">12</a></td>

<td class="clsCal" headers="hdYM hdWeek_6" bgcolor="#FFFFee"><a href="javascript:set_data(20231013)">13</a></td>

<td class="clsCal" headers="hdYM hdWeek_7" bgcolor="#ccccFF"><a href="javascript:set_data(20231014)">14</a></td>

</tr><tr class="clsNone"><td class="clsCal" headers="hdYM hdWeek_1" bgcolor="#FFcccc"><a href="javascript:set_data(20231015)">15</a></td>

<td class="clsCal" headers="hdYM hdWeek_2" bgcolor="#FFFFee"><a href="javascript:set_data(20231016)">16</a></td>

<td class="clsCal" headers="hdYM hdWeek_3" bgcolor="#FFFFee"><a href="javascript:set_data(20231017)">17</a></td>

<td class="clsCal" headers="hdYM hdWeek_4" bgcolor="#FFFFee"><a href="javascript:set_data(20231018)">18</a></td>

<td class="clsCal" headers="hdYM hdWeek_5" bgcolor="#FFFFee"><a href="javascript:set_data(20231019)">19</a></td>

<td class="clsCal" headers="hdYM hdWeek_6" bgcolor="#FFFFee"><a href="javascript:set_data(20231020)">20</a></td>

<td class="clsCal" headers="hdYM hdWeek_7" bgcolor="#ccccFF"><a href="javascript:set_data(20231021)">21</a></td>

</tr><tr class="clsNone"><td class="clsCal" headers="hdYM hdWeek_1" bgcolor="#FFcccc"><a href="javascript:set_data(20231022)">22</a></td>

<td class="clsCal" headers="hdYM hdWeek_2" bgcolor="#FFFFee"><a href="javascript:set_data(20231023)">23</a></td>

<td class="clsCal" headers="hdYM hdWeek_3" bgcolor="#FFFFee"><a href="javascript:set_data(20231024)">24</a></td>

<td class="clsCal" headers="hdYM hdWeek_4" bgcolor="#FFFFee"><a href="javascript:set_data(20231025)">25</a></td>

<td class="clsCal" headers="hdYM hdWeek_5" bgcolor="#FFFFee"><a href="javascript:set_data(20231026)">26</a></td>

<td class="clsCal" headers="hdYM hdWeek_6" bgcolor="#FFFFee"><a href="javascript:set_data(20231027)">27</a></td>

<td class="clsCal" headers="hdYM hdWeek_7" bgcolor="#ccccFF"><a href="javascript:set_data(20231028)">28</a></td>

</tr><tr class="clsNone"><td class="clsCal" headers="hdYM hdWeek_1" bgcolor="#FFcccc"><a href="javascript:set_data(20231029)">29</a></td>

<td class="clsCal" headers="hdYM hdWeek_2" bgcolor="#FFFFee"><a href="javascript:set_data(20231030)">30</a></td>

<td class="clsCal" headers="hdYM hdWeek_3" bgcolor="#FFFFee"><a href="javascript:set_data(20231031)">31</a></td>

<td class="clsCal" headers="hdYM hdWeek_4" bgcolor="#FFFFFF">&nbsp;</td>
<td class="clsCal" headers="hdYM hdWeek_5" bgcolor="#FFFFFF">&nbsp;</td>
<td class="clsCal" headers="hdYM hdWeek_6" bgcolor="#FFFFFF">&nbsp;</td>
<td class="clsCal" headers="hdYM hdWeek_7" bgcolor="#FFFFFF">&nbsp;</td>
</tr></tbody></table>
<br>
<table class="clsCal" width="60%">
	<tbody><tr class="clsNone">
		<td class="clsCalExplain" width="33%" colspan="2"><img class="clsKomaSmall" alt="選択中" src="../image/s_select.gif">選択中</td>
	</tr>
	<tr class="clsNone">
		<td class="clsCalExplain" width="33%"><img class="clsKomaSmall" alt="予約可能" src="../image/s_empty.gif">予約可能</td>
		<td class="clsCalExplain" width="33%"><img class="clsKomaSmall" alt="抽選予約画面へ移動" src="../image/s_lot.gif">抽選予約可能</td>
	</tr>
	<tr class="clsNone">
		<td class="clsCalExplain" width="33%"><img class="clsKomaSmall" alt="予約不可" src="../image/s_reserve.gif">予約不可</td>
		<td class="clsCalExplain" width="33%"><img class="clsKomaSmall" alt="予約受付期間外" src="../image/s_empty3.gif">予約受付期間外</td>
	</tr>
	<tr class="clsNone">
		<td class="clsCalExplain" width="66%" colspan="2"><img class="clsKomaSmall" alt="一部予約有り" src="../image/s_empty4.gif">一部予約有り</td>
	</tr>
	<tr class="clsNone">
		<td class="clsCalExplain" width="33%" colspan="2"><img class="clsKomaSmall" alt="休館・点検" src="../image/s_close_n.gif">休館・点検</td>
	</tr>
	<tr class="clsNone">
		<td class="clsCalExplain" width="33%" colspan="2"><img class="clsKomaSmall" alt="空き有り（要問い合わせ）" src="../image/s_empty2.gif">空き有り （要問い合わせ）</td>
	</tr>
	<tr class="clsNone">
		<td class="clsCalExplain" width="33%" colspan="2"><img class="clsKomaSmall" alt="個人使用" src="../image/s_kojin_shiyou.gif">個人使用</td>
	</tr>
	<tr class="clsNone">
		<td class="clsCalExplain" width="33%" colspan="2"><img class="clsKomaSmall" alt="使用不可" src="../image/s_siyouhuka_hihyouji.gif">使用不可</td>
	</tr>
	<tr class="clsNone">
		<td class="clsCalExplain" width="33%" colspan="2"><img class="clsKomaSmall" alt="使用不可（メモあり）" src="../image/s_siyouhuka_hyouji.gif">使用不可（メモあり）</td>
	</tr>
</tbody></table>
</center>
</div>

<div class="right_disp">
<left>
<table class="clsYoyakuHeader" width="100%" align="center">
	<tbody><tr class="HeightHeaderOneLine">
		<th class="clsYoyakuHeader" scope="row" id="hdKaikan" width="20%">

			<a href="javascript:onclick=wordhelp_open('No01')">会館</a>

		</th>

		<td class="clsYoyakuHeader" headers="hdKaikan" width="80%">
			<select class="clsMiddle" name="lst_kaikan" size="1" onchange="lst_kaikan_change(this.form)">



			<option value="000030">川越公園</option>



			<option value="000060" selected="">所沢航空記念公園</option>



			<option value="000040">吉見総合運動公園</option>



		</select>



			<span class="Syousai">詳細は&nbsp;</span><a href="http://www.parks.or.jp/tokorozawa-kokuu/" target="_BLANK">こちら</a>


		</td>
	</tr>
	<tr class="HeightHeaderOneLine">
		<td class="clsYoyakuHeaderMemo" colspan="2" width="100%">

		<pre><span style="color:red;"><span style="font-weight:bold;">※R5.8/1から窓口で受付をする際、身分証明書と利用者カードの提示が必要になります</span></span>
<span style="color:red;"><span style="font-weight:bold;">※</span></span>
</pre>

		&nbsp;&nbsp;

		</td>
	</tr>
</tbody></table>
<left>

<script language="javascript">
	var KyuYoyFlg = "0";
	var KyukanFlg = "0";

	if(KyuYoyFlg == "1" && KyukanFlg == "0"){
		document.write("<center>");
		document.write("<div class='ResultMsgSmall'>");
		document.write("本日は休館日のため、予約受付できません。現在は予約状況の表示のみをしています。<br>");
		document.write("</div>");
		document.write("</center>");
	}
</script>

<table class="list" border="0" width="100%">
	<tbody><tr class="clsNone">
		</tr></tbody></table><table class="clsNoBorder">
			<tbody><tr class="clsNone">
				<td class="clsYoyakuRemark" width="90%">
			
					利用したい時間帯の
					<img class="clsKomaSmall" alt="予約可能" src="../image/s_empty.gif">

					<img class="clsKomaSmall" alt="一部予約有り" src="../image/s_empty4.gif">

					マークをクリックして、選んでください。（複数選択可）<br>
					選択したら、次へボタンをクリックしてください。

					<br>

					上記会館名の右側のリンクより、会館の詳細情報を確認できます。

				</td>

			</tr>

			<tr class="clsNone">
				<td class="clsVTop_HLeft" width="10%" nowrap="">
					<input class="clsImage" type="image" alt="次へ" src="../image/next.jpg" name="btn_ok" value="次　へ" onclick="btn_ok_click(this.form);return false;">
					<input class="clsImage" type="image" alt="選択のクリア" src="../image/clear.jpg" name="btn_clear" value="クリア" onclick="btn_clear_click();return false;">

				</td>
			</tr>

		</tbody></table>
	
	
		
			<script language="JavaScript">
			buildReserveTable();	
			</script><table class="clsKoma" width="100%"><tbody><tr class="clsNone"><td class="clsMark" rowspan="3"></td><td class="clsKomaBlank" colspan="61"><table class="clsKomaHeader" width="100%"><tbody><tr class="clsNone"><th class="clsKomaTitle1" nowrap=""><a href="javascript:set_cal(20231010,00000000,99999999)"><img class="clsNone" alt="前日表示" src="../image/arrowleft.gif" border="0"></a><a href="javascript:set_cal(20231012,00000000,99999999)"><img class="clsNone" alt="翌日表示" src="../image/arrowright.gif" border="0"></a></th><th class="clsKomaTitle2" nowrap="">2023年10月11日（水）</th><th class="clsKomaTitle1" nowrap=""><a href="javascript:set_cal(20231010,00000000,99999999)"><img class="clsNone" alt="前日表示" src="../image/arrowleft.gif" border="0"></a><a href="javascript:set_cal(20231012,00000000,99999999)"><img class="clsNone" alt="翌日表示" src="../image/arrowright.gif" border="0"></a></th></tr></tbody></table></td></tr><tr class="clsNone"><td class="clsKomaTimeHour" colspan="4">6:00</td><td class="clsKomaTimeHour" colspan="4">7:00</td><td class="clsKomaTimeHour" colspan="4">8:00</td><td class="clsKomaTimeHour" colspan="4">9:00</td><td class="clsKomaTimeHour" colspan="4">10:00</td><td class="clsKomaTimeHour" colspan="4">11:00</td><td class="clsKomaTimeHour" colspan="4">12:00</td><td class="clsKomaTimeHour" colspan="4">13:00</td><td class="clsKomaTimeHour" colspan="4">14:00</td><td class="clsKomaTimeHour" colspan="4">15:00</td><td class="clsKomaTimeHour" colspan="4">16:00</td><td class="clsKomaTimeHour" colspan="4">17:00</td><td class="clsKomaTimeHour" colspan="4">18:00</td><td class="clsKomaTimeHour" colspan="4">19:00</td><td class="clsKomaTimeHour" colspan="4">20:00</td></tr><tr class="clsNone" height="15"><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_1" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート１</th><td class="clsKomaBlank" headers="Shisetu_1" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_1" colspan="8"><a href="javascript:komaClicked(0,0,1)" name="ahref000000001"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000001"><br></a></td><td class="clsKoma" headers="Shisetu_1" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001001"><br></td><td class="clsKoma" headers="Shisetu_1" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002001"><br></td><td class="clsKoma" headers="Shisetu_1" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003001"><br></td><td class="clsKoma" headers="Shisetu_1" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004001"><br></td><td class="clsKoma" headers="Shisetu_1" colspan="8"><a href="javascript:komaClicked(0,5,1)" name="ahref000005001"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005001"><br></a></td><td class="clsKomaBlank" headers="Shisetu_1" colspan="10" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_2" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート２</th><td class="clsKomaBlank" headers="Shisetu_2" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_2" colspan="8"><a href="javascript:komaClicked(0,0,2)" name="ahref000000002"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000002"><br></a></td><td class="clsKoma" headers="Shisetu_2" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001002"><br></td><td class="clsKoma" headers="Shisetu_2" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002002"><br></td><td class="clsKoma" headers="Shisetu_2" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003002"><br></td><td class="clsKoma" headers="Shisetu_2" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004002"><br></td><td class="clsKoma" headers="Shisetu_2" colspan="8"><a href="javascript:komaClicked(0,5,2)" name="ahref000005002"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005002"><br></a></td><td class="clsKomaBlank" headers="Shisetu_2" colspan="10" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_3" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート３</th><td class="clsKomaBlank" headers="Shisetu_3" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_3" colspan="8"><a href="javascript:komaClicked(0,0,3)" name="ahref000000003"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000003"><br></a></td><td class="clsKoma" headers="Shisetu_3" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001003"><br></td><td class="clsKoma" headers="Shisetu_3" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002003"><br></td><td class="clsKoma" headers="Shisetu_3" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003003"><br></td><td class="clsKoma" headers="Shisetu_3" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004003"><br></td><td class="clsKoma" headers="Shisetu_3" colspan="8"><a href="javascript:komaClicked(0,5,3)" name="ahref000005003"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005003"><br></a></td><td class="clsKomaBlank" headers="Shisetu_3" colspan="10" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_4" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート４</th><td class="clsKomaBlank" headers="Shisetu_4" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_4" colspan="8"><a href="javascript:komaClicked(0,0,4)" name="ahref000000004"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000004"><br></a></td><td class="clsKoma" headers="Shisetu_4" colspan="8"><img class="clsKomaLarge" alt="空き有り（要問い合わせ）" src="../image/s_empty2.gif" name="image000001004"><br></td><td class="clsKoma" headers="Shisetu_4" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002004"><br></td><td class="clsKoma" headers="Shisetu_4" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003004"><br></td><td class="clsKoma" headers="Shisetu_4" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004004"><br></td><td class="clsKoma" headers="Shisetu_4" colspan="8"><a href="javascript:komaClicked(0,5,4)" name="ahref000005004"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005004"><br></a></td><td class="clsKomaBlank" headers="Shisetu_4" colspan="10" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_5" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート５</th><td class="clsKomaBlank" headers="Shisetu_5" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_5" colspan="8"><a href="javascript:komaClicked(0,0,5)" name="ahref000000005"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000005"><br></a></td><td class="clsKoma" headers="Shisetu_5" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001005"><br></td><td class="clsKoma" headers="Shisetu_5" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002005"><br></td><td class="clsKoma" headers="Shisetu_5" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003005"><br></td><td class="clsKoma" headers="Shisetu_5" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004005"><br></td><td class="clsKoma" headers="Shisetu_5" colspan="8"><a href="javascript:komaClicked(0,5,5)" name="ahref000005005"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005005"><br></a></td><td class="clsKomaBlank" headers="Shisetu_5" colspan="10" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_6" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート６</th><td class="clsKomaBlank" headers="Shisetu_6" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_6" colspan="8"><a href="javascript:komaClicked(0,0,6)" name="ahref000000006"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000006"><br></a></td><td class="clsKoma" headers="Shisetu_6" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001006"><br></td><td class="clsKoma" headers="Shisetu_6" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002006"><br></td><td class="clsKoma" headers="Shisetu_6" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003006"><br></td><td class="clsKoma" headers="Shisetu_6" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004006"><br></td><td class="clsKoma" headers="Shisetu_6" colspan="8"><a href="javascript:komaClicked(0,5,6)" name="ahref000005006"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005006"><br></a></td><td class="clsKomaBlank" headers="Shisetu_6" colspan="10" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_7" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート７</th><td class="clsKomaBlank" headers="Shisetu_7" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_7" colspan="8"><a href="javascript:komaClicked(0,0,7)" name="ahref000000007"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000007"><br></a></td><td class="clsKoma" headers="Shisetu_7" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001007"><br></td><td class="clsKoma" headers="Shisetu_7" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002007"><br></td><td class="clsKoma" headers="Shisetu_7" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003007"><br></td><td class="clsKoma" headers="Shisetu_7" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004007"><br></td><td class="clsKoma" headers="Shisetu_7" colspan="8"><a href="javascript:komaClicked(0,5,7)" name="ahref000005007"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005007"><br></a></td><td class="clsKomaBlank" headers="Shisetu_7" colspan="10" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_8" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート８</th><td class="clsKomaBlank" headers="Shisetu_8" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_8" colspan="8"><a href="javascript:komaClicked(0,0,8)" name="ahref000000008"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000008"><br></a></td><td class="clsKoma" headers="Shisetu_8" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001008"><br></td><td class="clsKoma" headers="Shisetu_8" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002008"><br></td><td class="clsKoma" headers="Shisetu_8" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003008"><br></td><td class="clsKoma" headers="Shisetu_8" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004008"><br></td><td class="clsKoma" headers="Shisetu_8" colspan="8"><a href="javascript:komaClicked(0,5,8)" name="ahref000005008"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005008"><br></a></td><td class="clsKomaBlank" headers="Shisetu_8" colspan="10" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_9" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート９</th><td class="clsKomaBlank" headers="Shisetu_9" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_9" colspan="8"><a href="javascript:komaClicked(0,0,9)" name="ahref000000009"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000009"><br></a></td><td class="clsKoma" headers="Shisetu_9" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001009"><br></td><td class="clsKoma" headers="Shisetu_9" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002009"><br></td><td class="clsKoma" headers="Shisetu_9" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003009"><br></td><td class="clsKoma" headers="Shisetu_9" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004009"><br></td><td class="clsKoma" headers="Shisetu_9" colspan="8"><a href="javascript:komaClicked(0,5,9)" name="ahref000005009"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005009"><br></a></td><td class="clsKomaBlank" headers="Shisetu_9" colspan="10" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_10" width="120" height="25" nowrap="">&nbsp;&nbsp;第１テニスコート１０</th><td class="clsKomaBlank" headers="Shisetu_10" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_10" colspan="8"><a href="javascript:komaClicked(0,0,10)" name="ahref000000010"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000010"><br></a></td><td class="clsKoma" headers="Shisetu_10" colspan="8"><img class="clsKomaLarge" alt="空き有り（要問い合わせ）" src="../image/s_empty2.gif" name="image000001010"><br></td><td class="clsKoma" headers="Shisetu_10" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002010"><br></td><td class="clsKoma" headers="Shisetu_10" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003010"><br></td><td class="clsKoma" headers="Shisetu_10" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004010"><br></td><td class="clsKoma" headers="Shisetu_10" colspan="8"><a href="javascript:komaClicked(0,5,10)" name="ahref000005010"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000005010"><br></a></td><td class="clsKomaBlank" headers="Shisetu_10" colspan="10" nowrap=""><br></td></tr><tr class="clsNone" height="15"><td class="clsMark" rowspan="3"></td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td></tr><tr class="clsNone" height="15"><td class="clsKomaTimeHour" colspan="4">6:00</td><td class="clsKomaTimeHour" colspan="4">7:00</td><td class="clsKomaTimeHour" colspan="4">8:00</td><td class="clsKomaTimeHour" colspan="4">9:00</td><td class="clsKomaTimeHour" colspan="4">10:00</td><td class="clsKomaTimeHour" colspan="4">11:00</td><td class="clsKomaTimeHour" colspan="4">12:00</td><td class="clsKomaTimeHour" colspan="4">13:00</td><td class="clsKomaTimeHour" colspan="4">14:00</td><td class="clsKomaTimeHour" colspan="4">15:00</td><td class="clsKomaTimeHour" colspan="4">16:00</td><td class="clsKomaTimeHour" colspan="4">17:00</td><td class="clsKomaTimeHour" colspan="4">18:00</td><td class="clsKomaTimeHour" colspan="4">19:00</td><td class="clsKomaTimeHour" colspan="4">20:00</td></tr>	<tr class="clsNone" height="15"><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td><td class="clsKomaTimeMinute">&nbsp;</td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_12" width="120" height="25" nowrap="">&nbsp;&nbsp;第２テニスコート１１</th><td class="clsKomaBlank" headers="Shisetu_12" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_12" colspan="8"><a href="javascript:komaClicked(0,0,12)" name="ahref000000012"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000012"><br></a></td><td class="clsKoma" headers="Shisetu_12" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001012"><br></td><td class="clsKoma" headers="Shisetu_12" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002012"><br></td><td class="clsKoma" headers="Shisetu_12" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003012"><br></td><td class="clsKoma" headers="Shisetu_12" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004012"><br></td><td class="clsKoma" headers="Shisetu_12" colspan="8"><img class="clsKomaLarge" alt="空き有り（要問い合わせ）" src="../image/s_empty2.gif" name="image000005012"><br></td><td class="clsKoma" headers="Shisetu_12" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000006012"><br></td><td class="clsKomaBlank" headers="Shisetu_12" colspan="2" nowrap=""><br></td></tr><tr class="clsNone"><th class="clsShisetuTitleOneDay" scope="col" id="Shisetu_13" width="120" height="25" nowrap="">&nbsp;&nbsp;第２テニスコート１２</th><td class="clsKomaBlank" headers="Shisetu_13" colspan="2" nowrap=""></td><td class="clsKoma" headers="Shisetu_13" colspan="8"><a href="javascript:komaClicked(0,0,13)" name="ahref000000013"><img class="clsKomaLarge" alt="休館・点検" src="../image/s_close_n.gif" name="image000000013"><br></a></td><td class="clsKoma" headers="Shisetu_13" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000001013"><br></td><td class="clsKoma" headers="Shisetu_13" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000002013"><br></td><td class="clsKoma" headers="Shisetu_13" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000003013"><br></td><td class="clsKoma" headers="Shisetu_13" colspan="8"><img class="clsKomaLarge" alt="予約不可" src="../image/s_reserve.gif" name="image000004013"><br></td><td class="clsKoma" headers="Shisetu_13" colspan="8"><img class="clsKomaLarge" alt="空き有り（要問い合わせ）" src="../image/s_empty2.gif" name="image000005013"><br></td><td class="clsKoma" headers="Shisetu_13" colspan="8"><img class="clsKomaLarge" alt="空き有り（要問い合わせ）" src="../image/s_empty2.gif" name="image000006013"><br></td><td class="clsKomaBlank" headers="Shisetu_13" colspan="2" nowrap=""><br></td></tr></tbody></table>
		
		<input type="hidden" name="yoyakuNoTextField">
	

</left>
</left></div>

</div>




<input type="hidden" name="mode_disp" value="1">
<input type="hidden" name="txt_date_cal" value="20231011">

<input type="hidden" name="txt_mode" value="1">

<input type="hidden" name="txtSelKomaPtnNo" value="1">
<input type="hidden" name="txtTodayKPTN" value="2023/10/11">

<input type="hidden" name="RequestPage" value="i-1-21">

<input type="hidden" name="YoyFromPage" value="i-1-21">

<input type="hidden" name="cmd" value="">
<input type="hidden" name="txt_yoyaku" value="">
<input type="hidden" name="txt_date" value="20231011">

<input type="hidden" name="riyou_cnt" value="">

<input type="hidden" name="txt_shinsei_no" value="">
<input type="hidden" name="txt_KOMA_CHANGE" value="">
<input type="hidden" name="txt_BASE" value="">
<input type="hidden" name="txt_BASE2" value="">
<input type="hidden" name="txt_CHANGE_YOY_NO" value="">


<input type="hidden" name="lst_dantaigenmen" value="">
<input type="hidden" name="lst_tiikikasan" value="">

<input type="hidden" name="txt_Clear" value="">



<input type="hidden" name="txt_menParam" value="">
<input type="hidden" name="txt_shisetuMenInfo" value="">
<input type="hidden" name="txt_komaCondInfo" value="">
<input type="hidden" name="txt_yoyaku_wrk" value="">

<input type="hidden" name="kojin_flg" value="">

<input type="hidden" name="men_changed_flg">

<input type="hidden" name="PAGE_UNIQ_ID" value="">


</form>
<script language="JavaScript">
	var frmThis = window.document.form1;
	selectedOpt = -1;
	if (frmThis.disp_mode[0].checked == true){
		selectedOpt = 0;
	}else{
		if (frmThis.disp_mode[1].checked == true){
			selectedOpt = 1;
		}
	}
	reloadYoyaku(radioSelectedIndex);	
	riyouCnt = "";
	
	if (document.form1.txt_CHANGE_YOY_NO.value.length != 0) {
		document.form1.yoyakuNoTextField.value = form1.txt_CHANGE_YOY_NO.value;
		selecting = true;
	}


</script>


</body></html>